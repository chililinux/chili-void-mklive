"use strict";(()=>{var D_=Object.create;var _n=Object.defineProperty;var I_=Object.getOwnPropertyDescriptor;var N_=Object.getOwnPropertyNames;var C_=Object.getPrototypeOf,q_=Object.prototype.hasOwnProperty;var I=(e,t)=>()=>(e&&(t=e(e=0)),t);var f=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Z=(e,t)=>{for(var r in t)_n(e,r,{get:t[r],enumerable:!0})},cp=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of N_(t))!q_.call(e,n)&&n!==r&&_n(e,n,{get:()=>t[n],enumerable:!(i=I_(t,n))||i.enumerable});return e};var wn=(e,t,r)=>(r=e!=null?D_(C_(e)):{},cp(t||!e||!e.__esModule?_n(r,"default",{value:e,enumerable:!0}):r,e)),P=e=>cp(_n({},"__esModule",{value:!0}),e);var pp=f(()=>{"use strict"});var ts=f((es,dp)=>{(function(e,t){if(typeof define=="function"&&define.amd)define("webextension-polyfill",["module"],t);else if(typeof es<"u")t(dp);else{var r={exports:{}};t(r),e.browser=r.exports}})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:es,function(e){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){let t="The message port closed before a response was received.",r=i=>{let n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(n).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class o extends WeakMap{constructor(x,S=void 0){super(S),this.createItem=x}get(x){return this.has(x)||this.set(x,this.createItem(x)),super.get(x)}}let a=h=>h&&typeof h=="object"&&typeof h.then=="function",s=(h,x)=>(...S)=>{i.runtime.lastError?h.reject(new Error(i.runtime.lastError.message)):x.singleCallbackArg||S.length<=1&&x.singleCallbackArg!==!1?h.resolve(S[0]):h.resolve(S)},u=h=>h==1?"argument":"arguments",l=(h,x)=>function(O,...D){if(D.length<x.minArgs)throw new Error(`Expected at least ${x.minArgs} ${u(x.minArgs)} for ${h}(), got ${D.length}`);if(D.length>x.maxArgs)throw new Error(`Expected at most ${x.maxArgs} ${u(x.maxArgs)} for ${h}(), got ${D.length}`);return new Promise((L,B)=>{if(x.fallbackToNoCallback)try{O[h](...D,s({resolve:L,reject:B},x))}catch(q){console.warn(`${h} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,q),O[h](...D),x.fallbackToNoCallback=!1,x.noCallback=!0,L()}else x.noCallback?(O[h](...D),L()):O[h](...D,s({resolve:L,reject:B},x))})},p=(h,x,S)=>new Proxy(x,{apply(O,D,L){return S.call(D,h,...L)}}),c=Function.call.bind(Object.prototype.hasOwnProperty),g=(h,x={},S={})=>{let O=Object.create(null),D={has(B,q){return q in h||q in O},get(B,q,Q){if(q in O)return O[q];if(!(q in h))return;let j=h[q];if(typeof j=="function")if(typeof x[q]=="function")j=p(h,h[q],x[q]);else if(c(S,q)){let oe=l(q,S[q]);j=p(h,h[q],oe)}else j=j.bind(h);else if(typeof j=="object"&&j!==null&&(c(x,q)||c(S,q)))j=g(j,x[q],S[q]);else if(c(S,"*"))j=g(j,x[q],S["*"]);else return Object.defineProperty(O,q,{configurable:!0,enumerable:!0,get(){return h[q]},set(oe){h[q]=oe}}),j;return O[q]=j,j},set(B,q,Q,j){return q in O?O[q]=Q:h[q]=Q,!0},defineProperty(B,q,Q){return Reflect.defineProperty(O,q,Q)},deleteProperty(B,q){return Reflect.deleteProperty(O,q)}},L=Object.create(h);return new Proxy(L,D)},A=h=>({addListener(x,S,...O){x.addListener(h.get(S),...O)},hasListener(x,S){return x.hasListener(h.get(S))},removeListener(x,S){x.removeListener(h.get(S))}}),d=new o(h=>typeof h!="function"?h:function(S){let O=g(S,{},{getContent:{minArgs:0,maxArgs:0}});h(O)}),_=new o(h=>typeof h!="function"?h:function(S,O,D){let L=!1,B,q=new Promise(Oe=>{B=function(ae){L=!0,Oe(ae)}}),Q;try{Q=h(S,O,B)}catch(Oe){Q=Promise.reject(Oe)}let j=Q!==!0&&a(Q);if(Q!==!0&&!j&&!L)return!1;let oe=Oe=>{Oe.then(ae=>{D(ae)},ae=>{let Er;ae&&(ae instanceof Error||typeof ae.message=="string")?Er=ae.message:Er="An unexpected error occurred",D({__mozWebExtensionPolyfillReject__:!0,message:Er})}).catch(ae=>{console.error("Failed to send onMessage rejected reply",ae)})};return oe(j?Q:q),!0}),m=({reject:h,resolve:x},S)=>{i.runtime.lastError?i.runtime.lastError.message===t?x():h(new Error(i.runtime.lastError.message)):S&&S.__mozWebExtensionPolyfillReject__?h(new Error(S.message)):x(S)},y=(h,x,S,...O)=>{if(O.length<x.minArgs)throw new Error(`Expected at least ${x.minArgs} ${u(x.minArgs)} for ${h}(), got ${O.length}`);if(O.length>x.maxArgs)throw new Error(`Expected at most ${x.maxArgs} ${u(x.maxArgs)} for ${h}(), got ${O.length}`);return new Promise((D,L)=>{let B=m.bind(null,{resolve:D,reject:L});O.push(B),S.sendMessage(...O)})},v={devtools:{network:{onRequestFinished:A(d)}},runtime:{onMessage:A(_),onMessageExternal:A(_),sendMessage:y.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:y.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},T={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":T},services:{"*":T},websites:{"*":T}},g(i,v,n)};e.exports=r(chrome)}else e.exports=globalThis.browser})});var Sr=f((oM,lt)=>{"use strict";lt.exports.browser=ts();var bi;typeof browser>"u"&&typeof chrome<"u"&&chrome.runtime?/\bOPR\//.test(navigator.userAgent)?bi="opera":bi="chrome":/\bEdge\//.test(navigator.userAgent)?bi="edge":bi="firefox",lt.exports.browserType=bi,typeof lt.exports.browser.action>"u"&&(lt.exports.browser.action=lt.exports.browser.browserAction),lt.exports.isBrowser=(...e)=>{for(let t=0;t<e.length;t++)if(e[t]==lt.exports.browserType)return!0;return!1},lt.exports.error=e=>{console.groupCollapsed(e.message),e.stack&&console.error(e.stack),console.groupEnd()}});var Mt=f((aM,fp)=>{"use strict";var rs=class{constructor(){this.replyId=0,this.replies={},this.listeners={},this.hook=this.nullHook,this.debugLevel=0,this.useTarget=!1,this.logger=console,this.posts={}}setPost(t,r){typeof t=="string"?this.posts[t]=r:this.post=t}setUseTarget(t){this.useTarget=t}setDebugLevel(t){this.debugLevel=t}setHook(t){let r=this,i=Date.now();function n(){return typeof window<"u"&&typeof window.performance<"u"?window.performance.now():Date.now()-i}t?this.hook=o=>{o.timestamp=n();try{t(o)}catch(a){r.logger.warn("Hoor error",a)}}:this.hook=this.nullHook}nullHook(){}call(){let t=this,r,i,n,o,a=Array.prototype.slice.call(arguments);return typeof a[0]=="function"&&(r=a.shift()),t.useTarget?[i,n,...o]=a:[n,...o]=a,new Promise(function(s,u){let l=++t.replyId;t.debugLevel>=2&&t.logger.info("rpc #"+l,"call =>",n,o),t.hook({type:"call",callee:i,rid:l,method:n,args:o}),t.replies[l]={resolve:s,reject:u,peer:i};let p=r||t.useTarget&&t.posts[i]||t.post;t.useTarget?p(i,{type:"weh#rpc",_request:l,_method:n,_args:[...o]}):p({type:"weh#rpc",_request:l,_method:n,_args:[...o]})})}receive(t,r,i){let n=this;if(t._request)Promise.resolve().then(()=>{let o=n.listeners[t._method];if(typeof o=="function")return n.debugLevel>=2&&n.logger.info("rpc #"+t._request,"serve <= ",t._method,t._args),n.hook({type:"call",caller:i,rid:t._request,method:t._method,args:t._args}),Promise.resolve(o.apply(null,t._args)).then(a=>(n.hook({type:"reply",caller:i,rid:t._request,result:a}),a)).catch(a=>{throw n.hook({type:"reply",caller:i,rid:t._request,error:a.message}),a});throw new Error("Method "+t._method+" is not a function")}).then(o=>{n.debugLevel>=2&&n.logger.info("rpc #"+t._request,"serve => ",o),r({type:"weh#rpc",_reply:t._request,_result:o})}).catch(o=>{n.debugLevel>=1&&n.logger.info("rpc #"+t._request,"serve => !",o.message),r({type:"weh#rpc",_reply:t._request,_error:o.message})});else if(t._reply){let o=n.replies[t._reply];delete n.replies[t._reply],o?t._error?(n.debugLevel>=1&&n.logger.info("rpc #"+t._reply,"call <= !",t._error),n.hook({type:"reply",callee:o.peer,rid:t._reply,error:t._error}),o.reject(new Error(t._error))):(n.debugLevel>=2&&n.logger.info("rpc #"+t._reply,"call <= ",t._result),n.hook({type:"reply",callee:o.peer,rid:t._reply,result:t._result}),o.resolve(t._result)):n.logger.error("Missing reply handler")}}listen(t){Object.assign(this.listeners,t)}};fp.exports=new rs});var ns=f((sM,yp)=>{"use strict";var{browser:is}=Sr(),gp={},mp=new RegExp("\\$[a-zA-Z]*([0-9]+)\\$","g"),hp=!1,k_=is.storage.local.get("wehI18nCustom").then(e=>{hp=!0;let t=e.wehI18nCustom;t&&Object.assign(gp,t)});function B_(e,t){if(hp||console.warn("Using `weh._` before custom strings were loaded:",e),/-/.test(e)){let i=e.replace(/-/g,"_");console.warn("Wrong i18n message name. Should it be",i,"instead of",e,"?"),e=i}let r=gp[e];return t&&!Array.isArray(t)&&(t=[t]),r&&r.message.length>0?(r.message||"").replace(mp,i=>{let n=mp.exec(i);return n&&t&&t[parseInt(n[1])-1]||"??"}):t?is.i18n.getMessage(e,t):is.i18n.getMessage(e)}yp.exports={getMessage:B_,custom_strings_ready:k_}});var Ap=f((uM,bp)=>{"use strict";var Ai=Sr(),F_=Mt(),W=Ai.browser,_i={},xn={};function vp(e,t){let r=!1;return new Promise(function(i,n){return W.tabs.query({}).then(function(o){o.forEach(function(a){a.url===e&&(W.tabs.update(a.id,{active:!0}),W.windows.update(a.windowId,{focused:!0}),r=!0)}),i(r)})})}function V_(e,t){return new Promise((r,i)=>{let n=W.runtime.getURL(t.url+"?panel="+e);vp(n).then(function(o){if(!o)return W.tabs.create({url:n}).then(function(a){Ai.__declareAppTab(e,{tab:a.id,initData:t.initData}),_i[e]={type:"tab",tabId:a.id},xn[a.id]=e})}).then(r).catch(i)})}function H_(e,t){return new Promise((r,i)=>{let n=W.runtime.getURL(t.url+"?panel="+e);W.windows.getCurrent().then(o=>{let a=t.width||500,s=t.height||400,u={url:n,width:a,height:s,type:"popup",left:Math.round((o.width-a)/2+o.left),top:Math.round((o.height-s)/2+o.top)};return Ai.isBrowser("chrome","opera")&&(u.focused=!0),W.windows.create(u).then(l=>(_i[e]={type:"window",windowId:l.id},Promise.all([l,W.windows.update(l.id,{focused:!0})]))).then(([l])=>{Promise.resolve().then(()=>{if(!(t.initData&&t.initData.autoResize))return W.windows.update(l.id,{height:l.height+1}).then(()=>W.windows.update(l.id,{height:l.height-1}))}).then(()=>{let g=new Promise((d,_)=>{let m;function y(v){v.windowId==l.id&&(clearTimeout(m),W.tabs.onCreated.removeListener(y),d(v))}m=setTimeout(()=>{W.tabs.onCreated.removeListener(y),_(new Error("Tab did not open"))},5e3),W.tabs.onCreated.addListener(y)}),A=W.tabs.query({windowId:l.id}).then(d=>new Promise((_,m)=>{d.length>0&&_(d[0])}));return Promise.race([g,A])}).then(g=>g.status=="loading"?new Promise((A,d)=>{let _;function m(y,v,T){y==g.id&&T.status=="complete"&&(clearTimeout(_),W.tabs.onUpdated.removeListener(m),A(T))}_=setTimeout(()=>{W.tabs.onUpdated.removeListener(m),d(new Error("Tab did not complete"))},6e4),W.tabs.onUpdated.addListener(m)}):g).then(g=>{Ai.__declareAppTab(e,{tab:g.id,initData:t.initData}),xn[g.id]=e}).then(r).catch(i);function p(g){g!=l.id&&t.autoClose&&W.windows.getCurrent().then(A=>{A.id!=l.id&&W.windows.remove(l.id).then(()=>{},()=>{})})}function c(g){g==l.id&&(W.windows.onFocusChanged.removeListener(p),W.windows.onFocusChanged.removeListener(c))}W.windows.onFocusChanged.addListener(p),W.windows.onRemoved.addListener(c)}).catch(i)}).catch(i)})}function j_(e,t){return new Promise((r,i)=>{let n=W.runtime.getURL(t.url+"?panel="+e);vp(n).then(o=>{if(!o)return H_(e,t)}).then(r).catch(i)})}function L_(e,t){switch(t.type){case"panel":return j_(e,t);case"tab":default:return V_(e,t)}}W.tabs.onRemoved.addListener(e=>{Ai.__closeByTab(e);let t=xn[e];t&&(delete xn[e],delete _i[t])});function U_(e){let t=_i[e];t&&t.type=="tab"?W.tabs.remove(t.tabId):t&&t.type=="window"?W.windows.remove(t.windowId):F_.call(e,"close")}function W_(e){return!!_i[e]}bp.exports={open:L_,close:U_,isOpen:W_}});var ss=f((lM,xp)=>{"use strict";var os=ns().getMessage,_p={};function wp(){this.$specs={},this.$values=null,this.$values||(this.$values={}),this.$listeners={}}wp.prototype={notify:function(e,t,r,i){let n=this,o=e.split("."),a=[];for(let s=o.length;s>=0;s--)a.push(o.slice(0,s).join("."));a.forEach(function(s){let u=n.$listeners[s];u&&u.forEach(function(l){if(l.specs==i)if(l.pack)l.pack[e]=t,typeof l.old[e]>"u"&&(l.old[e]=r),l.timer&&clearTimeout(l.timer),l.timer=setTimeout(function(){delete l.timer;let p=l.pack,c=l.old;l.pack={},l.old={};try{l.callback(p,c)}catch{}},0);else try{l.callback(e,t,r)}catch{}})})},forceNotify:function(e){typeof e>"u"&&(e=!1);let t=this;Object.keys(t.$specs).forEach(r=>{t.notify(r,t.$values[r],t.$values[r],e)})},declare:function(e){let t=this;Array.isArray(e)||(e=Object.keys(e).map(function(r){let i=e[r];return i.name=r,i})),e.forEach(function(r){if(_p[r.name])throw new Error("Forbidden prefs key "+r.name);let i;r.hidden?(r.label=r.name,r.description=""):(i=r.name.replace(/[^0-9a-zA-Z_]/g,"_"),r.label=r.label||os("weh_prefs_label_"+i)||r.name,r.description=r.description||os("weh_prefs_description_"+i)||""),r.type=="choice"&&(r.choices=(r.choices||[]).map(function(a){if(typeof a=="object")return a;if(r.hidden)return{value:a,name:a};{let s=a.replace(/[^0-9a-zA-Z_]/g,"_");return{value:a,name:os("weh_prefs_"+i+"_option_"+s)||a}}}));let n=null;t.$specs[r.name]||function(a){typeof t[r.name]<"u"&&(n=t[r.name]),Object.defineProperty(t,a,{set:function(s){let u=t.$values[a];u!==s&&(t.$values[a]=s,t.notify(a,s,u,!1))},get:function(){return t.$values[a]!==void 0?t.$values[a]:t.$specs[a]&&t.$specs[a].defaultValue||void 0}})}(r.name);let o=t.$specs[r.name];t.$specs[r.name]=r,n!==null?t.$values[r.name]=n:typeof t.$values[r.name]>"u"&&(t.$values[r.name]=r.defaultValue),t.notify(r.name,r,o,!0)})},on:function(){let e="",t={},r=0;typeof arguments[r]=="string"&&(e=arguments[r++]),typeof arguments[r]=="object"&&(t=arguments[r++]);let i=arguments[r],n=!!t.pack;this.$listeners[e]||(this.$listeners[e]=[]);let o={callback:i,specs:!!t.specs};n&&(o.pack={},o.old={}),this.$listeners[e].push(o)},off:function(){let e="",t=0;typeof arguments[t]=="string"&&(e=arguments[t++]);let r=arguments[t],i=this.$listeners[e];if(i)for(let n=i.length-1;n>=0;n--)(!r||i[n]==r)&&i.splice(n,1)},getAll:function(){return Object.assign({},this.$values)},getSpecs:function(){return Object.assign({},this.$specs)},assign:function(e){for(let t in e)e.hasOwnProperty(t)&&(this[t]=e[t])},isValid:function(e,t){let r=this.$specs[e];if(r){switch(r.type){case"string":if(r.regexp&&!new RegExp(r.regexp).test(t))return!1;break;case"integer":if(!/^-?[0-9]+$/.test(t)||isNaN(parseInt(t)))return!1;case"float":if(r.type=="float"&&(!/^-?[0-9]+(\.[0-9]+)?|(\.[0-9]+)$/.test(t)||isNaN(parseFloat(t)))||typeof r.minimum<"u"&&t<r.minimum||typeof r.maximum<"u"&&t>r.maximum)return!1;break;case"choice":{let i=!1;if((r.choices||[]).forEach(n=>{t==n.value&&(i=!0)}),!i)return!1}break}return!0}},reducer:function(e={},t){switch(t.type){case"weh.SET_PREFS":e=Object.assign({},e,t.payload);break}return e},reduxDispatch(e){this.on("",{pack:!0},t=>{e.dispatch({type:"weh.SET_PREFS",payload:t})})}};var as=new wp;for(let e in as)as.hasOwnProperty(e)&&(_p[e]=!0);xp.exports=as});var Tp=f((cM,Ep)=>{"use strict";Ep.exports=[{name:"networkProbe",type:"boolean",defaultValue:!0},{name:"titleMode",type:"choice",defaultValue:"right",choices:["right","left","multiline"]},{name:"iconActivation",type:"choice",defaultValue:"currenttab",choices:["currenttab","anytab"]},{name:"iconBadge",type:"choice",defaultValue:"tasks",choices:["none","tasks","activetab","anytab","pinned","mixed"]},{name:"hitsGotoTab",type:"boolean",defaultValue:!0},{name:"default-action-0",type:"string",defaultValue:"quickdownload",hidden:!0},{name:"default-action-1",type:"string",defaultValue:"openlocalfile",hidden:!0},{name:"default-action-2",type:"string",defaultValue:"abort",hidden:!0},{name:"smartnamerFnameSpaces",type:"choice",defaultValue:"keep",choices:["keep","remove","hyphen","underscore"]},{name:"smartnamerFnameMaxlen",type:"integer",defaultValue:64,minimum:12,maximum:256},{name:"downloadControlledMax",type:"integer",defaultValue:6,minimum:0},{name:"downloadStreamControlledMax",type:"integer",defaultValue:6,minimum:0},{name:"autoPin",type:"boolean",defaultValue:!1},{name:"mediaExtensions",type:"string",defaultValue:"flv|ram|mpg|mpeg|avi|rm|wmv|mov|asf|mp3|rar|movie|divx|rbs|mp4|mpeg4"},{name:"dashHideM4s",type:"boolean",defaultValue:!0},{name:"mpegtsHideTs",type:"boolean",defaultValue:!0},{name:"orphanExpiration",type:"integer",defaultValue:60,minimum:0},{name:"chunksEnabled",type:"boolean",defaultValue:!0},{name:"hlsEnabled",type:"boolean",defaultValue:!0},{name:"dashEnabled",type:"boolean",defaultValue:!0},{name:"dashOnAdp",type:"choice",defaultValue:"audio_video",choices:["audio","video","audio_video"]},{name:"hlsDownloadAsM2ts",type:"boolean",defaultValue:!1},{name:"networkFilterOut",type:"string",defaultValue:"/frag\\\\([0-9]+\\\\)/|[&\\\\?]range=[0-9]+-[0-9]+|/silverlight/"},{name:"mediaweightThreshold",type:"integer",defaultValue:2097152},{name:"mediaweightMinSize",type:"integer",defaultValue:8192},{name:"tbvwsEnabled",type:"boolean",defaultValue:!0,hidden:!0},{name:"converterThreads",type:"string",defaultValue:"auto"},{name:"converterAggregTuneH264",type:"boolean",defaultValue:!1},{name:"notifyReady",type:"boolean",defaultValue:!0},{name:"noPrivateNotification",type:"boolean",defaultValue:!0},{name:"avplayEnabled",type:"boolean",defaultValue:!0},{name:"blacklistEnabled",type:"boolean",defaultValue:!0},{name:"chunksConcurrentDownloads",type:"integer",defaultValue:4},{name:"chunksPrefetchCount",type:"integer",defaultValue:4},{name:"downloadRetries",type:"integer",defaultValue:3},{name:"downloadRetryDelay",type:"integer",defaultValue:1e3},{name:"mpegtsSaveRaw",type:"boolean",defaultValue:!1,hidden:!0},{name:"mpegtsSaveRawStreams",type:"boolean",defaultValue:!1,hidden:!0},{name:"mpegtsEndsOnSeenChunk",type:"boolean",defaultValue:!0,hidden:!0},{name:"converterKeepTmpFiles",type:"boolean",defaultValue:!1},{name:"backgroundReduxLogger",type:"boolean",defaultValue:!1,hidden:!0},{name:"dlconvLastOutput",type:"string",defaultValue:"",hidden:!0},{name:"qrMessageNotAgain",type:"boolean",defaultValue:!1,hidden:!0},{name:"coappShellEnabled",type:"boolean",defaultValue:!1,hidden:!0},{name:"downloadCount",type:"integer",defaultValue:0,hidden:!0},{name:"donateNotAgainExpire",type:"integer",defaultValue:0,hidden:!0},{name:"popupHeightLeftOver",type:"integer",defaultValue:100,hidden:!0},{name:"coappDownloads",type:"choice",defaultValue:"ask",choices:["ask","coapp","browser"]},{name:"lastDownloadDirectory",type:"string",defaultValue:"dwhelper"},{name:"fileDialogType",type:"choice",defaultValue:"tab",choices:["tab","panel"]},{name:"alertDialogType",type:"choice",defaultValue:"tab",choices:["tab","panel"]},{name:"monitorNetworkRequests",type:"boolean",defaultValue:!0},{name:"chunkedCoappManifestsRequests",type:"boolean",defaultValue:!1},{name:"chunkedCoappDataRequests",type:"boolean",defaultValue:!0},{name:"coappRestartDelay",type:"integer",defaultValue:1e3},{name:"rememberLastDir",type:"boolean",defaultValue:!0},{name:"coappIdleExit",type:"integer",defaultValue:6e4},{name:"dialogAutoClose",type:"boolean",defaultValue:!1},{name:"convertControlledMax",type:"integer",defaultValue:1},{name:"checkCoappOnStartup",type:"boolean",defaultValue:!0},{name:"coappUseProxy",type:"boolean",defaultValue:!0},{name:"downloadCompleteDelay",type:"integer",defaultValue:1e3},{name:"contentRedirectEnabled",type:"boolean",defaultValue:!0},{name:"contextMenuEnabled",type:"boolean",defaultValue:!0},{name:"toolsMenuEnabled",type:"boolean",defaultValue:!1},{name:"medialinkExtensions",type:"string",defaultValue:"jpg|jpeg|gif|png|mpg|mpeg|avi|rm|wmv|mov|flv|mp3|mp4"},{name:"medialinkMaxHits",type:"integer",defaultValue:50},{name:"medialinkMinFilesPerGroup",type:"integer",defaultValue:6},{name:"medialinkMinImgSize",type:"integer",defaultValue:80},{name:"medialinkAutoDetect",type:"boolean",defaultValue:!1},{name:"medialinkScanImages",type:"boolean",defaultValue:!0},{name:"medialinkScanLinks",type:"boolean",defaultValue:!0},{name:"bulkEnabled",type:"boolean",defaultValue:!0},{name:"tbvwsGrabDelay",type:"integer",defaultValue:2e3},{name:"forcedCoappVersion",type:"string",regexp:"^$|^\\d+\\.\\d+\\.\\d+$",defaultValue:""},{name:"lastHlsDownload",type:"integer",defaultValue:0,hidden:!0},{name:"galleryNaming",type:"choice",choices:["type-index","url","index-url"],defaultValue:"type-index"},{name:"hlsRememberPrevLiveChunks",type:"boolean",defaultValue:!1},{name:"hlsEndTimeout",type:"integer",defaultValue:20},{name:"tbvwsExtractionMethod",type:"choice",choices:["page_android_ios_tvep","page_ios_android_tvep","android_ios_tvep_page","ios_android_tvep_page","page_tvep_android_ios","android_ios_tvep","page","android","tvep","ios"],defaultValue:"page_android_ios_tvep"},{name:"hitUpdateFloodProtect",type:"integer",defaultValue:100,hidden:!0}]});var z=f((pM,Op)=>{"use strict";var J=Sr(),us=J.browser,Me={},Fe={};J.rpc=Mt(),J.rpc.setUseTarget(!0),J.rpc.setPost((e,t)=>{let r=Me[e];r&&r.port&&r.port.postMessage(t)}),J.rpc.listen({appStarted:e=>{},appReady:e=>{},closePanel:e=>{J.ui.close(e)}}),us.runtime.onConnect.addListener(e=>{/^weh:(.*?):(.*)/.exec(e.name)&&(e.onMessage.addListener(t=>{if(typeof t._method<"u"&&(t._method==="appStarted"||t._method==="appReady")){let r=t._args[0]&&t._args[0].uiName||null,i=Me[r]||{ready:!1};if(Me[r]=i,Object.assign(i,t._args[0],{port:e}),t._method=="appReady"){i.ready=!0,i.initData&&setTimeout(()=>J.rpc.call(r,"wehInitData",i.initData));let n=Fe[r];n&&n.timer&&clearTimeout(n.timer)}e._weh_app=r}J.rpc.receive(t,e.postMessage.bind(e),e._weh_app)}),e.onDisconnect.addListener(()=>{let t=e._weh_app;if(t){delete Me[t];let r=Fe[t];r&&(r.timer&&clearTimeout(r.timer),delete Fe[t],r.reject(new Error("Disconnected waiting for "+t)))}}))}),J.__declareAppTab=function(e,t){Me[e]||(Me[e]={}),Object.assign(Me[e],t)},J.__closeByTab=function(e){Object.keys(Me).forEach(t=>{if(Me[t].tab===e){delete Me[t];let r=Fe[t];r&&(r.timer&&clearTimeout(r.timer),delete Fe[t],r.reject(new Error("Disconnected waiting for "+t)))}})},J._=ns().getMessage,J.ui=Ap(),J.openedContents=()=>Object.keys(Me);function X_(e){let t=0,r;if(e.length===0)return t;for(let i=0;i<e.length;i++)r=e.charCodeAt(i),t=(t<<5)-t+r,t=t&t;return t}function G_(e){return JSON.stringify(Object.keys(e).sort().map(function(t){return{name:t,value:e[t]}}))}var Sp=0;J.unsafe_prefs=ss(),J.prefs=us.storage.local.get("weh-prefs").then(e=>{let t=J.unsafe_prefs,r=e["weh-prefs"]||{};return t.assign(r),t.on("",{pack:!0},function(i,n){Object.assign(r,i);let o=G_(r),a=X_(o);a!=Sp&&(Sp=a,us.storage.local.set({"weh-prefs":r})),Object.keys(Me).forEach(s=>{J.rpc.call(s,"setPrefs",i)})}),t.declare(Tp()),t}).catch(e=>{console.error("web-background error:",e)}),J.wait=(e,t={})=>{let r=Fe[e];return r&&(r.timer&&clearTimeout(r.timer),delete Fe[e],r.reject(new Error("Waiter for "+e+" overriden"))),new Promise((i,n)=>{Fe[e]={resolve:i,reject:n,timer:setTimeout(()=>{delete Fe[e],n(new Error("Waiter for "+e+" timed out"))},t.timeout||6e4)}})},J.rpc.listen({prefsGetAll:async()=>(await J.prefs).getAll(),prefsGetSpecs:async()=>(await J.prefs).getSpecs(),prefsSet:async e=>(await J.prefs).assign(e),trigger:(e,t)=>{let r=Fe[e];if(!r)throw new Error("No waiter for",e);r.timer&&(clearTimeout(r.timer),delete r.timer),delete Fe[e],r.resolve(t)}}),Op.exports=J});var Jt=f((dM,$_)=>{$_.exports={prod:!0,channel:"stable",buildDate:"2024-02-14",buildOptions:{linuxlic:!1,noyt:!0,target:"google",browser:"chrome"}}});var Dp=f((fM,Rp)=>{"use strict";var Q_=Sr(),Pp=Mt(),ls=ss(),En=Q_.browser,wi=null,Mp=null,xi=!1;En.runtime.onMessageExternal&&(En.runtime.onMessageExternal.addListener(function(e,t,r){switch(e.type){case"weh#inspect-ping":wi=t.id,r({type:"weh#inspect-pong",version:1,manifest:En.runtime.getManifest()});break;case"weh#inspect":wi=t.id,xi=e.inspected,xi?Pp.setHook(i=>{xi&&wi&&En.runtime.sendMessage(wi,{type:"weh#inspect-message",message:i}).catch(n=>{console.info("Error sending message",n),xi=!1})}):Pp.setHook(null),r({type:"weh#inspect",version:1,inspected:xi});break;case"weh#get-prefs":wi=t.id,r({type:"weh#prefs",prefs:ls.getAll(),specs:ls.getSpecs()});break;case"weh#set-pref":ls[e.pref]=e.value,r(!0);break}}),Mp={send:()=>{console.info("TODO implement inspect.send")}}),Rp.exports=Mp});var Np={};Z(Np,{removeOriginAndReferrerSetterForUrl:()=>J_,setOriginAndReferrerSetterForUrl:()=>z_});async function z_(e,t,r){if(!(!t&&!r))if(Ip){let i=[];t&&i.push({operation:"set",header:"origin",value:t}),r&&i.push({operation:"set",header:"referer",value:r});let n=K_++,o={id:n,priority:1,action:{type:"modifyHeaders",requestHeaders:i},condition:{urlFilter:e,resourceTypes:["xmlhttprequest"]}};ps.set(e,[n]);try{await Ei.declarativeNetRequest.updateSessionRules({addRules:[o]})}catch{}}else{let i=n=>{let o=n.requestHeaders.filter(a=>a.name!="origin"&&a.name!="referer");return t&&o.push({name:"origin",value:t}),r&&o.push({name:"referer",value:r}),{requestHeaders:o}};cs.set(e,i),Ei.webRequest.onBeforeSendHeaders.addListener(i,{urls:[e]},["blocking","requestHeaders"])}}async function J_(e){if(Ip){let t=ps.get(e);t&&(ps.delete(e),await Ei.declarativeNetRequest.updateSessionRules({removeRuleIds:t}))}else{let t=cs.get(e);t&&(cs.delete(t),Ei.webRequest.onBeforeSendHeaders.removeListener(t))}}var Ei,cs,ps,K_,Ip,Cp=I(()=>{"use strict";({browser:Ei}=z()),cs=new Map,ps=new Map,K_=1,Ip=Ei.runtime.getManifest().manifest_version>=3});var Ae={};Z(Ae,{Cache:()=>ds,Concurrent:()=>c0,DetailsError:()=>gs,VDHError:()=>Tn,arrayEquals:()=>i0,bufferToHex:()=>l0,executeScriptWithGlobal:()=>d0,fromByteArray:()=>o0,generateRandomString:()=>Bp,gotoOrOpenTab:()=>r0,gotoTab:()=>kp,hash:()=>qp,hashHex:()=>t0,headerSubsSalt:()=>s0,isMinimumVersion:()=>p0,request:()=>u0,toByteArray:()=>n0});function qp(e){let t=0,r,i,n;if(e.length===0)return t;for(r=0,n=e.length;r<n;r++)i=e.charCodeAt(r),t=(t<<5)-t+i,t|=0;return t}function t0(e){return Math.abs(qp(e)).toString(16)}function kp(e){return Re.tabs.query({url:e}).then(t=>t.length>0?(Re.tabs.update(t[0].id,{active:!0}),Re.windows.update(t[0].windowId,{focused:!0}),!0):!1)}function r0(e,t=null){let r=0;function i(){return Re.windows.getLastFocused({windowTypes:["normal"]}).then(n=>n.type!="normal"?++r<20?new Promise((o,a)=>{setTimeout(()=>i(),100)}):new Promise((o,a)=>{Re.windows.getAll({windowTypes:["normal"]}).then(s=>{if(s.every(u=>u.type=="normal"?(o(u.id),!1):!0))throw new Error("No normal window to open tab")})}):n.id).then(n=>{let o=null;if(n)return Re.tabs.query({active:!0,lastFocusedWindow:!0}).then(a=>(a.length>0&&(o=a[0].id),new Promise((s,u)=>{let l=null,p=(c,g,A)=>{c==l&&g.status==="complete"&&(Re.tabs.onUpdated.removeListener(p),s(A))};Re.tabs.onUpdated.addListener(p),Re.tabs.create({url:e,windowId:n}).then(c=>{c.status==="complete"?(Re.tabs.onUpdated.removeListener(p),s(c)):l=c.id})}).then(s=>{o&&t&&t(s.id,o)})))})}return kp(e).then(n=>n?Promise.resolve():i())}function i0(e,t){if(e.length!==t.length)return!1;for(let r=0,i=e.length;r<i;r++)if(e[r]!==t[r])return!1;return!0}function Bp(e){let t=new Uint8Array(e);crypto.getRandomValues(t);let r="";for(let i=0;i<t.length;i++)r+=("0"+t[i].toString(16)).slice(-2);return r.substring(0,e)}async function u0(e){let t="include";e.anonymous&&(t="omit");let r=e.url,i=e.method||"GET",n="",o=new Headers;if(e.headers){if(e.headers instanceof Array)for(let u of e.headers)o.append(u.name,u.value);else o=new Headers(e.headers);o.has("referer")&&(n=o.get("referer")),o.has("referrer")&&(n=o.get("referrer"));for(let u of a0)o.delete(u)}let a;e.contentJSON?a=JSON.stringify(e.contentJSON):e.content&&(a=e.content),await Z_(r,o.get("origin"),n);let s;try{s=await fetch(r,{referrer:n,method:i,headers:o,body:a,credentials:t})}finally{await e0(r)}return s}function l0(e){let t=[],r=new DataView(e);for(let i=0;i<r.byteLength;i+=4){let o=r.getUint32(i).toString(16),a="00000000",s=(a+o).slice(-a.length);t.push(s)}return t.join("")}function c0(...e){let t=new fs(...e);return t.callFn().bind(t)}function p0(e="0.0.0",t){let r=e.split(".").map(n=>parseInt(n)),i=t.split(".").map(n=>parseInt(n));for(let n=0;n<r.length;n++){if(typeof i[n]>"u"||r[n]>i[n])return!0;if(r[n]<i[n])return!1}return!0}async function d0(e,t,r){let i=s=>s&&typeof s=="object",n=s=>JSON.parse(JSON.stringify(s));if(!i(t))throw new Error("global argument is not an object");t=n(t);let a={target:e,func:s=>{Object.assign(window,s)},args:[t]};await Re.scripting.executeScript(a),a={target:e,files:[r]},await Re.scripting.executeScript(a)}var Y_,Re,Z_,e0,n0,o0,a0,s0,ds,fs,ms,Tn,gs,_e=I(()=>{"use strict";Y_=z(),Re=Y_.browser,{setOriginAndReferrerSetterForUrl:Z_,removeOriginAndReferrerSetterForUrl:e0}=(Cp(),P(Np));({toByteArray:n0,fromByteArray:o0}=(()=>{let e,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[];for(e=0;e<t.length;e++)r[e]=t[e];let i=[];for(e=0;e<t.length;++e)i[t.charCodeAt(e)]=e;i[45]=62,i[95]=63;let n=typeof Uint8Array<"u"?Uint8Array:Array;function o(c){let g=i[c.charCodeAt(0)];return g!==void 0?g:-1}function a(c){let g,A,d,_,m,y;if(c.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");let v=c.length;m=c.charAt(v-2)==="="?2:c.charAt(v-1)==="="?1:0,y=new n(c.length*3/4-m),d=m>0?c.length-4:c.length;let T=0;function h(x){y[T++]=x}for(g=0,A=0;g<d;g+=4,A+=3)_=o(c.charAt(g))<<18|o(c.charAt(g+1))<<12|o(c.charAt(g+2))<<6|o(c.charAt(g+3)),h((_&16711680)>>>16>>>0),h((_&65280)>>>8>>>0),h((_&255)>>>0);return m===2?(_=o(c.charAt(g))<<2|o(c.charAt(g+1))>>>4>>>0,h(_&255)):m===1&&(_=o(c.charAt(g))<<10|o(c.charAt(g+1))<<4|o(c.charAt(g+2))>>>2>>>0,h(_>>>8>>>0&255),h(_&255)),y}function s(c){return r[c]}function u(c){return s(c>>>18>>>0&63)+s(c>>>12>>>0&63)+s(c>>>6>>>0&63)+s(c&63)}function l(c,g,A){let d,_=[];for(let m=g;m<A;m+=3)d=(c[m]<<16)+(c[m+1]<<8)+c[m+2],_.push(u(d));return _.join("")}function p(c){let g,A=c.length%3,d="",_=[],m,y,v=16383;for(g=0,y=c.length-A;g<y;g+=v)_.push(l(c,g,g+v>y?y:g+v));switch(A){case 1:m=c[c.length-1],d+=s(m>>>2>>>0),d+=s(m<<4&63),d+="==";break;case 2:m=(c[c.length-2]<<8)+c[c.length-1],d+=s(m>>>10>>>0),d+=s(m>>>4>>>0&63),d+=s(m<<2&63),d+="=";break;default:break}return _.push(d),_.join("")}return{toByteArray:a,fromByteArray:p}})()),a0=["Accept-Charset","Accept-Encoding","Access-Control-Request-Headers","Access-Control-Request-Method","Connection","Content-Length","Cookie","Cookie2","Date","DNT","Expect","Host","Keep-Alive","Referer","TE","Trailer","Transfer-Encoding","Upgrade","Via","x-chrome-uma-enabled","x-client-data"];s0=Bp(8);ds=class{constructor(t,r){this.getFn=t,this.setFn=r,this.callbacks=[],this.queried=!1,this.value=void 0}get(){let t=this;return()=>typeof t.value<"u"?Promise.resolve(t.value):new Promise((r,i)=>{if(t.callbacks.push({resolve:r,reject:i}),!t.queried){t.queried=!0;try{Promise.resolve(t.getFn()).then(n=>{for(t.value=n;t.callbacks.length;)t.callbacks.shift().resolve(n)}).catch(n=>{for(;t.callbacks.length;)t.callbacks.shift().reject(n)})}catch(n){for(t.queried=!1;t.callbacks.length;)t.callbacks.shift().reject(n)}}})}set(t){if(!this.setFn)return Promise.reject(new Error("Value is read-only"));if(typeof t>"u")return Promise.reject(new Error("Cannot set undefined value"));for(this.value=t;this.callbacks.length;)this.callbacks.shift().resolve();return this.setFn(t),Promise.resolve()}},fs=class{constructor(t=1){this.maxFn=t,this.pendings=[],this.count=0}async getMax(){return typeof this.maxFn=="function"?this.maxFn():this.maxFn}callFn(){let t=this;return(r,i)=>t.getMax().then(n=>t.count<n?t.doCall(r):new Promise((o,a)=>{let s=()=>Promise.resolve(r()).then(o).catch(a);t.pendings.push(s),i&&i(u=>{let l=t.pendings.indexOf(s);l>=0&&(t.pendings.splice(l,1),o(u))},u=>{let l=t.pendings.indexOf(s);l>=0&&(t.pendings.splice(l,1),a(u))})}))}attempt(){if(this.pendings.length>0){let t=this;t.getMax().then(r=>{t.count<r&&t.doCall(t.pendings.shift())})}}doCall(t){let r=this;return this.count++,Promise.resolve(t()).then(i=>(r.count--,r.attempt(),i)).catch(i=>{throw r.count--,r.attempt(),i})}};ms=class extends Error{constructor(t){super(t),this.name=this.constructor.name,typeof Error.captureStackTrace=="function"?Error.captureStackTrace(this,this.constructor):this.stack=new Error(t).stack}},Tn=class extends ms{constructor(t,r){super(t),Object.assign(this,r)}},gs=class extends Tn{constructor(t,r){super(t,{_details:r})}get details(){return this._details}toString(){return`${this.message}: ${this._details}`}}});var Fp={};Z(Fp,{Downloads:()=>hs});var hs,Vp=I(()=>{"use strict";hs=class{constructor(t){this.coapp=t}download(t){return this.coapp.call("downloads.download",t)}search(t){return this.coapp.call("downloads.search",t)}cancel(t){return this.coapp.call("downloads.cancel",t)}}});var Or,ze,Hp=I(()=>{Or=e=>Object.prototype.toString.call(e).slice(8,-1),ze=e=>typeof e=="string"||e instanceof String});var f0,Sn,Wp,jp,m0,Lp,g0,Xp,Up,ys,vs,Pr,Yt,bs,As,h0,y0,v0,Gp,$p=I(()=>{Hp();f0=10,Sn="0|[1-9]\\d*",Wp="\\d*[A-Z-][A-Z\\d-]*",jp=`(?:${Wp}|${Sn})`,m0=`${jp}(?:\\.${jp})*`,Lp=`(?:${Wp}|\\d+)`,g0=`${Lp}(?:\\.${Lp})*`,Xp=`((?:${Sn})(?:\\.(?:${Sn})){2})(?:-(${m0}))?(?:\\+(${g0}))?`,Up=new RegExp(`^(?:${Sn})$`),ys=new RegExp(`^v?${Xp}$`,"i"),vs=new RegExp(`^${Xp}$`,"i"),Pr=(e,t=!1)=>{if(!ze(e))throw new TypeError(`Expected String but got ${Or(e)}.`);return(t?vs:ys).test(e)},Yt=(e,t=!1)=>{if(!ze(e))throw new TypeError(`Expected String but got ${Or(e)}.`);if(!(t||Up.test(e)))throw new Error(`${e} is not a stringified positive integer.`);let r;if(Up.test(e)){if(r=parseInt(e,f0),!Number.isSafeInteger(r))throw new RangeError(`${r} exceeds ${Number.MAX_SAFE_INTEGER}.`)}else r=e;return r},bs=(e,t,r=!1)=>{if(!ze(e))throw new TypeError(`Expected String but got ${Or(e)}.`);if(!ze(t))throw new TypeError(`Expected String but got ${Or(t)}.`);if(!Pr(e,!!r))throw new Error(`${e} is not valid version string.`);if(!Pr(t,!!r))throw new Error(`${t} is not valid version string.`);let i;if(e===t)i=0;else{let n=r?vs:ys,[,o,a]=e.match(n),[,s,u]=t.match(n),[l,p,c]=o.split(".").map(_=>Yt(_)),[g,A,d]=s.split(".").map(_=>Yt(_));if(l>g)i=1;else if(l<g)i=-1;else if(p>A)i=1;else if(p<A)i=-1;else if(c>d)i=1;else if(c<d)i=-1;else if(a===u)i=0;else if(!a&&u)i=1;else if(a&&!u)i=-1;else{let _=a.split(".").map(T=>Yt(T,!0)),m=u.split(".").map(T=>Yt(T,!0)),y=Math.max(_.length,m.length),v=0;for(;v<y;){let T=_[v],h=m[v];if(T&&!h||ze(T)&&Number.isInteger(h)?i=1:!T&&h||Number.isInteger(T)&&ze(h)?i=-1:T!==h&&ze(T)&&ze(h)?i=T.localeCompare(h):Number.isInteger(T)&&Number.isInteger(h)&&(T>h?i=1:T<h&&(i=-1)),Number.isInteger(i))break;v++}}}return i},As=(e,t=!1)=>{if(!ze(e))throw new TypeError(`Expected String but got ${Or(e)}.`);let r=Pr(e,!!t),i,n,o,a,s;if(r){let u=t?vs:ys,[,l,p,c]=e.match(u);[i,n,o]=l.split(".").map(g=>Yt(g)),p&&(a=p.split(".").map(g=>Yt(g,!0))),c&&(s=c.split(".").map(g=>Yt(g,!0)))}return{version:e,matches:r,major:i,minor:n,patch:o,pre:a,build:s}},h0=async(e,t,r=!1)=>bs(e,t,r),y0=async(e,t=!1)=>Pr(e,t),v0=async(e,t=!1)=>As(e,t),Gp={compareSemVer:h0,isValidSemVer:y0,parseSemVer:v0}});var Qp={};Z(Qp,{compareSemVer:()=>bs,isValidSemVer:()=>Pr,parseSemVer:()=>As,promises:()=>Gp});var Kp=I(()=>{$p();});var Jp=f((vM,zp)=>{"use strict";var b0=Sr(),_s=b0.browser,On=Mt(),Ti=class{constructor(){this.listeners=[]}addListener(t){this.listeners.push(t)}removeListener(t){this.listeners=this.listeners.filter(r=>t!==r)}removeAllListeners(){this.listeners=[]}notify(...t){this.listeners.forEach(r=>{try{r(...t)}catch(i){console.warn(i)}})}},Rt=1,Pn=2,ws=class{constructor(t,r={}){this.appId=t,this.name=r.name||t,this.appPort=null,this.pendingCalls=[],this.runningCalls=[],this.state="idle",this.postFn=this.post.bind(this),this.postMessageFn=this.postMessage.bind(this),this.onAppNotFound=new Ti,this.onAppNotFoundCheck=new Ti,this.onCallCount=new Ti,this.appStatus="unknown",this.app2AddonCallCount=0,this.addon2AppCallCount=0}post(t,r){this.appPort.postMessage(r)}postMessage(t){this.appPort.postMessage(t)}updateCallCount(t,r){switch(t){case Pn:this.app2AddonCallCount+=r;break;case Rt:this.addon2AppCallCount+=r;break}this.onCallCount.notify(this.addon2AppCallCount,this.app2AddonCallCount)}close(){if(this.appPort)try{this.appPort.disconnect(),this.cleanup()}catch{}}call(...t){return this.callCatchAppNotFound(null,...t)}callCatchAppNotFound(t,...r){let i=this;function n(o){let a;for(;a=i.pendingCalls.shift();)if(o)a.reject(o);else{i.runningCalls.push(a);let s=a;On.call(i.postFn,i.name,...a.params).then(u=>(i.runningCalls.splice(i.runningCalls.indexOf(s),1),u)).then(s.resolve).catch(u=>{i.runningCalls.splice(i.runningCalls.indexOf(s),1),s.reject(u)})}}switch(t&&(i.appStatus=="unknown"||i.appStatus=="checking")&&i.onAppNotFoundCheck.addListener(t),i.updateCallCount(Rt,1),this.state){case"running":return new Promise((o,a)=>{let s={resolve:o,reject:a,params:[...r]};i.runningCalls.push(s),On.call(i.postFn,i.name,...r).then(u=>(i.runningCalls.splice(i.runningCalls.indexOf(s),1),u)).then(s.resolve).catch(u=>{i.runningCalls.splice(i.runningCalls.indexOf(s),1),s.reject(u)})}).then(o=>(i.updateCallCount(Rt,-1),o)).catch(o=>{throw i.updateCallCount(Rt,-1),o});case"idle":return i.state="pending",new Promise((o,a)=>{i.pendingCalls.push({resolve:o,reject:a,params:[...r]});let s=_s.runtime.connectNative(i.appId);i.appStatus="checking",i.appPort=s,s.onMessage.addListener(u=>{i.appStatus=="checking"&&(i.appStatus="ok",i.onAppNotFoundCheck.removeAllListeners()),On.receive(u,i.postMessageFn,i.name)}),s.onDisconnect.addListener(()=>{n(new Error("Disconnected")),i.cleanup(),i.appStatus=="checking"&&!t&&i.onAppNotFound.notify(i.appPort&&i.appPort.error||_s.runtime.lastError)}),i.state="running",n()}).then(o=>(i.updateCallCount(Rt,-1),o)).catch(o=>{throw i.updateCallCount(Rt,-1),o});case"pending":return new Promise((o,a)=>{i.pendingCalls.push({resolve:o,reject:a,params:[...r]})}).then(o=>(i.updateCallCount(Rt,-1),o)).catch(o=>{throw i.updateCallCount(Rt,-1),o})}}listen(t){let r=this,i={};return Object.keys(t).forEach(n=>{i[n]=(...o)=>(r.updateCallCount(Pn,1),Promise.resolve(t[n](...o)).then(a=>(r.updateCallCount(Pn,-1),a)).catch(a=>{throw r.updateCallCount(Pn,-1),a}))}),On.listen(i)}cleanup(){let t=this;t.appStatus=="checking"&&(t.onAppNotFoundCheck.notify(t.appPort&&t.appPort.error||_s.runtime.lastError),t.onAppNotFoundCheck.removeAllListeners());let r;for(;r=t.runningCalls.shift();)r.reject(new Error("Native port disconnected"));t.state="idle",t.appStatus="unknown",t.appPort=null}};zp.exports=function(...e){return new ws(...e)}});async function Mn(e,t){return(await xs.storage.local.get({[e]:t}))[e]}async function Rn(e,t){await xs.storage.local.set({[e]:t})}var xs,Dn=I(()=>{"use strict";xs=wn(ts(),1)});function Dt(e){var t=String(e);if(t==="[object Object]")try{t=JSON.stringify(e)}catch{}return t}var Es=I(()=>{});var A0,M,_0,N,Si,Ts=I(()=>{Es();In();A0=function(){function e(){}return e.prototype.isSome=function(){return!1},e.prototype.isNone=function(){return!0},e.prototype[Symbol.iterator]=function(){return{next:function(){return{done:!0,value:void 0}}}},e.prototype.unwrapOr=function(t){return t},e.prototype.expect=function(t){throw new Error("".concat(t))},e.prototype.unwrap=function(){throw new Error("Tried to unwrap None")},e.prototype.map=function(t){return this},e.prototype.mapOr=function(t,r){return t},e.prototype.mapOrElse=function(t,r){return t()},e.prototype.or=function(t){return t},e.prototype.orElse=function(t){return t()},e.prototype.andThen=function(t){return this},e.prototype.toResult=function(t){return $(t)},e.prototype.toString=function(){return"None"},e}(),M=new A0;Object.freeze(M);_0=function(){function e(t){if(!(this instanceof e))return new e(t);this.value=t}return e.prototype.isSome=function(){return!0},e.prototype.isNone=function(){return!1},e.prototype[Symbol.iterator]=function(){var t=Object(this.value);return Symbol.iterator in t?t[Symbol.iterator]():{next:function(){return{done:!0,value:void 0}}}},e.prototype.unwrapOr=function(t){return this.value},e.prototype.expect=function(t){return this.value},e.prototype.unwrap=function(){return this.value},e.prototype.map=function(t){return N(t(this.value))},e.prototype.mapOr=function(t,r){return r(this.value)},e.prototype.mapOrElse=function(t,r){return r(this.value)},e.prototype.or=function(t){return this},e.prototype.orElse=function(t){return this},e.prototype.andThen=function(t){return t(this.value)},e.prototype.toResult=function(t){return X(this.value)},e.prototype.safeUnwrap=function(){return this.value},e.prototype.toString=function(){return"Some(".concat(Dt(this.value),")")},e.EMPTY=new e(void 0),e}(),N=_0;(function(e){function t(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];for(var a=[],s=0,u=n;s<u.length;s++){var l=u[s];if(l.isSome())a.push(l.value);else return l}return N(a)}e.all=t;function r(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];for(var a=0,s=n;a<s.length;a++){var u=s[a];return u.isSome(),u}return M}e.any=r;function i(n){return n instanceof N||n===M}e.isOption=i})(Si||(Si={}))});var w0,$,x0,X,Nn,In=I(()=>{Es();Ts();Os();w0=function(){function e(t){if(!(this instanceof e))return new e(t);this.error=t;var r=new Error().stack.split(`
`).slice(2);r&&r.length>0&&r[0].includes("ErrImpl")&&r.shift(),this._stack=r.join(`
`)}return e.prototype.isOk=function(){return!1},e.prototype.isErr=function(){return!0},e.prototype[Symbol.iterator]=function(){return{next:function(){return{done:!0,value:void 0}}}},e.prototype.else=function(t){return t},e.prototype.unwrapOr=function(t){return t},e.prototype.expect=function(t){throw new Error("".concat(t," - Error: ").concat(Dt(this.error),`
`).concat(this._stack),{cause:this.error})},e.prototype.expectErr=function(t){return this.error},e.prototype.unwrap=function(){throw new Error("Tried to unwrap Error: ".concat(Dt(this.error),`
`).concat(this._stack),{cause:this.error})},e.prototype.unwrapErr=function(){return this.error},e.prototype.map=function(t){return this},e.prototype.andThen=function(t){return this},e.prototype.mapErr=function(t){return new $(t(this.error))},e.prototype.mapOr=function(t,r){return t},e.prototype.mapOrElse=function(t,r){return t(this.error)},e.prototype.or=function(t){return t},e.prototype.orElse=function(t){return t(this.error)},e.prototype.toOption=function(){return M},e.prototype.toString=function(){return"Err(".concat(Dt(this.error),")")},Object.defineProperty(e.prototype,"stack",{get:function(){return"".concat(this,`
`).concat(this._stack)},enumerable:!1,configurable:!0}),e.prototype.toAsyncResult=function(){return new Ss(this)},e.EMPTY=new e(void 0),e}(),$=w0,x0=function(){function e(t){if(!(this instanceof e))return new e(t);this.value=t}return e.prototype.isOk=function(){return!0},e.prototype.isErr=function(){return!1},e.prototype[Symbol.iterator]=function(){var t=Object(this.value);return Symbol.iterator in t?t[Symbol.iterator]():{next:function(){return{done:!0,value:void 0}}}},e.prototype.else=function(t){return this.value},e.prototype.unwrapOr=function(t){return this.value},e.prototype.expect=function(t){return this.value},e.prototype.expectErr=function(t){throw new Error(t)},e.prototype.unwrap=function(){return this.value},e.prototype.unwrapErr=function(){throw new Error("Tried to unwrap Ok: ".concat(Dt(this.value)),{cause:this.value})},e.prototype.map=function(t){return new X(t(this.value))},e.prototype.andThen=function(t){return t(this.value)},e.prototype.mapErr=function(t){return this},e.prototype.mapOr=function(t,r){return r(this.value)},e.prototype.mapOrElse=function(t,r){return r(this.value)},e.prototype.or=function(t){return this},e.prototype.orElse=function(t){return this},e.prototype.toOption=function(){return N(this.value)},e.prototype.safeUnwrap=function(){return this.value},e.prototype.toString=function(){return"Ok(".concat(Dt(this.value),")")},e.prototype.toAsyncResult=function(){return new Ss(this)},e.EMPTY=new e(void 0),e}(),X=x0;(function(e){function t(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];for(var u=[],l=0,p=a;l<p.length;l++){var c=p[l];if(c.isOk())u.push(c.value);else return c}return new X(u)}e.all=t;function r(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];for(var u=[],l=0,p=a;l<p.length;l++){var c=p[l];if(c.isOk())return c;u.push(c.error)}return new $(u)}e.any=r;function i(a){try{return new X(a())}catch(s){return new $(s)}}e.wrap=i;function n(a){try{return a().then(function(s){return new X(s)}).catch(function(s){return new $(s)})}catch(s){return Promise.resolve(new $(s))}}e.wrapAsync=n;function o(a){return a instanceof $||a instanceof X}e.isResult=o})(Nn||(Nn={}))});var Yp,Zp,Ss,Os=I(()=>{In();Yp=function(e,t,r,i){function n(o){return o instanceof r?o:new r(function(a){a(o)})}return new(r||(r=Promise))(function(o,a){function s(p){try{l(i.next(p))}catch(c){a(c)}}function u(p){try{l(i.throw(p))}catch(c){a(c)}}function l(p){p.done?o(p.value):n(p.value).then(s,u)}l((i=i.apply(e,t||[])).next())})},Zp=function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,n,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(p){return u([l,p])}}function u(l){if(i)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(r=0)),r;)try{if(i=1,n&&(o=l[0]&2?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(l[0]===6&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(p){l=[6,p],n=0}finally{i=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},Ss=function(){function e(t){this.promise=Promise.resolve(t)}return e.prototype.andThen=function(t){var r=this;return this.thenInternal(function(i){return Yp(r,void 0,void 0,function(){var n;return Zp(this,function(o){return i.isErr()?[2,i]:(n=t(i.value),[2,n instanceof e?n.promise:n])})})})},e.prototype.map=function(t){var r=this;return this.thenInternal(function(i){return Yp(r,void 0,void 0,function(){var n;return Zp(this,function(o){switch(o.label){case 0:return i.isErr()?[2,i]:(n=X,[4,t(i.value)]);case 1:return[2,n.apply(void 0,[o.sent()])]}})})})},e.prototype.thenInternal=function(t){return new e(this.promise.then(t))},e}()});var ed=I(()=>{Os();In();Ts()});var de=I(()=>{"use strict";ed()});var Ve=I(()=>{"use strict";de()});function fe(e){return Object.assign(e.prototype,{find:function(t){for(let r of this)if(t(r))return N(r);return M},count:function(t){return this.reduce((r,i)=>(t(i)&&r++,r),0)},reduce:function(t,r){let i=r;for(let n of this)i=t(i,n);return i},every:function(t){return!this.any(r=>!t(r))},any:function(t){for(let r of this)if(t(r))return!0;return!1},map:function(t){return this.filterMap(r=>N(t(r)))},filter:function(t){return this.filterMap(r=>t(r)?N(r):M)},enumerate:function(){let t=this;return fe(function*(){let r=0;for(let i of t)yield[r,i],r++})()},filterMap:function(t){let r=this;return fe(function*(){for(let i of r){let n=t(i);n.isSome()&&(yield n.unwrap())}})()},sort:function(t){let r=this.toArray();return r.sort(t),r},toArray:function(){return[...this]}}),e}var Cn=I(()=>{"use strict";de();Ve();Array.prototype.as_iter||(Array.prototype.as_iter=function(){let e=this;return fe(function*(){for(let t of e)yield t})()});Set.prototype.as_iter||(Set.prototype.as_iter=function(){let e=this;return fe(function*(){for(let t of e)yield t})()});Map.prototype.as_iter||(Map.prototype.as_iter=function(){let e=this;return fe(function*(){for(let t of e)yield t})()})});function He(e){return qn[e]}function dt(e){return Ps[e]}function Ms(e){return typeof e=="string"&&e in qn?N(e):M}var Mr,qn,Ps,Rr,Dr,ft=I(()=>{"use strict";de();Cn();Ve();Mr=/.^/,qn={Av1:{name:"Av1",type:"video",mimetype:/av01.*/i,defacto_container:"WebM"},H264:{name:"H264",type:"video",mimetype:/avc1.*/i,defacto_container:"Mp4"},H263:{name:"H263",type:"video",mimetype:Mr,defacto_container:"3gp"},H265:{name:"H265",type:"video",mimetype:/(hvc1|hevc|h265|h\.265).*/i,defacto_container:"Mp4"},MP4V:{name:"MP4V",type:"video",mimetype:/mp4v\.20.*/i,defacto_container:"Mp4"},MPEG1:{name:"MPEG1",type:"video",mimetype:Mr,defacto_container:"Mpeg"},MPEG2:{name:"MPEG2",type:"video",mimetype:Mr,defacto_container:"Mpeg"},Theora:{name:"Theora",type:"video",mimetype:/theora/i,defacto_container:"Ogg"},VP8:{name:"VP8",type:"video",mimetype:/vp0?8.*/i,defacto_container:"WebM"},VP9:{name:"VP9",type:"video",mimetype:/vp0?9.*/i,defacto_container:"WebM"},unknown:{name:"unknown",type:"video",mimetype:Mr,defacto_container:"Mp4"}},Ps={AAC:{name:"AAC",type:"audio",mimetype:/(aac|mp4a.40).*/i,defacto_container:"Mp4"},PCM:{name:"PCM",type:"audio",mimetype:/pcm.*/i,defacto_container:"Wav"},FLAC:{name:"FLAC",type:"audio",mimetype:/flac/i,defacto_container:"Flac"},MP3:{name:"MP3",type:"audio",mimetype:/(\.?mp3|mp4a\.69|mp4a\.6b).*/i,defacto_container:"Mpeg"},Opus:{name:"Opus",type:"audio",mimetype:/(opus|(mp4a\.ad.*))/i,defacto_container:"Ogg"},Vorbis:{name:"Vorbis",type:"audio",mimetype:/vorbis/i,defacto_container:"Ogg"},Wav:{name:"Wav",type:"audio",mimetype:Mr,defacto_container:"Wav"},unknown:{name:"unknown",type:"audio",mimetype:Mr,defacto_container:"Mp4"}},Rr=fe(function*(){for(let e of Object.keys(qn))yield qn[e]}),Dr=fe(function*(){for(let e of Object.keys(Ps))yield Ps[e]})});function Ds(e){return typeof e=="string"&&e in kn?N(e):M}function td(e){for(let t of Rs()){if(t.extension===e)return N(t);if(t.audio_only_extension&&t.audio_only_extension===e)return N(t)}return M}function le(e){return kn[e]}var kn,E0,Rs,mt=I(()=>{"use strict";de();Cn();ft();Ve();kn={M2TS:{name:"M2TS",extension:"mt2s",audio_only_extension:"mp3",defacto_codecs:{audio:M,video:M},supported_video_codecs:["H264","H265","Av1","MP4V","MPEG2","VP9","unknown"],supported_audio_codecs:["Opus","MP3","FLAC","AAC"],mimetype:/(?:x-)?flv/i},MP2T:{name:"MP2T",extension:"mp2t",audio_only_extension:"mp3",defacto_codecs:{audio:N("MP3"),video:N("H264")},supported_video_codecs:["MPEG2","MPEG1"],supported_audio_codecs:["MP3"],mimetype:/(?:x-)?mp2t/i},Flash:{name:"Flash",extension:"flv",audio_only_extension:"mp3",defacto_codecs:{audio:M,video:M},supported_video_codecs:["H264"],supported_audio_codecs:["AAC"],mimetype:/(?:x-)?flv/i},Mp4:{name:"Mp4",extension:"mp4",audio_only_extension:"mp3",defacto_codecs:{audio:M,video:M},supported_video_codecs:["H264","H265","Av1","MP4V","MPEG2","unknown"],supported_audio_codecs:["Opus","MP3","FLAC","AAC","unknown"],mimetype:/(?:x-)?mp4/i},Flac:{name:"Flac",extension:"flac",audio_only_extension:"flac",defacto_codecs:{audio:N("FLAC"),video:M},supported_video_codecs:[],supported_audio_codecs:["FLAC"],mimetype:/(?:x-)?flac/i},Mpeg:{name:"Mpeg",extension:"mpeg",audio_only_extension:"mp3",defacto_codecs:{audio:N("MP3"),video:N("H264")},supported_video_codecs:["MPEG2","MPEG1"],supported_audio_codecs:["MP3"],mimetype:/(?:x-)?mpeg/i},Ogg:{name:"Ogg",extension:"ogv",audio_only_extension:"oga",defacto_codecs:{audio:M,video:M},supported_video_codecs:["VP9","VP8","Theora"],supported_audio_codecs:["Opus","Vorbis","FLAC"],mimetype:/(?:x-)?og./i},Wav:{name:"Wav",extension:"wav",audio_only_extension:"wav",defacto_codecs:{audio:N("Wav"),video:M},supported_video_codecs:[],supported_audio_codecs:["Wav","PCM"],mimetype:/(?:x-)?(?:pn-)?wave?/i},Mkv:{name:"Mkv",extension:"mkv",audio_only_extension:"mp3",defacto_codecs:{audio:M,video:M},supported_video_codecs:Rr().filter(e=>e.name!="unknown").map(e=>e.name).toArray(),supported_audio_codecs:Dr().filter(e=>e.name!="unknown").map(e=>e.name).toArray(),mimetype:/(?:x-)?matroska/i},"3gp":{name:"3gp",extension:"3gpp",audio_only_extension:"mp3",defacto_codecs:{audio:M,video:M},supported_video_codecs:["H264","H263","MP4V","VP8"],supported_audio_codecs:["MP3","AAC"],mimetype:/(?:x-)?3gpp2?/i},QuickTime:{name:"QuickTime",extension:"mov",audio_only_extension:"mp3",defacto_codecs:{audio:M,video:M},supported_video_codecs:["MPEG1","MPEG2"],supported_audio_codecs:[],mimetype:/(?:x-)?mov/i},WebM:{name:"WebM",extension:"webm",audio_only_extension:"oga",defacto_codecs:{audio:M,video:M},supported_video_codecs:["H264","VP8","VP9","Av1"],supported_audio_codecs:["Opus","Vorbis"],mimetype:/(?:x-)?webm/i}},E0=fe(function*(){for(let e of Object.keys(kn))yield e}),Rs=fe(function*(){for(let e of E0())yield kn[e]})});function rd(e,t){let r=!!e.audio,i=!!t.audio,n=!!e.video,o=!!t.video;return r===i&&n&&o}function gt(e,t,r){if(e.audio&&e.video)return{audio:t(e.audio),video:r(e.video)};if(e.video)return{video:r(e.video),audio:!1};if(e.audio)return{audio:t(e.audio),video:!1};throw"unreachable"}var Ir=I(()=>{"use strict"});function nd(e,t){let r=parseInt(e),i=parseInt(t);return r<i}function Bn(e,t){let r=parseInt(e),i=parseInt(t);return r>i}function od(e){for(let t of Fn())if(e.includes(t))return N(t);return M}function Nr(e){let t=Fn().map(r=>parseInt(r)).toArray();t.sort((r,i)=>r-i),t.reverse();for(let r of t)if(e>=r)return r.toString();return T0}function Vn(e){if(typeof e=="string")return Fn().find(t=>t==e);if(typeof e=="number"){let t=e.toString();return Vn(t)}return M}var T0,id,Fn,oR,Cr=I(()=>{"use strict";de();Cn();Ve();T0="240",id={240:{id:"240",loose_name:"Small"},360:{id:"360",loose_name:"SD"},480:{id:"480",loose_name:"SD"},720:{id:"720",loose_name:"HD"},1080:{id:"1080",loose_name:"FullHD"},1440:{id:"1440",loose_name:"UHD"},2160:{id:"2160",loose_name:"UHD"},4320:{id:"4320",loose_name:"UHD"}};Fn=fe(function*(){for(let e of Object.keys(id))yield e}),oR=fe(function*(){for(let e of Fn())yield id[e]})});function Hn(){return{codec:He("unknown"),fps:M,dimensions:M,quality:M,bitrate:M}}function ad(e,t,r){if(e.protocol==="hls"&&t.protocol!="hls")return-1;if(t.protocol==="hls"&&e.protocol!="hls"||e.protocol==="non-adaptative"&&t.protocol!="non-adaptative")return 1;if(t.protocol==="non-adaptative"&&e.protocol!="non-adaptative")return-1;if(e.container.name!=t.container.name){if(e.container.name==r.container)return-1;if(t.container.name==r.container)return 1;let a=r.ignored_containers.includes(e.container.name),s=r.ignored_containers.includes(t.container.name);if(!a&&s)return-1;if(a&&!s)return 1}if(!rd(e.av,t.av)){if(e.av.audio&&e.av.video)return-1;if(t.av.audio&&t.av.video)return 1;if(e.av.video)return-1;if(t.av.video)return 1}if(e.duration&&t.duration){if(e.duration>t.duration)return-1;if(t.duration>e.duration)return 1}if(e.av.video&&t.av.video){let a=e.av.video,s=t.av.video;if(a.codec.name!=s.codec.name){if(a.codec.name==r.video_codec)return-1;if(s.codec.name==r.video_codec)return 1;let u=r.ignored_video_codecs.includes(a.codec.name),l=r.ignored_video_codecs.includes(s.codec.name);if(!u&&l)return-1;if(u&&!l)return 1}if(a.dimensions.isSome()){if(s.dimensions.isNone())return-1;let u=a.dimensions.unwrap(),l=s.dimensions.unwrap();if(u.height>l.height)return-1;if(l.height>u.height)return 1}if(a.quality.isSome()){if(s.quality.isNone())return-1;let u=a.quality.unwrap(),l=s.quality.unwrap(),p=A=>Bn(A,r.best_video_quality)||nd(A,r.lowest_video_quality),c=p(u),g=p(l);if(!c&&g)return-1;if(c&&!g)return 1;if(Bn(u,l))return-1;if(Bn(l,u))return 1}if(a.bitrate.isSome()){if(s.bitrate.isNone())return-1;let u=a.bitrate.unwrap(),l=s.bitrate.unwrap();if(u>l)return-1;if(l>u)return 1}if(a.fps.isSome()){if(s.fps.isNone())return-1;let u=a.fps.unwrap(),l=s.fps.unwrap();if(u!=l){if(u==60&&r.prefer_60fps||l==60&&r.prefer_60fps||u>l)return-1;if(l>u)return 1}}}return 0}function sd(e,t){let r={...t};return r.duration==="unknown"&&(r.duration=e.duration),r.av.audio||(r.av.audio=e.av.audio),r.av.video||(r.av.video=e.av.video),e.av.audio&&r.av.audio&&(r.av.audio.codec.name=="unknown"&&(r.av.audio.codec=e.av.audio.codec),r.av.audio.bitrate.isNone()&&(r.av.audio.bitrate=e.av.audio.bitrate)),e.av.video&&r.av.video&&(r.av.video.codec.name=="unknown"&&(r.av.video.codec=e.av.video.codec),r.av.video.quality.isNone()&&(r.av.video.quality=e.av.video.quality),r.av.video.dimensions.isNone()&&(r.av.video.dimensions=e.av.video.dimensions),r.av.video.fps.isNone()&&(r.av.video.fps=e.av.video.fps),r.av.video.bitrate.isNone()&&(r.av.video.bitrate=e.av.video.bitrate)),r}var Oi=I(()=>{"use strict";de();mt();ft();Ir();Cr();Ve()});var ud,ld,cd,pd,dd=I(()=>{"use strict";ud=Object.keys({id:1,actions:1,status:1,raw_bitrate:1,operation:1,description:1,opStartDate:1,descrPrefix:1,title:1,topUrl:1,thumbnail:1,thumbnailUrl:1,size:1,duration:1,quality:1,bitrate:1,length:1,mediaDomain:1,type:1,extension:1,originalExt:1}),ld=Object.keys({id:1,type:1,originalExt:1,running:1,localFilePath:1,localDirectory:1,extension:1,extensions:1,baseJs:1,chunked:1,proxy:1,isPrivate:1,possibleContentRedirect:1,urls:1,masterManifest:1,audioMediaManifest:1,videoMediaManifest:1,headers:1,title:1,referrer:1,convert:1,baseUrl:1,mpd_url:1,mpd_video_id:1,mpd_audio_id:1,gallery_urls:1,bulk_ids:1,bulk:1,tabId:1}),cd=Object.keys({group:1}),pd=["url","videoUrl","audioUrl","topUrl","pageUrl","mediaManifest","mediaDomain"]});function fd(e,t,r){return new Map([...e.entries()].filter(([,i])=>!t.some(o=>pd.some(a=>{if(a in i){let s=i[a];if(typeof s=="string")try{let l=new URL(s).hostname.split(".").reverse();for(let p=0;p<l.length;p++)if(l[p]!=o[p])return!1;return!0}catch{}}return!1}))).filter(([,i])=>i.status=="running"?!0:!(typeof i.length=="number"&&i.length<r)))}function md(e,t){let r=new Map;for(let a of e.values()){let s=a.group??a.id;r.has(s)||r.set(s,[]),r.get(s).push(a)}let i=[...r.values()];for(let a of i)a.sort((s,u)=>!s.core_media||!u.core_media?(console.warn("No core_media for hit"),0):ad(s.core_media,u.core_media,t));i.sort((a,s)=>{let c=a[0]?.core_media?.builder,g=s[0]?.core_media?.builder;return c===g?0:c==="HTTPMedia"?1:g==="HTTPMedia"?-1:c==="NakedHls"?1:g==="NakedHls"||c==="Hls"?-1:g==="Hls"?1:c==="MPDParser"?-1:g==="MPDParser"?1:0});let n=a=>{let s=a[0]?.status=="active",u=a[0]?.core_media?.builder==="Hls"||a[0]?.core_media?.builder==="JsonMPDParser"||a[0]?.core_media?.builder==="MPDParser";return s&&u},o=a=>a.every(s=>s.status=="active");return t.ignore_low_quality_hits&&i.some(n)&&(i=i.filter(a=>{let s=o(a),u=n(a);return!(s&&!u)})),i.map(a=>a.map(s=>{let u={};for(let l of ud)u[l]=s[l];for(let l of ld)u[l]=s[l];for(let l of cd)u[l]=s[l];return u}).slice(0,t.max_variants))}var gd=I(()=>{"use strict";Oi();dd()});var Zt,qr,jn=I(()=>{"use strict";Zt=(e,t)=>typeof e[t]=="string",qr=(e,t)=>typeof e[t]=="number"});function Pi(e){try{if(Zt(e,"__serializer_tag")){if(e.__serializer_tag==="primitive")return X(e.__serializer_value);if(e.__serializer_tag==="array"){let i=[];for(let n of e.__serializer_value){let o=Pi(n);if(o.isErr())return o;i.push(o.unwrap())}return X(i)}else if(e.__serializer_tag==="option_some"){let i=e.__serializer_value,n=Pi(i);return n.isErr()?n:X(N(n.unwrap()))}else if(e.__serializer_tag==="option_none")return X(M)}let t=typeof e;if(t==="string"||t==="number"||t==="boolean"||t==="undefined"||Array.isArray(e)||e==null)return $("This object was not serialized with Serialize");let r={};for(let i of Object.keys(e))if(typeof i=="string"){let n=Pi(e[i]);if(n.isErr())return n;r[i]=n.unwrap()}return X(r)}catch{return $("Failed to inspect object. Not JSON?")}}var hd=I(()=>{"use strict";de();jn();Ve()});function S0(){return{prefer_60fps:!0,ignore_low_quality_hits:!0,max_variants:3,container:"Mp4",video_codec:"H264",best_video_quality:"4320",lowest_video_quality:"480",ignored_containers:[],ignored_video_codecs:[]}}function yd(e){let t=Pi(e).unwrapOr({}),r=S0(),i=Ds(t.container).unwrapOr(r.container),n=Ms(t.video_codec).unwrapOr(r.video_codec),o=Vn(t.best_video_quality).unwrapOr(r.best_video_quality),a=Vn(t.lowest_video_quality).unwrapOr(r.lowest_video_quality),s=r.max_variants;if(typeof t.max_variants=="number"){let g=t.max_variants;Number.isInteger(g)&&g<=11&&g>0&&(s=g)}let u=r.prefer_60fps;typeof t.prefer_60fps=="boolean"&&(u=t.prefer_60fps);let l=r.ignore_low_quality_hits;typeof t.ignore_low_quality_hits=="boolean"&&(l=t.ignore_low_quality_hits);let p=[];if(Array.isArray(t.ignored_containers))for(let g of t.ignored_containers){let A=Ds(g);A.isSome()&&p.push(A.unwrap())}let c=[];if(Array.isArray(t.ignored_video_codecs))for(let g of t.ignored_video_codecs){let A=Ms(g);A.isSome()&&c.push(A.unwrap())}return{prefer_60fps:u,ignore_low_quality_hits:l,container:i,max_variants:s,video_codec:n,lowest_video_quality:a,best_video_quality:o,ignored_containers:p,ignored_video_codecs:c}}var kr,vd=I(()=>{"use strict";hd();mt();ft();Cr();Ve();kr="user_media_preferences"});var Ad=f((XR,bd)=>{var O0=typeof global=="object"&&global&&global.Object===Object&&global;bd.exports=O0});var wd=f((GR,_d)=>{var P0=Ad(),M0=typeof self=="object"&&self&&self.Object===Object&&self,R0=P0||M0||Function("return this")();_d.exports=R0});var Is=f(($R,xd)=>{var D0=wd(),I0=D0.Symbol;xd.exports=I0});var Od=f((QR,Sd)=>{var Ed=Is(),Td=Object.prototype,N0=Td.hasOwnProperty,C0=Td.toString,Mi=Ed?Ed.toStringTag:void 0;function q0(e){var t=N0.call(e,Mi),r=e[Mi];try{e[Mi]=void 0;var i=!0}catch{}var n=C0.call(e);return i&&(t?e[Mi]=r:delete e[Mi]),n}Sd.exports=q0});var Md=f((KR,Pd)=>{var k0=Object.prototype,B0=k0.toString;function F0(e){return B0.call(e)}Pd.exports=F0});var Nd=f((zR,Id)=>{var Rd=Is(),V0=Od(),H0=Md(),j0="[object Null]",L0="[object Undefined]",Dd=Rd?Rd.toStringTag:void 0;function U0(e){return e==null?e===void 0?L0:j0:Dd&&Dd in Object(e)?V0(e):H0(e)}Id.exports=U0});var qd=f((JR,Cd)=>{function W0(e,t){return function(r){return e(t(r))}}Cd.exports=W0});var Bd=f((YR,kd)=>{var X0=qd(),G0=X0(Object.getPrototypeOf,Object);kd.exports=G0});var Vd=f((ZR,Fd)=>{function $0(e){return e!=null&&typeof e=="object"}Fd.exports=$0});var Ns=f((eD,jd)=>{var Q0=Nd(),K0=Bd(),z0=Vd(),J0="[object Object]",Y0=Function.prototype,Z0=Object.prototype,Hd=Y0.toString,e1=Z0.hasOwnProperty,t1=Hd.call(Object);function r1(e){if(!z0(e)||Q0(e)!=J0)return!1;var t=K0(e);if(t===null)return!0;var r=e1.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Hd.call(r)==t1}jd.exports=r1});var Ld=f(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.default=i1;function i1(e){var t,r=e.Symbol;return typeof r=="function"?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}});var Ud=f((ks,qs)=>{"use strict";Object.defineProperty(ks,"__esModule",{value:!0});var n1=Ld(),o1=a1(n1);function a1(e){return e&&e.__esModule?e:{default:e}}var Br;typeof self<"u"?Br=self:typeof window<"u"?Br=window:typeof global<"u"?Br=global:typeof qs<"u"?Br=qs:Br=Function("return this")();var s1=(0,o1.default)(Br);ks.default=s1});var Bs=f(Ri=>{"use strict";Ri.__esModule=!0;Ri.ActionTypes=void 0;Ri.default=$d;var u1=Ns(),l1=Gd(u1),c1=Ud(),Wd=Gd(c1);function Gd(e){return e&&e.__esModule?e:{default:e}}var Xd=Ri.ActionTypes={INIT:"@@redux/INIT"};function $d(e,t,r){var i;if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error("Expected the enhancer to be a function.");return r($d)(e,t)}if(typeof e!="function")throw new Error("Expected the reducer to be a function.");var n=e,o=t,a=[],s=a,u=!1;function l(){s===a&&(s=a.slice())}function p(){return o}function c(_){if(typeof _!="function")throw new Error("Expected listener to be a function.");var m=!0;return l(),s.push(_),function(){if(m){m=!1,l();var v=s.indexOf(_);s.splice(v,1)}}}function g(_){if(!(0,l1.default)(_))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(typeof _.type>"u")throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(u)throw new Error("Reducers may not dispatch actions.");try{u=!0,o=n(o,_)}finally{u=!1}for(var m=a=s,y=0;y<m.length;y++){var v=m[y];v()}return _}function A(_){if(typeof _!="function")throw new Error("Expected the nextReducer to be a function.");n=_,g({type:Xd.INIT})}function d(){var _,m=c;return _={subscribe:function(v){if(typeof v!="object")throw new TypeError("Expected the observer to be an object.");function T(){v.next&&v.next(p())}T();var h=m(T);return{unsubscribe:h}}},_[Wd.default]=function(){return this},_}return g({type:Xd.INIT}),i={dispatch:g,subscribe:c,getState:p,replaceReducer:A},i[Wd.default]=d,i}});var Vs=f(Fs=>{"use strict";Fs.__esModule=!0;Fs.default=p1;function p1(e){typeof console<"u"&&typeof console.error=="function"&&console.error(e);try{throw new Error(e)}catch{}}});var zd=f(Hs=>{"use strict";Hs.__esModule=!0;Hs.default=h1;var Qd=Bs(),d1=Ns(),nD=Kd(d1),f1=Vs(),oD=Kd(f1);function Kd(e){return e&&e.__esModule?e:{default:e}}function m1(e,t){var r=t&&t.type,i=r&&'"'+r.toString()+'"'||"an action";return"Given action "+i+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function g1(e){Object.keys(e).forEach(function(t){var r=e[t],i=r(void 0,{type:Qd.ActionTypes.INIT});if(typeof i>"u")throw new Error('Reducer "'+t+`" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.`);var n="@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".");if(typeof r(void 0,{type:n})>"u")throw new Error('Reducer "'+t+'" returned undefined when probed with a random type. '+("Don't try to handle "+Qd.ActionTypes.INIT+' or other actions in "redux/*" ')+"namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.")})}function h1(e){for(var t=Object.keys(e),r={},i=0;i<t.length;i++){var n=t[i];typeof e[n]=="function"&&(r[n]=e[n])}var o=Object.keys(r),a=void 0,s=void 0;try{g1(r)}catch(u){s=u}return function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},p=arguments[1];if(s)throw s;if(0)var c;for(var g=!1,A={},d=0;d<o.length;d++){var _=o[d],m=r[_],y=l[_],v=m(y,p);if(typeof v>"u"){var T=m1(_,p);throw new Error(T)}A[_]=v,g=g||v!==y}return g?A:l}}});var Yd=f(js=>{"use strict";js.__esModule=!0;js.default=y1;function Jd(e,t){return function(){return t(e.apply(void 0,arguments))}}function y1(e,t){if(typeof e=="function")return Jd(e,t);if(typeof e!="object"||e===null)throw new Error("bindActionCreators expected an object or a function, instead received "+(e===null?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var r=Object.keys(e),i={},n=0;n<r.length;n++){var o=r[n],a=e[o];typeof a=="function"&&(i[o]=Jd(a,t))}return i}});var Us=f(Ls=>{"use strict";Ls.__esModule=!0;Ls.default=v1;function v1(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.length===0?function(i){return i}:t.length===1?t[0]:t.reduce(function(i,n){return function(){return i(n.apply(void 0,arguments))}})}});var Zd=f(Ws=>{"use strict";Ws.__esModule=!0;var b1=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};Ws.default=x1;var A1=Us(),_1=w1(A1);function w1(e){return e&&e.__esModule?e:{default:e}}function x1(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(i){return function(n,o,a){var s=i(n,o,a),u=s.dispatch,l=[],p={getState:s.getState,dispatch:function(g){return u(g)}};return l=t.map(function(c){return c(p)}),u=_1.default.apply(void 0,l)(s.dispatch),b1({},s,{dispatch:u})}}}});var ef=f(De=>{"use strict";De.__esModule=!0;De.compose=De.applyMiddleware=De.bindActionCreators=De.combineReducers=De.createStore=void 0;var E1=Bs(),T1=Fr(E1),S1=zd(),O1=Fr(S1),P1=Yd(),M1=Fr(P1),R1=Zd(),D1=Fr(R1),I1=Us(),N1=Fr(I1),C1=Vs(),cD=Fr(C1);function Fr(e){return e&&e.__esModule?e:{default:e}}De.createStore=T1.default;De.combineReducers=O1.default;De.bindActionCreators=M1.default;De.applyMiddleware=D1.default;De.compose=N1.default});var rf=f((Ln,tf)=>{(function(e,t){typeof Ln=="object"&&typeof tf<"u"?t(Ln):typeof define=="function"&&define.amd?define(["exports"],t):t(e.reduxLogger=e.reduxLogger||{})})(Ln,function(e){"use strict";function t(b,E){b.super_=E,b.prototype=Object.create(E.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}})}function r(b,E){Object.defineProperty(this,"kind",{value:b,enumerable:!0}),E&&E.length&&Object.defineProperty(this,"path",{value:E,enumerable:!0})}function i(b,E,w){i.super_.call(this,"E",b),Object.defineProperty(this,"lhs",{value:E,enumerable:!0}),Object.defineProperty(this,"rhs",{value:w,enumerable:!0})}function n(b,E){n.super_.call(this,"N",b),Object.defineProperty(this,"rhs",{value:E,enumerable:!0})}function o(b,E){o.super_.call(this,"D",b),Object.defineProperty(this,"lhs",{value:E,enumerable:!0})}function a(b,E,w){a.super_.call(this,"A",b),Object.defineProperty(this,"index",{value:E,enumerable:!0}),Object.defineProperty(this,"item",{value:w,enumerable:!0})}function s(b,E,w){var R=b.slice((w||E)+1||b.length);return b.length=E<0?b.length+E:E,b.push.apply(b,R),b}function u(b){var E=typeof b>"u"?"undefined":j(b);return E!=="object"?E:b===Math?"math":b===null?"null":Array.isArray(b)?"array":Object.prototype.toString.call(b)==="[object Date]"?"date":typeof b.toString=="function"&&/^\/.*\//.test(b.toString())?"regexp":"object"}function l(b,E,w,R,k,F,V){k=k||[],V=V||[];var U=k.slice(0);if(typeof F<"u"){if(R){if(typeof R=="function"&&R(U,F))return;if((typeof R>"u"?"undefined":j(R))==="object"){if(R.prefilter&&R.prefilter(U,F))return;if(R.normalize){var Pe=R.normalize(U,F,b,E);Pe&&(b=Pe[0],E=Pe[1])}}}U.push(F)}u(b)==="regexp"&&u(E)==="regexp"&&(b=b.toString(),E=E.toString());var ke=typeof b>"u"?"undefined":j(b),be=typeof E>"u"?"undefined":j(E),ue=ke!=="undefined"||V&&V[V.length-1].lhs&&V[V.length-1].lhs.hasOwnProperty(F),Be=be!=="undefined"||V&&V[V.length-1].rhs&&V[V.length-1].rhs.hasOwnProperty(F);if(!ue&&Be)w(new n(U,E));else if(!Be&&ue)w(new o(U,b));else if(u(b)!==u(E))w(new i(U,b,E));else if(u(b)==="date"&&b-E!==0)w(new i(U,b,E));else if(ke==="object"&&b!==null&&E!==null)if(V.filter(function(ee){return ee.lhs===b}).length)b!==E&&w(new i(U,b,E));else{if(V.push({lhs:b,rhs:E}),Array.isArray(b)){var G;for(b.length,G=0;G<b.length;G++)G>=E.length?w(new a(U,G,new o(void 0,b[G]))):l(b[G],E[G],w,R,U,G,V);for(;G<E.length;)w(new a(U,G,new n(void 0,E[G++])))}else{var Kt=Object.keys(b),ut=Object.keys(E);Kt.forEach(function(ee,Tr){var hi=ut.indexOf(ee);hi>=0?(l(b[ee],E[ee],w,R,U,ee,V),ut=s(ut,hi)):l(b[ee],void 0,w,R,U,ee,V)}),ut.forEach(function(ee){l(void 0,E[ee],w,R,U,ee,V)})}V.length=V.length-1}else b!==E&&(ke==="number"&&isNaN(b)&&isNaN(E)||w(new i(U,b,E)))}function p(b,E,w,R){return R=R||[],l(b,E,function(k){k&&R.push(k)},w),R.length?R:void 0}function c(b,E,w){if(w.path&&w.path.length){var R,k=b[E],F=w.path.length-1;for(R=0;R<F;R++)k=k[w.path[R]];switch(w.kind){case"A":c(k[w.path[R]],w.index,w.item);break;case"D":delete k[w.path[R]];break;case"E":case"N":k[w.path[R]]=w.rhs}}else switch(w.kind){case"A":c(b[E],w.index,w.item);break;case"D":b=s(b,E);break;case"E":case"N":b[E]=w.rhs}return b}function g(b,E,w){if(b&&E&&w&&w.kind){for(var R=b,k=-1,F=w.path?w.path.length-1:0;++k<F;)typeof R[w.path[k]]>"u"&&(R[w.path[k]]=typeof w.path[k]=="number"?[]:{}),R=R[w.path[k]];switch(w.kind){case"A":c(w.path?R[w.path[k]]:R,w.index,w.item);break;case"D":delete R[w.path[k]];break;case"E":case"N":R[w.path[k]]=w.rhs}}}function A(b,E,w){if(w.path&&w.path.length){var R,k=b[E],F=w.path.length-1;for(R=0;R<F;R++)k=k[w.path[R]];switch(w.kind){case"A":A(k[w.path[R]],w.index,w.item);break;case"D":k[w.path[R]]=w.lhs;break;case"E":k[w.path[R]]=w.lhs;break;case"N":delete k[w.path[R]]}}else switch(w.kind){case"A":A(b[E],w.index,w.item);break;case"D":b[E]=w.lhs;break;case"E":b[E]=w.lhs;break;case"N":b=s(b,E)}return b}function d(b,E,w){if(b&&E&&w&&w.kind){var R,k,F=b;for(k=w.path.length-1,R=0;R<k;R++)typeof F[w.path[R]]>"u"&&(F[w.path[R]]={}),F=F[w.path[R]];switch(w.kind){case"A":A(F[w.path[R]],w.index,w.item);break;case"D":F[w.path[R]]=w.lhs;break;case"E":F[w.path[R]]=w.lhs;break;case"N":delete F[w.path[R]]}}}function _(b,E,w){if(b&&E){var R=function(k){w&&!w(b,E,k)||g(b,E,k)};l(b,E,R)}}function m(b){return"color: "+ae[b].color+"; font-weight: bold"}function y(b){var E=b.kind,w=b.path,R=b.lhs,k=b.rhs,F=b.index,V=b.item;switch(E){case"E":return[w.join("."),R,"\u2192",k];case"N":return[w.join("."),k];case"D":return[w.join(".")];case"A":return[w.join(".")+"["+F+"]",V];default:return[]}}function v(b,E,w,R){var k=p(b,E);try{R?w.groupCollapsed("diff"):w.group("diff")}catch{w.log("diff")}k?k.forEach(function(F){var V=F.kind,U=y(F);w.log.apply(w,["%c "+ae[V].text,m(V)].concat(oe(U)))}):w.log("\u2014\u2014 no diff \u2014\u2014");try{w.groupEnd()}catch{w.log("\u2014\u2014 diff end \u2014\u2014 ")}}function T(b,E,w,R){switch(typeof b>"u"?"undefined":j(b)){case"object":return typeof b[R]=="function"?b[R].apply(b,oe(w)):b[R];case"function":return b(E);default:return b}}function h(b){var E=b.timestamp,w=b.duration;return function(R,k,F){var V=["action"];return V.push("%c"+String(R.type)),E&&V.push("%c@ "+k),w&&V.push("%c(in "+F.toFixed(2)+" ms)"),V.join(" ")}}function x(b,E){var w=E.logger,R=E.actionTransformer,k=E.titleFormatter,F=k===void 0?h(E):k,V=E.collapsed,U=E.colors,Pe=E.level,ke=E.diff,be=typeof E.titleFormatter>"u";b.forEach(function(ue,Be){var G=ue.started,Kt=ue.startedTime,ut=ue.action,ee=ue.prevState,Tr=ue.error,hi=ue.took,zt=ue.nextState,Ka=b[Be+1];Ka&&(zt=Ka.prevState,hi=Ka.started-G);var Ke=R(ut),lp=typeof V=="function"?V(function(){return zt},ut,ue):V,E_=q(Kt),T_=U.title?"color: "+U.title(Ke)+";":"",yi=["color: gray; font-weight: lighter;"];yi.push(T_),E.timestamp&&yi.push("color: gray; font-weight: lighter;"),E.duration&&yi.push("color: gray; font-weight: lighter;");var vi=F(Ke,E_,hi);try{lp?U.title&&be?w.groupCollapsed.apply(w,["%c "+vi].concat(yi)):w.groupCollapsed(vi):U.title&&be?w.group.apply(w,["%c "+vi].concat(yi)):w.group(vi)}catch{w.log(vi)}var za=T(Pe,Ke,[ee],"prevState"),Ja=T(Pe,Ke,[Ke],"action"),Ya=T(Pe,Ke,[Tr,ee],"error"),Za=T(Pe,Ke,[zt],"nextState");if(za)if(U.prevState){var S_="color: "+U.prevState(ee)+"; font-weight: bold";w[za]("%c prev state",S_,ee)}else w[za]("prev state",ee);if(Ja)if(U.action){var O_="color: "+U.action(Ke)+"; font-weight: bold";w[Ja]("%c action    ",O_,Ke)}else w[Ja]("action    ",Ke);if(Tr&&Ya)if(U.error){var P_="color: "+U.error(Tr,ee)+"; font-weight: bold;";w[Ya]("%c error     ",P_,Tr)}else w[Ya]("error     ",Tr);if(Za)if(U.nextState){var M_="color: "+U.nextState(zt)+"; font-weight: bold";w[Za]("%c next state",M_,zt)}else w[Za]("next state",zt);ke&&v(ee,zt,w,lp);try{w.groupEnd()}catch{w.log("\u2014\u2014 log end \u2014\u2014")}})}function S(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},E=Object.assign({},Er,b),w=E.logger,R=E.stateTransformer,k=E.errorTransformer,F=E.predicate,V=E.logErrors,U=E.diffPredicate;if(typeof w>"u")return function(){return function(ke){return function(be){return ke(be)}}};if(b.getState&&b.dispatch)return console.error(`[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:
// Logger with default options
import { logger } from 'redux-logger'
const store = createStore(
  reducer,
  applyMiddleware(logger)
)
// Or you can create your own logger with custom options http://bit.ly/redux-logger-options
import createLogger from 'redux-logger'
const logger = createLogger({
  // ...options
});
const store = createStore(
  reducer,
  applyMiddleware(logger)
)
`),function(){return function(ke){return function(be){return ke(be)}}};var Pe=[];return function(ke){var be=ke.getState;return function(ue){return function(Be){if(typeof F=="function"&&!F(be,Be))return ue(Be);var G={};Pe.push(G),G.started=Q.now(),G.startedTime=new Date,G.prevState=R(be()),G.action=Be;var Kt=void 0;if(V)try{Kt=ue(Be)}catch(ee){G.error=k(ee)}else Kt=ue(Be);G.took=Q.now()-G.started,G.nextState=R(be());var ut=E.diff&&typeof U=="function"?U(be,Be):E.diff;if(x(Pe,Object.assign({},E,{diff:ut})),Pe.length=0,G.error)throw G.error;return Kt}}}}var O,D,L=function(b,E){return new Array(E+1).join(b)},B=function(b,E){return L("0",E-b.toString().length)+b},q=function(b){return B(b.getHours(),2)+":"+B(b.getMinutes(),2)+":"+B(b.getSeconds(),2)+"."+B(b.getMilliseconds(),3)},Q=typeof performance<"u"&&performance!==null&&typeof performance.now=="function"?performance:Date,j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},oe=function(b){if(Array.isArray(b)){for(var E=0,w=Array(b.length);E<b.length;E++)w[E]=b[E];return w}return Array.from(b)},Oe=[];O=(typeof global>"u"?"undefined":j(global))==="object"&&global?global:typeof window<"u"?window:{},D=O.DeepDiff,D&&Oe.push(function(){typeof D<"u"&&O.DeepDiff===p&&(O.DeepDiff=D,D=void 0)}),t(i,r),t(n,r),t(o,r),t(a,r),Object.defineProperties(p,{diff:{value:p,enumerable:!0},observableDiff:{value:l,enumerable:!0},applyDiff:{value:_,enumerable:!0},applyChange:{value:g,enumerable:!0},revertChange:{value:d,enumerable:!0},isConflict:{value:function(){return typeof D<"u"},enumerable:!0},noConflict:{value:function(){return Oe&&(Oe.forEach(function(b){b()}),Oe=null),p},enumerable:!0}});var ae={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}},Er={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(b){return b},actionTransformer:function(b){return b},errorTransformer:function(b){return b},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},up=function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},E=b.dispatch,w=b.getState;return typeof E=="function"||typeof w=="function"?S()({dispatch:E,getState:w}):void console.error(`
[redux-logger v3] BREAKING CHANGE
[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.
[redux-logger v3] Change
[redux-logger v3] import createLogger from 'redux-logger'
[redux-logger v3] to
[redux-logger v3] import { createLogger } from 'redux-logger'
`)};e.defaults=Er,e.createLogger=S,e.logger=up,e.default=up,Object.defineProperty(e,"__esModule",{value:!0})})});var of=f((nf,Un)=>{(function(e,t){"use strict";typeof Un=="object"&&typeof Un.exports=="object"?Un.exports=t():typeof define=="function"&&define.amd?define([],t):e.objectPath=t()})(nf,function(){"use strict";var e=Object.prototype.toString;function t(p,c){return p==null?!1:Object.prototype.hasOwnProperty.call(p,c)}function r(p){if(!p||o(p)&&p.length===0)return!0;if(typeof p!="string"){for(var c in p)if(t(p,c))return!1;return!0}return!1}function i(p){return e.call(p)}function n(p){return typeof p=="object"&&i(p)==="[object Object]"}var o=Array.isArray||function(p){return e.call(p)==="[object Array]"};function a(p){return typeof p=="boolean"||i(p)==="[object Boolean]"}function s(p){var c=parseInt(p);return c.toString()===p?c:p}function u(p){p=p||{};var c=function(m){return Object.keys(c).reduce(function(y,v){return v==="create"||typeof c[v]=="function"&&(y[v]=c[v].bind(c,m)),y},{})},g;p.includeInheritedProps?g=function(){return!0}:g=function(m,y){return typeof y=="number"&&Array.isArray(m)||t(m,y)};function A(m,y){if(g(m,y))return m[y]}var d;p.includeInheritedProps?d=function(m,y){typeof y!="string"&&typeof y!="number"&&(y=String(y));var v=A(m,y);if(y==="__proto__"||y==="prototype"||y==="constructor"&&typeof v=="function")throw new Error("For security reasons, object's magic properties cannot be set");return v}:d=function(m,y){return A(m,y)};function _(m,y,v,T){if(typeof y=="number"&&(y=[y]),!y||y.length===0)return m;if(typeof y=="string")return _(m,y.split(".").map(s),v,T);var h=y[0],x=d(m,h);return y.length===1?((x===void 0||!T)&&(m[h]=v),x):(x===void 0&&(typeof y[1]=="number"?m[h]=[]:m[h]={}),_(m[h],y.slice(1),v,T))}return c.has=function(m,y){if(typeof y=="number"?y=[y]:typeof y=="string"&&(y=y.split(".")),!y||y.length===0)return!!m;for(var v=0;v<y.length;v++){var T=s(y[v]);if(typeof T=="number"&&o(m)&&T<m.length||(p.includeInheritedProps?T in Object(m):t(m,T)))m=m[T];else return!1}return!0},c.ensureExists=function(m,y,v){return _(m,y,v,!0)},c.set=function(m,y,v,T){return _(m,y,v,T)},c.insert=function(m,y,v,T){var h=c.get(m,y);T=~~T,o(h)||(h=[],c.set(m,y,h)),h.splice(T,0,v)},c.empty=function(m,y){if(!r(y)&&m!=null){var v,T;if(v=c.get(m,y)){if(typeof v=="string")return c.set(m,y,"");if(a(v))return c.set(m,y,!1);if(typeof v=="number")return c.set(m,y,0);if(o(v))v.length=0;else if(n(v))for(T in v)g(v,T)&&delete v[T];else return c.set(m,y,null)}}},c.push=function(m,y){var v=c.get(m,y);o(v)||(v=[],c.set(m,y,v)),v.push.apply(v,Array.prototype.slice.call(arguments,2))},c.coalesce=function(m,y,v){for(var T,h=0,x=y.length;h<x;h++)if((T=c.get(m,y[h]))!==void 0)return T;return v},c.get=function(m,y,v){if(typeof y=="number"&&(y=[y]),!y||y.length===0)return m;if(m==null)return v;if(typeof y=="string")return c.get(m,y.split("."),v);var T=s(y[0]),h=d(m,T);return h===void 0?v:y.length===1?h:c.get(m[T],y.slice(1),v)},c.del=function(y,v){if(typeof v=="number"&&(v=[v]),y==null||r(v))return y;if(typeof v=="string")return c.del(y,v.split("."));var T=s(v[0]);if(d(y,T),!g(y,T))return y;if(v.length===1)o(y)?y.splice(T,1):delete y[T];else return c.del(y[T],v.slice(1));return y},c}var l=u();return l.create=u,l.withInheritedProps=u({includeInheritedProps:!0}),l})});var uf=f((dD,sf)=>{"use strict";var af=of().get;function q1(e,t){return e===t}function k1(e,t,r){r=r||q1;var i=af(e(),t);return function(o){return function(){var a=af(e(),t);if(!r(i,a)){var s=i;i=a,o(a,s,t)}}}}sf.exports=k1});var Wn={};Z(Wn,{clear:()=>cf,error:()=>H1,getEntry:()=>df,log:()=>lf,logDetails:()=>pf,reducer:()=>V1});function V1(e=[],t){switch(t.type){case"log.new":e=e.concat([Object.assign({key:++F1},t.payload)]);break;case"log.clear":e=[];break}return e}function lf(e,t="log"){if(e instanceof Error){let r="";e.fileName&&e.lineNumber&&(r=e.fileName+":"+e.lineNumber,r.columnNumber&&(r+=":"+e.columnNumber),r+=`
`),e.stack&&(r+=e.stack),e={message:e.message,details:e.details||r||void 0,videoTitle:e.videoTitle||void 0}}else typeof e=="string"?e={message:e}:e={message:e.message||""+e,details:e.details||void 0};Gs.dispatch("log.new",Object.assign(e,{type:t}))}function H1(e){lf(e,"error")}function cf(){Gs.dispatch("log.clear")}function pf(e){Xs.rpc.call("main","embed",B1.runtime.getURL("content/logdetails-embed.html?panel=logdetails#"+encodeURIComponent(e)))}function df(e){let t=null;if(Gs.getLogs().forEach(i=>{i.key==e&&(t=i)}),t)return t;throw new Error("Log entry not found")}var Xs,B1,Gs,F1,Xn=I(()=>{"use strict";Xs=z(),B1=Xs.browser,Gs=(Ne(),P(Ie)),F1=0;Xs.rpc.listen({clearLogs:cf,logDetails:pf,getLogEntry:df})});var mf=f(ff=>{"use strict";Object.defineProperty(ff,"__esModule",{value:!0})});var Di=f(Gn=>{"use strict";Object.defineProperty(Gn,"__esModule",{value:!0});Gn.THROW_THE_ERROR=void 0;Gn.THROW_THE_ERROR=e=>{throw e}});var Ii=f(er=>{"use strict";var j1=er&&er.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),L1=er&&er.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&j1(t,e,r)};Object.defineProperty(er,"__esModule",{value:!0});L1(Di(),er)});var gf=f($n=>{"use strict";Object.defineProperty($n,"__esModule",{value:!0});$n.httpStatusCodeFrom=void 0;var U1=Qn(),W1=Ii();function X1(e,t=W1.THROW_THE_ERROR){return U1.mustBeHttpStatusCode(e,t),e}$n.httpStatusCodeFrom=X1});var hf=f(Kn=>{"use strict";Object.defineProperty(Kn,"__esModule",{value:!0});Kn.isHttpStatusCode=void 0;function G1(e){return e>=100&&e<=599}Kn.isHttpStatusCode=G1});var tr=f(zn=>{"use strict";Object.defineProperty(zn,"__esModule",{value:!0});zn.AppError=void 0;var $s=class extends Error{constructor(t){super(t.detail),this.details=t,this.name=this.details.packageName+"/"+this.details.errorName}};zn.AppError=$s});var Ks=f(Jn=>{"use strict";Object.defineProperty(Jn,"__esModule",{value:!0});Jn.ValueObject=void 0;var Qs=class{constructor(t){this.value=t}valueOf(){return this.value}isValue(){return!0}};Jn.ValueObject=Qs});var rr=f(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.StructuredProblemReport=void 0;var $1=Ks(),zs=class e extends $1.ValueObject{static from(t){return new e(t)}get detail(){return this.value.template.detail}get errorId(){var t;return(t=this.value.errorId)!==null&&t!==void 0?t:null}get errorName(){return this.value.template.errorName}get extra(){return this.value.extra}get fqErrorName(){return this.packageName+"/"+this.errorName}get packageName(){return this.value.template.packageName}get status(){return this.value.template.status}get template(){return this.value.template}};Yn.StructuredProblemReport=zs});var ir=f(we=>{"use strict";Object.defineProperty(we,"__esModule",{value:!0});we.ERROR_TABLE=we.PackageErrorTable=we.PACKAGE_NAME=void 0;we.PACKAGE_NAME="@ganbarodigital/ts-lib-error-reporting/lib/v1";var Zn=class{constructor(){this["http-status-code-out-of-range"]={packageName:we.PACKAGE_NAME,errorName:"http-status-code-out-of-range",detail:"input falls outside the range of a valid HTTP status code",status:422},this["invalid-package-name"]={packageName:we.PACKAGE_NAME,errorName:"invalid-package-name",detail:"package name does not meet spec 'isPackageName()'",status:422},this["not-an-integer"]={packageName:we.PACKAGE_NAME,errorName:"not-an-integer",detail:"input must be an integer; was a float",status:422},this["not-implemented"]={packageName:we.PACKAGE_NAME,errorName:"not-implemented",detail:"this function or feature has not been implemented",status:500},this["unreachable-code"]={packageName:we.PACKAGE_NAME,errorName:"unreachable-code",status:500,detail:"this code should never execute"}}};we.PackageErrorTable=Zn;we.ERROR_TABLE=new Zn});var Ys=f(eo=>{"use strict";Object.defineProperty(eo,"__esModule",{value:!0});eo.HttpStatusCodeOutOfRangeError=void 0;var Q1=tr(),K1=rr(),z1=ir(),Js=class extends Q1.AppError{constructor(t){let r={template:z1.ERROR_TABLE["http-status-code-out-of-range"],errorId:t.errorId,extra:{public:t.public}};super(K1.StructuredProblemReport.from(r))}};eo.HttpStatusCodeOutOfRangeError=Js});var eu=f(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0});to.NotAnIntegerError=void 0;var J1=tr(),Y1=rr(),Z1=ir(),Zs=class extends J1.AppError{constructor(t){let r={template:Z1.ERROR_TABLE["not-an-integer"],errorId:t.errorId,extra:{public:t.public}};super(Y1.StructuredProblemReport.from(r))}};to.NotAnIntegerError=Zs});var yf=f(ro=>{"use strict";Object.defineProperty(ro,"__esModule",{value:!0});ro.mustBeHttpStatusCode=void 0;var ew=Qn(),tw=Ys(),rw=eu(),iw=Ii();function nw(e,t=iw.THROW_THE_ERROR){e>>>0!==e&&t(new rw.NotAnIntegerError({public:{input:e}})),ew.isHttpStatusCode(e)||t(new tw.HttpStatusCodeOutOfRangeError({public:{input:e}}))}ro.mustBeHttpStatusCode=nw});var Qn=f(Je=>{"use strict";var ow=Je&&Je.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),io=Je&&Je.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&ow(t,e,r)};Object.defineProperty(Je,"__esModule",{value:!0});io(mf(),Je);io(gf(),Je);io(hf(),Je);io(yf(),Je)});var vf=f(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:!0});var tu=Qn();Object.defineProperty(Ni,"isHttpStatusCode",{enumerable:!0,get:function(){return tu.isHttpStatusCode}});Object.defineProperty(Ni,"mustBeHttpStatusCode",{enumerable:!0,get:function(){return tu.mustBeHttpStatusCode}});Object.defineProperty(Ni,"httpStatusCodeFrom",{enumerable:!0,get:function(){return tu.httpStatusCodeFrom}})});var bf=f(nr=>{"use strict";var aw=nr&&nr.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),sw=nr&&nr.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&aw(t,e,r)};Object.defineProperty(nr,"__esModule",{value:!0});sw(vf(),nr)});var _f=f(Af=>{"use strict";Object.defineProperty(Af,"__esModule",{value:!0})});var xf=f(wf=>{"use strict";Object.defineProperty(wf,"__esModule",{value:!0})});var Ef=f(ht=>{"use strict";var uw=ht&&ht.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),ru=ht&&ht.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&uw(t,e,r)};Object.defineProperty(ht,"__esModule",{value:!0});ru(tr(),ht);ru(_f(),ht);ru(xf(),ht)});var Sf=f(Tf=>{"use strict";Object.defineProperty(Tf,"__esModule",{value:!0})});var Of=f(or=>{"use strict";var lw=or&&or.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),cw=or&&or.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&lw(t,e,r)};Object.defineProperty(or,"__esModule",{value:!0});cw(Sf(),or)});var Mf=f(Pf=>{"use strict";Object.defineProperty(Pf,"__esModule",{value:!0})});var Rf=f(ar=>{"use strict";var pw=ar&&ar.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),dw=ar&&ar.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&pw(t,e,r)};Object.defineProperty(ar,"__esModule",{value:!0});dw(Mf(),ar)});var Df=f(no=>{"use strict";Object.defineProperty(no,"__esModule",{value:!0});no.InvalidPackageNameError=void 0;var fw=tr(),mw=rr(),gw=ir(),iu=class extends fw.AppError{constructor(t){let r={template:gw.ERROR_TABLE["invalid-package-name"],errorId:t.errorId,extra:{public:t.public}};super(mw.StructuredProblemReport.from(r))}};no.InvalidPackageNameError=iu});var If=f(oo=>{"use strict";Object.defineProperty(oo,"__esModule",{value:!0});oo.NotImplementedError=void 0;var hw=tr(),yw=rr(),vw=ir(),nu=class extends hw.AppError{constructor(t={}){let r={template:vw.ERROR_TABLE["not-implemented"],errorId:t.errorId};super(yw.StructuredProblemReport.from(r))}};oo.NotImplementedError=nu});var Nf=f(ao=>{"use strict";Object.defineProperty(ao,"__esModule",{value:!0});ao.UnreachableCodeError=void 0;var bw=tr(),Aw=rr(),_w=ir(),ou=class extends bw.AppError{constructor(t){let r={template:_w.ERROR_TABLE["unreachable-code"],errorId:t.errorId,extra:{logsOnly:t.logsOnly}};super(Aw.StructuredProblemReport.from(r))}};ao.UnreachableCodeError=ou});var au=f(sr=>{"use strict";Object.defineProperty(sr,"__esModule",{value:!0});var ww=Ys();Object.defineProperty(sr,"HttpStatusCodeOutOfRangeError",{enumerable:!0,get:function(){return ww.HttpStatusCodeOutOfRangeError}});var xw=Df();Object.defineProperty(sr,"InvalidPackageNameError",{enumerable:!0,get:function(){return xw.InvalidPackageNameError}});var Ew=eu();Object.defineProperty(sr,"NotAnIntegerError",{enumerable:!0,get:function(){return Ew.NotAnIntegerError}});var Tw=If();Object.defineProperty(sr,"NotImplementedError",{enumerable:!0,get:function(){return Tw.NotImplementedError}});var Sw=Nf();Object.defineProperty(sr,"UnreachableCodeError",{enumerable:!0,get:function(){return Sw.UnreachableCodeError}})});var qf=f(Cf=>{"use strict";Object.defineProperty(Cf,"__esModule",{value:!0})});var Bf=f(kf=>{"use strict";Object.defineProperty(kf,"__esModule",{value:!0})});var Vf=f(Ff=>{"use strict";Object.defineProperty(Ff,"__esModule",{value:!0})});var jf=f(Hf=>{"use strict";Object.defineProperty(Hf,"__esModule",{value:!0})});var Uf=f(Lf=>{"use strict";Object.defineProperty(Lf,"__esModule",{value:!0})});var Wf=f(je=>{"use strict";var Ow=je&&je.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),Ci=je&&je.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&Ow(t,e,r)};Object.defineProperty(je,"__esModule",{value:!0});Ci(qf(),je);Ci(Bf(),je);Ci(Vf(),je);Ci(jf(),je);Ci(Uf(),je)});var Xf=f(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.extractReasonFromCaught=ur.DEFAULT_ERROR_REASON=void 0;ur.DEFAULT_ERROR_REASON="no error information available";function Pw(e,{stackTrace:t=!1}={}){let r=ur.DEFAULT_ERROR_REASON;return e instanceof Error?(t&&e.stack?r=e.stack:r=e.toString(),r):(e===null||e===void 0||typeof e=="number"&&isNaN(e)||typeof e=="boolean"||e.toString!==void 0&&typeof e.toString=="function"&&e.toString!==Object.prototype.toString&&(r=e.toString()),r)}ur.extractReasonFromCaught=Pw});var Gf=f(so=>{"use strict";Object.defineProperty(so,"__esModule",{value:!0});so.extractStackFromCaught=void 0;function Mw(e){return e instanceof Error?e.stack.substring(e.stack.indexOf(`
`)+1):""}so.extractStackFromCaught=Mw});var Qf=f(It=>{"use strict";var Rw=It&&It.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),$f=It&&It.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&Rw(t,e,r)};Object.defineProperty(It,"__esModule",{value:!0});$f(Xf(),It);$f(Gf(),It)});var zf=f(Kf=>{"use strict";Object.defineProperty(Kf,"__esModule",{value:!0})});var Yf=f(Jf=>{"use strict";Object.defineProperty(Jf,"__esModule",{value:!0})});var Zf=f(yt=>{"use strict";var Dw=yt&&yt.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),su=yt&&yt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&Dw(t,e,r)};Object.defineProperty(yt,"__esModule",{value:!0});su(rr(),yt);su(zf(),yt);su(Yf(),yt)});var ge=f(me=>{"use strict";var Iw=me&&me.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),Nt=me&&me.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&Iw(t,e,r)};Object.defineProperty(me,"__esModule",{value:!0});Nt(Ef(),me);Nt(Of(),me);Nt(Rf(),me);Nt(au(),me);Nt(Wf(),me);Nt(Qf(),me);Nt(Ii(),me);Nt(Zf(),me)});var em=f(uo=>{"use strict";Object.defineProperty(uo,"__esModule",{value:!0});var Nw=ir();Object.defineProperty(uo,"PackageErrorTable",{enumerable:!0,get:function(){return Nw.PackageErrorTable}});var Cw=ge();Object.defineProperty(uo,"InvalidPackageNameError",{enumerable:!0,get:function(){return Cw.InvalidPackageNameError}})});var rm=f(tm=>{"use strict";Object.defineProperty(tm,"__esModule",{value:!0})});var uu=f(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.isPackageNameData=lr.PackageNameDataRegex=void 0;lr.PackageNameDataRegex=new RegExp("^(?:@[a-z0-9-*~][a-z0-9-*._~]*/)?[a-z0-9-~][a-z0-9-._~]+(/[A-Za-z0-9-~][A-Za-z0-9-._~]+)*$");function qw(e){return lr.PackageNameDataRegex.test(e)}lr.isPackageNameData=qw});var lu=f(lo=>{"use strict";Object.defineProperty(lo,"__esModule",{value:!0});lo.mustBePackageNameData=void 0;var kw=au(),Bw=Di(),Fw=uu();function Vw(e,t=Bw.THROW_THE_ERROR){Fw.isPackageNameData(e)||t(new kw.InvalidPackageNameError({public:{packageName:e}}))}lo.mustBePackageNameData=Vw});var im=f(co=>{"use strict";Object.defineProperty(co,"__esModule",{value:!0});co.packageNameFrom=void 0;var Hw=Ii(),jw=lu();function Lw(e,t=Hw.THROW_THE_ERROR){return jw.mustBePackageNameData(e,t),e}co.packageNameFrom=Lw});var nm=f(Ye=>{"use strict";var Uw=Ye&&Ye.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),po=Ye&&Ye.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&Uw(t,e,r)};Object.defineProperty(Ye,"__esModule",{value:!0});po(rm(),Ye);po(uu(),Ye);po(lu(),Ye);po(im(),Ye)});var om=f(cr=>{"use strict";var Ww=cr&&cr.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),Xw=cr&&cr.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&Ww(t,e,r)};Object.defineProperty(cr,"__esModule",{value:!0});Xw(nm(),cr)});var sm=f(Ct=>{"use strict";var Gw=Ct&&Ct.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),am=Ct&&Ct.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&Gw(t,e,r)};Object.defineProperty(Ct,"__esModule",{value:!0});am(em(),Ct);am(om(),Ct)});var cu=f(Vr=>{"use strict";Object.defineProperty(Vr,"__esModule",{value:!0});Vr.ERROR_TABLE=Vr.PackageErrorTable=void 0;var fo=bf(),$w=sm(),mo=$w.packageNameFrom("@ganbarodigital/ts-lib-mediatypes"),go=class{constructor(){this["mediatypematchregex-is-broken"]={packageName:mo,errorName:"mediatypematchregex-is-broken",detail:"the MediaTypeMatchRegex no longer returns the expected named groups",status:fo.httpStatusCodeFrom(500)},this["not-a-content-type"]={packageName:mo,errorName:"not-a-content-type",detail:"the given string does not have the structure of a ContentType",status:fo.httpStatusCodeFrom(422)},this["not-a-media-type"]={packageName:mo,errorName:"not-a-media-type",detail:"the given string does not have the structure of a MediaType",status:fo.httpStatusCodeFrom(422)},this["unexpected-content-type"]={packageName:mo,errorName:"unexpected-content-type",detail:"the given MediaType does not match any of the expected content types",status:fo.httpStatusCodeFrom(422)}}};Vr.PackageErrorTable=go;Vr.ERROR_TABLE=new go});var lm=f(ho=>{"use strict";Object.defineProperty(ho,"__esModule",{value:!0});ho.NotAContentTypeError=void 0;var um=ge(),Qw=Ze(),pu=class extends um.AppError{constructor(t){let r={template:Qw.ERROR_TABLE["not-a-content-type"],errorId:t.errorId,extra:{public:t.public}};super(um.StructuredProblemReport.from(r))}};ho.NotAContentTypeError=pu});var pm=f(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});yo.NotAMediaTypeError=void 0;var cm=ge(),Kw=Ze(),du=class extends cm.AppError{constructor(t){let r={template:Kw.ERROR_TABLE["not-a-media-type"],errorId:t.errorId,extra:{public:t.public}};super(cm.StructuredProblemReport.from(r))}};yo.NotAMediaTypeError=du});var bo=f(vo=>{"use strict";Object.defineProperty(vo,"__esModule",{value:!0});vo.MediaTypeMatchRegexIsBrokenError=void 0;var dm=ge(),zw=cu(),fu=class extends dm.AppError{constructor(t){let r={template:zw.ERROR_TABLE["mediatypematchregex-is-broken"],errorId:t.errorId,extra:null};super(dm.StructuredProblemReport.from(r))}};vo.MediaTypeMatchRegexIsBrokenError=fu});var gu=f(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.UnexpectedContentTypeError=void 0;var fm=ge(),Jw=Ze(),mu=class extends fm.AppError{constructor(t){let r={template:Jw.ERROR_TABLE["unexpected-content-type"],errorId:t.errorId,extra:{public:t.public}};super(fm.StructuredProblemReport.from(r))}};Ao.UnexpectedContentTypeError=mu});var Ze=f(pr=>{"use strict";Object.defineProperty(pr,"__esModule",{value:!0});var Yw=cu();Object.defineProperty(pr,"ERROR_TABLE",{enumerable:!0,get:function(){return Yw.ERROR_TABLE}});var Zw=lm();Object.defineProperty(pr,"NotAContentTypeError",{enumerable:!0,get:function(){return Zw.NotAContentTypeError}});var ex=pm();Object.defineProperty(pr,"NotAMediaTypeError",{enumerable:!0,get:function(){return ex.NotAMediaTypeError}});var tx=bo();Object.defineProperty(pr,"MediaTypeMatchRegexIsBrokenError",{enumerable:!0,get:function(){return tx.MediaTypeMatchRegexIsBrokenError}});var rx=gu();Object.defineProperty(pr,"UnexpectedContentTypeError",{enumerable:!0,get:function(){return rx.UnexpectedContentTypeError}})});var gm=f(mm=>{"use strict";Object.defineProperty(mm,"__esModule",{value:!0})});var Hr=f(qt=>{"use strict";Object.defineProperty(qt,"__esModule",{value:!0});qt.MediaTypeParamRegex=qt.MediaTypeMatchRegex=qt.ContentTypeMatchRegex=void 0;qt.ContentTypeMatchRegex=/^(?<contentType>(?<type>[A-Za-z0-9][-\w!#$&^]*)\/((?<tree>[A-Za-z0-9][\w\d-!#$&^]*)\.){0,1}(?<subtype>[^+()<>@,;:\\/"[\]?=+]+)(\+(?<suffix>[\w\d]+)){0,1})$/;qt.MediaTypeMatchRegex=/^(?<contentType>(?<type>[A-Za-z0-9][-\w!#$&^]*)\/((?<tree>[A-Za-z0-9][\w\d-!#$&^]*)\.){0,1}(?<subtype>[^+()<>@,;:\\/"[\]?=+]+)(\+(?<suffix>[\w\d]+)){0,1})(;[\s]+(?<parameter>[\w\d]+=([^+()<>@,;:\\/"[\]?=]+|"[^"]*\")))*$/;qt.MediaTypeParamRegex=/(;[\s]+((?<parameterName>[\w\d]+)=((?<parameterValueA>[^+()<>@,;:\\/"[\]?=+]+)|"(?<parameterValueB>[^"]*)")))/g});var hu=f(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.isContentType=void 0;var ix=Hr();function nx(e){return ix.ContentTypeMatchRegex.test(e)}_o.isContentType=nx});var yu=f(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});wo.mustBeContentType=void 0;var ox=ge(),ax=Ze(),sx=hu();function ux(e,t=ox.THROW_THE_ERROR){sx.isContentType(e)||t(new ax.NotAContentTypeError({public:{input:e}}))}wo.mustBeContentType=ux});var xo=f(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});jr._contentTypeFrom=jr.contentTypeFrom=void 0;var lx=ge(),cx=yu();jr.contentTypeFrom=hm.bind(null,e=>e.toLowerCase());function hm(e,t,r=lx.THROW_THE_ERROR){return cx.mustBeContentType(t,r),e(t)}jr._contentTypeFrom=hm});var vm=f(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr._contentTypeFromMediaType=Lr.contentTypeFromMediaType=void 0;var px=ge(),dx=Ze(),fx=Hr(),mx=bo(),gx=xo();Lr.contentTypeFromMediaType=ym.bind(null,fx.MediaTypeMatchRegex,e=>e.toLowerCase());function ym(e,t,r,i=px.THROW_THE_ERROR){let n=r.valueOf(),o=e.exec(n);if(o===null)throw i(new dx.NotAMediaTypeError({public:{input:n}}));if(o.groups===void 0)throw i(new mx.MediaTypeMatchRegexIsBrokenError({}));return gx._contentTypeFrom(t,o.groups.contentType)}Lr._contentTypeFromMediaType=ym});var bu=f(Le=>{"use strict";var hx=Le&&Le.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),vu=Le&&Le.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&hx(t,e,r)};Object.defineProperty(Le,"__esModule",{value:!0});vu(gm(),Le);var yx=xo();Object.defineProperty(Le,"contentTypeFrom",{enumerable:!0,get:function(){return yx.contentTypeFrom}});var vx=vm();Object.defineProperty(Le,"contentTypeFromMediaType",{enumerable:!0,get:function(){return vx.contentTypeFromMediaType}});vu(hu(),Le);vu(yu(),Le)});var Au=f(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});Eo.isMediaType=void 0;var bx=Hr();function Ax(e){return bx.MediaTypeMatchRegex.test(e)}Eo.isMediaType=Ax});var Am=f(bm=>{"use strict";Object.defineProperty(bm,"__esModule",{value:!0})});var _m=f(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.resolveToContentType=void 0;var _x=So(),wx=bu();function xx(e){return e instanceof _x.MediaType?wx.contentTypeFromMediaType(e):e}To.resolveToContentType=xx});var xm=f(Oo=>{"use strict";Object.defineProperty(Oo,"__esModule",{value:!0});Oo.resolveToMediaType=void 0;var wm=So();function Ex(e){return e instanceof wm.MediaType?e:new wm.MediaType(e)}Oo.resolveToMediaType=Ex});var Po=f(vt=>{"use strict";var Tx=vt&&vt.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),_u=vt&&vt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&Tx(t,e,r)};Object.defineProperty(vt,"__esModule",{value:!0});_u(Am(),vt);_u(_m(),vt);_u(xm(),vt)});var wu=f(Mo=>{"use strict";Object.defineProperty(Mo,"__esModule",{value:!0});Mo.matchesContentType=void 0;var Em=Po();function Sx(e,t){let r=Em.resolveToContentType(e);return t.some(i=>{let n=Em.resolveToContentType(i);return r===n})}Mo.matchesContentType=Sx});var xu=f(Ro=>{"use strict";Object.defineProperty(Ro,"__esModule",{value:!0});Ro.mustBeMediaType=void 0;var Ox=ge(),Px=Ze(),Mx=Au();function Rx(e,t=Ox.THROW_THE_ERROR){Mx.isMediaType(e)||t(new Px.NotAMediaTypeError({public:{input:e}}))}Ro.mustBeMediaType=Rx});var Sm=f(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.mustMatchContentType=void 0;var Dx=ge(),Ix=gu(),Nx=wu(),Tm=Po();function Cx(e,t,r=Dx.THROW_THE_ERROR){if(Nx.matchesContentType(e,t))return;let i=t.map(n=>Tm.resolveToContentType(n));r(new Ix.UnexpectedContentTypeError({public:{input:Tm.resolveToContentType(e),required:{anyOf:i}}}))}Do.mustMatchContentType=Cx});var Pm=f(Om=>{"use strict";Object.defineProperty(Om,"__esModule",{value:!0})});var Rm=f(Mm=>{"use strict";Object.defineProperty(Mm,"__esModule",{value:!0})});var Im=f(Dm=>{"use strict";Object.defineProperty(Dm,"__esModule",{value:!0})});var Nm=f(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});Io.EntityObject=void 0;var Eu=class{constructor(t){this.value=t}valueOf(){return this.value}isEntity(){return!0}};Io.EntityObject=Eu});var qm=f(Cm=>{"use strict";Object.defineProperty(Cm,"__esModule",{value:!0})});var Bm=f(km=>{"use strict";Object.defineProperty(km,"__esModule",{value:!0})});var Vm=f(Fm=>{"use strict";Object.defineProperty(Fm,"__esModule",{value:!0})});var Hm=f(bt=>{"use strict";var qx=bt&&bt.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),Tu=bt&&bt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&qx(t,e,r)};Object.defineProperty(bt,"__esModule",{value:!0});Tu(Bm(),bt);Tu(Vm(),bt);Tu(Ks(),bt)});var Su=f(Ce=>{"use strict";var kx=Ce&&Ce.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),qi=Ce&&Ce.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&kx(t,e,r)};Object.defineProperty(Ce,"__esModule",{value:!0});qi(Pm(),Ce);qi(Rm(),Ce);qi(Im(),Ce);qi(Nm(),Ce);qi(qm(),Ce);var Bx=Hm();Object.defineProperty(Ce,"ValueObject",{enumerable:!0,get:function(){return Bx.ValueObject}})});var Pu=f(No=>{"use strict";Object.defineProperty(No,"__esModule",{value:!0});No.RefinedType=void 0;var Fx=Su(),Ou=class extends Fx.ValueObject{constructor(t,r,i){r(t,i),super(t)}};No.RefinedType=Ou});var qo=f(Co=>{"use strict";Object.defineProperty(Co,"__esModule",{value:!0});Co.RefinedPrimitive=void 0;var Vx=Pu(),Mu=class extends Vx.RefinedType{};Co.RefinedPrimitive=Mu});var jm=f(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.RefinedNumber=void 0;var Hx=qo(),Ru=class extends Hx.RefinedPrimitive{[Symbol.toPrimitive](t){return t==="string"?this.value.toString():this.value}};ko.RefinedNumber=Ru});var Lm=f(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});Bo.RefinedString=void 0;var jx=qo(),Du=class extends jx.RefinedPrimitive{[Symbol.toPrimitive](t){return t==="number"?null:this.value}};Bo.RefinedString=Du});var Um=f(et=>{"use strict";var Lx=et&&et.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),Fo=et&&et.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&Lx(t,e,r)};Object.defineProperty(et,"__esModule",{value:!0});Fo(jm(),et);Fo(qo(),et);Fo(Lm(),et);Fo(Pu(),et)});var Xm=f(Wm=>{"use strict";Object.defineProperty(Wm,"__esModule",{value:!0})});var Gm=f(Vo=>{"use strict";Object.defineProperty(Vo,"__esModule",{value:!0});Vo.makeRefinedTypeFactory=void 0;var Ux=Di();Vo.makeRefinedTypeFactory=(e,t=Ux.THROW_THE_ERROR)=>(r,i=t)=>(e(r,i),r)});var $m=f(Ho=>{"use strict";Object.defineProperty(Ho,"__esModule",{value:!0});Ho.makeRefinedTypeFactoryWithFormatter=void 0;var Wx=Di();Ho.makeRefinedTypeFactoryWithFormatter=(e,t,r=Wx.THROW_THE_ERROR)=>(i,n=r)=>(e(i,n),t(i))});var Km=f(Qm=>{"use strict";Object.defineProperty(Qm,"__esModule",{value:!0})});var zm=f(tt=>{"use strict";var Xx=tt&&tt.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),jo=tt&&tt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&Xx(t,e,r)};Object.defineProperty(tt,"__esModule",{value:!0});jo(Xm(),tt);jo(Gm(),tt);jo($m(),tt);jo(Km(),tt)});var Jm=f(dr=>{"use strict";var Gx=dr&&dr.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),$x=dr&&dr.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&Gx(t,e,r)};Object.defineProperty(dr,"__esModule",{value:!0});$x(zm(),dr)});var Ym=f(At=>{"use strict";var Qx=At&&At.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),Iu=At&&At.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&Qx(t,e,r)};Object.defineProperty(At,"__esModule",{value:!0});Iu(Um(),At);Iu(Jm(),At);Iu(Su(),At)});var Nu=f(Ur=>{"use strict";Object.defineProperty(Ur,"__esModule",{value:!0});Ur._parseContentType=Ur.parseContentType=void 0;var Kx=ge(),Zm=Ze(),zx=Hr(),Jx=xo();Ur.parseContentType=eg.bind(null,zx.MediaTypeMatchRegex,e=>e.toLowerCase());function eg(e,t,r,i=Kx.THROW_THE_ERROR){let n=e.exec(r);if(n===null)throw i(new Zm.NotAMediaTypeError({public:{input:r}}));if(n.groups===void 0)throw i(new Zm.MediaTypeMatchRegexIsBrokenError({}));return Jx._contentTypeFrom(t,n.groups.contentType)}Ur._parseContentType=eg});var Cu=f(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.parseMediaTypeUnbound=Wr.parseMediaType=void 0;var Yx=ge(),Zx=Ze(),e3=bo(),tg=Hr();Wr.parseMediaType=rg.bind(null,tg.MediaTypeMatchRegex,tg.MediaTypeParamRegex);function rg(e,t,r,i=Yx.THROW_THE_ERROR,n=o=>o.toLocaleLowerCase()){let o=e.exec(r);if(o===null)throw i(new Zx.NotAMediaTypeError({public:{input:r}}));if(o.groups===void 0)throw i(new e3.MediaTypeMatchRegexIsBrokenError({}));let a={type:n(o.groups.type),subtype:n(o.groups.subtype)};o.groups.tree&&(a.tree=n(o.groups.tree)),o.groups.suffix&&(a.suffix=n(o.groups.suffix));let s=t.exec(r);if(s!==null)for(a.parameters={};s!==null&&s.groups!==void 0;){let u=n(s.groups.parameterName);a.parameters[u]=s.groups.parameterValueA||s.groups.parameterValueB,s=t.exec(r)}return a}Wr.parseMediaTypeUnbound=rg});var Bu=f(kt=>{"use strict";var Lo=kt&&kt.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},ig=kt&&kt.__classPrivateFieldSet||function(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r},ki,Bi;Object.defineProperty(kt,"__esModule",{value:!0});kt.MediaType=void 0;var qu=ge(),t3=Ym(),r3=xu(),i3=Nu(),n3=Cu(),ku=class e extends t3.RefinedString{constructor(t,r=qu.THROW_THE_ERROR){super(t,r3.mustBeMediaType,r),ki.set(this,void 0),Bi.set(this,void 0)}static from(t,r=qu.THROW_THE_ERROR){return new e(t,r)}getContentType(){return Lo(this,ki)||ig(this,ki,i3.parseContentType(this.valueOf())),Lo(this,ki)}parse(){return Lo(this,Bi)||ig(this,Bi,n3.parseMediaType(this.value,qu.THROW_THE_ERROR)),Lo(this,Bi)}};kt.MediaType=ku;ki=new WeakMap,Bi=new WeakMap});var ng=f(Uo=>{"use strict";Object.defineProperty(Uo,"__esModule",{value:!0});Uo.mediaTypeFrom=void 0;var o3=Bu();Uo.mediaTypeFrom=o3.MediaType.from});var ag=f(og=>{"use strict";Object.defineProperty(og,"__esModule",{value:!0})});var So=f(ce=>{"use strict";var a3=ce&&ce.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),_t=ce&&ce.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&a3(t,e,r)};Object.defineProperty(ce,"__esModule",{value:!0});_t(Au(),ce);_t(wu(),ce);_t(xu(),ce);_t(Sm(),ce);_t(ng(),ce);_t(Bu(),ce);_t(ag(),ce);_t(Nu(),ce);_t(Cu(),ce)});var sg=f(rt=>{"use strict";var s3=rt&&rt.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),Wo=rt&&rt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&s3(t,e,r)};Object.defineProperty(rt,"__esModule",{value:!0});Wo(Ze(),rt);Wo(bu(),rt);Wo(So(),rt);Wo(Po(),rt)});function Fu(e,t,r){let i=t.andThen(a=>a.defacto_codecs.audio),n=t.andThen(a=>a.defacto_codecs.video),o=e.split(",");if(o.length>1){let a=Rr().find(g=>g.mimetype.test(o[0])),s=Rr().find(g=>g.mimetype.test(o[1])),u=Dr().find(g=>g.mimetype.test(o[0])),l=Dr().find(g=>g.mimetype.test(o[1])),p=i.unwrapOr("unknown"),c=n.unwrapOr("unknown");return{audio:u.or(l).map(g=>g.name).unwrapOr(p),video:a.or(s).map(g=>g.name).unwrapOr(c)}}else{let a=Rr().find(l=>l.mimetype.test(o[0])).map(l=>l.name),s=Dr().find(l=>l.mimetype.test(o[0])).map(l=>l.name);return s.isSome()?{video:!1,audio:s.unwrap()}:a.isSome()?{video:a.unwrap(),audio:!1}:r.map(l=>l==="audio").unwrapOr(!1)?{video:!1,audio:s.or(i).unwrapOr("unknown")}:{video:a.or(n).unwrapOr("unknown"),audio:!1}}}function Xr(e){let t;try{t=(0,ug.mediaTypeFrom)(e).parse()}catch(s){return $("parse error:"+s)}let r=M;t.type=="video"&&(r=N("video")),t.type=="audio"&&(r=N("audio"));let i=Rs().find(s=>s.mimetype.test(t.subtype));if(i.isNone())return $(`Unknown container (parsed from ${t.subtype})`);let n=t.parameters?.codecs??"",o=Fu(n,i,r),a=i.unwrap();return X({container:a.name,av_codecs:o})}var ug,Fi=I(()=>{"use strict";ug=wn(sg(),1);de();mt();ft();Ve()});function Vu(e,t){if(!Zt(e,"mimeType"))return $("Missing mimeType");let r=Xr(e.mimeType);if(r.isErr())return r;let i=r.unwrap(),n=le(i.container),o="unknown";if(Zt(e,"approxDurationMs")){let u=parseInt(e.approxDurationMs)/1e3;u&&(o=u)}let a=M;qr(e,"bitrate")&&(a=N(e.bitrate));let s=gt(i.av_codecs,u=>({codec:dt(u),bitrate:a}),u=>{let l=He(u),p=M,c=M,g=M;return qr(e,"fps")&&(p=N(e.fps)),qr(e,"width")&&qr(e,"height")&&(c=N({height:e.height,width:e.width})),Zt(e,"qualityLabel")&&(g=od(e.qualityLabel)),g.isNone()&&c.isSome()&&(g=N(Nr(c.unwrap().height))),{codec:l,bitrate:a,fps:p,dimensions:c,quality:g}});return X({builder:"YoutubeFormat",protocol:t,duration:o,container:n,av:s})}var lg=I(()=>{"use strict";de();Fi();ft();mt();jn();Ir();Cr()});var Gr={};Z(Gr,{defineInPage:()=>c3,getFilenameFromTitle:()=>d3,getSpecs:()=>p3,set:()=>l3});async function Xo(){let e=await fr;await Hu.storage.local.set({smartname:e})}async function l3(e){fr=Promise.resolve(e),Xo()}async function c3(){let e=await Hu.tabs.query({active:!0,currentWindow:!0});if(e.length===0)throw new Error("Can't find current tab");u3.executeScriptWithGlobal({tabId:e[0].id},{},"/injected/smartname.js")}async function p3(e){let t=await fr,r=new URL(e).hostname.split(".");for(let i=0;i<r.length-1;i++){let n=t[r.slice(i).join(".")];if(n)return n}return null}async function d3(e,t=null){e=e.trim(),t&&e.endsWith(`.${t}`)&&(t=null);let r={keep:" ",remove:"",hyphen:"-",underscore:"_"},i=await Ue.prefs;t&&(t=t.replace(cg,""),t=t.replace(pg,r[i.smartnamerFnameSpaces])),e=e.replace(cg,""),e=e.replace(pg,r[i.smartnamerFnameSpaces]);let n=i.smartnamerFnameMaxlen;return t?(e.length+t.length+1>n&&(e=e.substr(0,n-t.length-1)),e+"."+t):(e.length>n&&(e=e.substr(0,n)),e)}var Ue,u3,Hu,fr,cg,pg,$r=I(()=>{"use strict";Ue=z(),u3=(_e(),P(Ae)),Hu=Ue.browser,fr=Hu.storage.local.get({smartname:{}}).then(e=>e.smartname);cg=new RegExp('[/?<>\\:*|":]|[\0-\x80-\x9F]|\\\\',"g"),pg=new RegExp(" +","g");Ue.rpc.listen({openSmartNameDefiner:async()=>{let e=await Ue.ui.open("smartname-definer",{url:"content/smartname-define.html",type:"panel",width:600,height:400});return await Ue.wait("smartname-definer"),e},closeSmartNameDefiner:()=>Ue.ui.close("smartname-definer"),closedSmartNameDefiner:e=>Ue.rpc.call(e,"close"),setSmartNameData:e=>Ue.rpc.call("smartname-definer","setData",e),evaluateSmartName:(e,t)=>Ue.rpc.call(e,"evaluate",t),addSmartNameRule:async e=>{let t=await fr;t[e.domain]=e,Xo()},selectSmartNameXPath:(e,t)=>Ue.rpc.call(e,"select",t),setSmartName:async e=>{fr=Promise.resolve({}),Xo()},getSmartNameRules:async()=>fr,editSmartName:()=>{Ue.ui.open("smartname-edit",{type:"tab",url:"content/smartname-edit.html"})},removeFromSmartName:async e=>{let t=await fr;delete t[e],Xo()}})});var Vi={};Z(Vi,{alert:()=>dg,dialog:()=>ju,fileDialog:()=>Qr,saveAs:()=>h3,selectConvertFiles:()=>y3,selectDirectory:()=>fg,selectMergeAudioFile:()=>b3,selectMergeVideoFile:()=>v3});function ju(e){let t=Promise.resolve();e.type==="tab"&&(t=t.then(()=>f3.tabs.query({active:!0,lastFocusedWindow:!0}).then(i=>{i.length>0&&m3.setTransientTab("<next-tab>",i[0].id)})));let r="dialog"+ ++g3;return t=t.then(()=>{ie.ui.open(r,e)}).then(()=>ie.wait(r)),t.__dialogName=r,t}async function dg(e){let t={autoResize:!0},r=await ie.prefs;return r.alertDialogType=="tab"&&(t={bodyClass:"dialog-in-tab",autoResize:!1}),ju({url:"content/alert.html",type:r.alertDialogType,height:e.height||200,autoClose:r.dialogAutoClose,initData:Object.assign(t,e)})}async function Qr(e){let t=await ie.prefs,r=ju({type:t.fileDialogType,url:"content/file-dialog.html",height:500,width:750,autoClose:t.dialogAutoClose,initData:Object.assign({filename:null,directory:null,uniqueFilename:!0,titleText:"",noSizeColumn:!1,dirOnly:!1,upDir:!0,editFileInput:!0,readonlyDir:!1,showDir:!0,okText:"OK",confirmOverwrite:!1,newDir:!1,createDir:!0},e)});return r.then(i=>(ie.ui.close(r.__dialogName),i)).catch(i=>(ie.ui.close(r.__dialogName),null))}function h3(e,t,r={}){return Qr(Object.assign({filename:e,directory:t,uniqueFilename:!0,titleText:ie._("save_file_as"),noSizeColumn:!1,dirOnly:!1,upDir:!0,editFileInput:!0,readonlyDir:!1,showDir:!0,okText:ie._("save"),confirmOverwrite:!0,newDir:!0,createDir:!0},r))}function fg(e,t={}){return Qr(Object.assign({directory:e,uniqueFilename:!1,titleText:ie._("weh_prefs_label_lastDownloadDirectory"),noSizeColumn:!0,dirOnly:!0,upDir:!0,editFileInput:!1,readonlyDir:!0,showDir:!1,okText:ie._("ok"),confirmOverwrite:!1,newDir:!0,createDir:!1},t))}function y3(e,t={}){return Qr(Object.assign({directory:e,uniqueFilename:!1,titleText:ie._("select_files_to_convert"),noSizeColumn:!1,dirOnly:!1,upDir:!0,readonlyDir:!0,editFileInput:!1,showDir:!1,okText:ie._("convert"),confirmOverwrite:!1,newDir:!1,createDir:!1,selectMultiple:!0,outputConfigs:!0},t))}function v3(e,t={}){return Qr(Object.assign({directory:e,uniqueFilename:!1,titleText:ie._("select_video_file_to_merge"),noSizeColumn:!1,dirOnly:!1,upDir:!0,readonlyDir:!0,editFileInput:!1,showDir:!1,okText:ie._("next"),confirmOverwrite:!1,newDir:!1,createDir:!1,selectMultiple:!1,outputConfigs:!1},t))}function b3(e,t={}){return Qr(Object.assign({directory:e,uniqueFilename:!1,titleText:ie._("select_audio_file_to_merge"),noSizeColumn:!1,dirOnly:!1,upDir:!0,readonlyDir:!0,editFileInput:!1,showDir:!1,okText:ie._("next"),confirmOverwrite:!1,newDir:!1,createDir:!1,selectMultiple:!1,outputConfigs:!1},t))}var ie,f3,m3,g3,Hi=I(()=>{"use strict";ie=z(),f3=ie.browser,m3=(Ft(),P(Bt)),g3=0;ie.rpc.listen({alert:dg,selectDirectory:fg})});var Go=f(wt=>{"use strict";var mg=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",A3=mg+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",gg="["+mg+"]["+A3+"]*",_3=new RegExp("^"+gg+"$"),w3=function(e,t){let r=[],i=t.exec(e);for(;i;){let n=[];n.startIndex=t.lastIndex-i[0].length;let o=i.length;for(let a=0;a<o;a++)n.push(i[a]);r.push(n),i=t.exec(e)}return r},x3=function(e){let t=_3.exec(e);return!(t===null||typeof t>"u")};wt.isExist=function(e){return typeof e<"u"};wt.isEmptyObject=function(e){return Object.keys(e).length===0};wt.merge=function(e,t,r){if(t){let i=Object.keys(t),n=i.length;for(let o=0;o<n;o++)r==="strict"?e[i[o]]=[t[i[o]]]:e[i[o]]=t[i[o]]}};wt.getValue=function(e){return wt.isExist(e)?e:""};wt.isName=x3;wt.getAllMatches=w3;wt.nameRegexp=gg});var Uu=f(Ag=>{"use strict";var Lu=Go(),E3={allowBooleanAttributes:!1,unpairedTags:[]};Ag.validate=function(e,t){t=Object.assign({},E3,t);let r=[],i=!1,n=!1;e[0]==="\uFEFF"&&(e=e.substr(1));for(let o=0;o<e.length;o++)if(e[o]==="<"&&e[o+1]==="?"){if(o+=2,o=yg(e,o),o.err)return o}else if(e[o]==="<"){let a=o;if(o++,e[o]==="!"){o=vg(e,o);continue}else{let s=!1;e[o]==="/"&&(s=!0,o++);let u="";for(;o<e.length&&e[o]!==">"&&e[o]!==" "&&e[o]!=="	"&&e[o]!==`
`&&e[o]!=="\r";o++)u+=e[o];if(u=u.trim(),u[u.length-1]==="/"&&(u=u.substring(0,u.length-1),o--),!I3(u)){let c;return u.trim().length===0?c="Invalid space after '<'.":c="Tag '"+u+"' is an invalid name.",te("InvalidTag",c,he(e,o))}let l=O3(e,o);if(l===!1)return te("InvalidAttr","Attributes for '"+u+"' have open quote.",he(e,o));let p=l.value;if(o=l.index,p[p.length-1]==="/"){let c=o-p.length;p=p.substring(0,p.length-1);let g=bg(p,t);if(g===!0)i=!0;else return te(g.err.code,g.err.msg,he(e,c+g.err.line))}else if(s)if(l.tagClosed){if(p.trim().length>0)return te("InvalidTag","Closing tag '"+u+"' can't have attributes or invalid starting.",he(e,a));{let c=r.pop();if(u!==c.tagName){let g=he(e,c.tagStartPos);return te("InvalidTag","Expected closing tag '"+c.tagName+"' (opened in line "+g.line+", col "+g.col+") instead of closing tag '"+u+"'.",he(e,a))}r.length==0&&(n=!0)}}else return te("InvalidTag","Closing tag '"+u+"' doesn't have proper closing.",he(e,o));else{let c=bg(p,t);if(c!==!0)return te(c.err.code,c.err.msg,he(e,o-p.length+c.err.line));if(n===!0)return te("InvalidXml","Multiple possible root nodes found.",he(e,o));t.unpairedTags.indexOf(u)!==-1||r.push({tagName:u,tagStartPos:a}),i=!0}for(o++;o<e.length;o++)if(e[o]==="<")if(e[o+1]==="!"){o++,o=vg(e,o);continue}else if(e[o+1]==="?"){if(o=yg(e,++o),o.err)return o}else break;else if(e[o]==="&"){let c=R3(e,o);if(c==-1)return te("InvalidChar","char '&' is not expected.",he(e,o));o=c}else if(n===!0&&!hg(e[o]))return te("InvalidXml","Extra text at the end",he(e,o));e[o]==="<"&&o--}}else{if(hg(e[o]))continue;return te("InvalidChar","char '"+e[o]+"' is not expected.",he(e,o))}if(i){if(r.length==1)return te("InvalidTag","Unclosed tag '"+r[0].tagName+"'.",he(e,r[0].tagStartPos));if(r.length>0)return te("InvalidXml","Invalid '"+JSON.stringify(r.map(o=>o.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return te("InvalidXml","Start tag expected.",1);return!0};function hg(e){return e===" "||e==="	"||e===`
`||e==="\r"}function yg(e,t){let r=t;for(;t<e.length;t++)if(e[t]=="?"||e[t]==" "){let i=e.substr(r,t-r);if(t>5&&i==="xml")return te("InvalidXml","XML declaration allowed only at the start of the document.",he(e,t));if(e[t]=="?"&&e[t+1]==">"){t++;break}else continue}return t}function vg(e,t){if(e.length>t+5&&e[t+1]==="-"&&e[t+2]==="-"){for(t+=3;t<e.length;t++)if(e[t]==="-"&&e[t+1]==="-"&&e[t+2]===">"){t+=2;break}}else if(e.length>t+8&&e[t+1]==="D"&&e[t+2]==="O"&&e[t+3]==="C"&&e[t+4]==="T"&&e[t+5]==="Y"&&e[t+6]==="P"&&e[t+7]==="E"){let r=1;for(t+=8;t<e.length;t++)if(e[t]==="<")r++;else if(e[t]===">"&&(r--,r===0))break}else if(e.length>t+9&&e[t+1]==="["&&e[t+2]==="C"&&e[t+3]==="D"&&e[t+4]==="A"&&e[t+5]==="T"&&e[t+6]==="A"&&e[t+7]==="["){for(t+=8;t<e.length;t++)if(e[t]==="]"&&e[t+1]==="]"&&e[t+2]===">"){t+=2;break}}return t}var T3='"',S3="'";function O3(e,t){let r="",i="",n=!1;for(;t<e.length;t++){if(e[t]===T3||e[t]===S3)i===""?i=e[t]:i!==e[t]||(i="");else if(e[t]===">"&&i===""){n=!0;break}r+=e[t]}return i!==""?!1:{value:r,index:t,tagClosed:n}}var P3=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function bg(e,t){let r=Lu.getAllMatches(e,P3),i={};for(let n=0;n<r.length;n++){if(r[n][1].length===0)return te("InvalidAttr","Attribute '"+r[n][2]+"' has no space in starting.",ji(r[n]));if(r[n][3]!==void 0&&r[n][4]===void 0)return te("InvalidAttr","Attribute '"+r[n][2]+"' is without value.",ji(r[n]));if(r[n][3]===void 0&&!t.allowBooleanAttributes)return te("InvalidAttr","boolean attribute '"+r[n][2]+"' is not allowed.",ji(r[n]));let o=r[n][2];if(!D3(o))return te("InvalidAttr","Attribute '"+o+"' is an invalid name.",ji(r[n]));if(!i.hasOwnProperty(o))i[o]=1;else return te("InvalidAttr","Attribute '"+o+"' is repeated.",ji(r[n]))}return!0}function M3(e,t){let r=/\d/;for(e[t]==="x"&&(t++,r=/[\da-fA-F]/);t<e.length;t++){if(e[t]===";")return t;if(!e[t].match(r))break}return-1}function R3(e,t){if(t++,e[t]===";")return-1;if(e[t]==="#")return t++,M3(e,t);let r=0;for(;t<e.length;t++,r++)if(!(e[t].match(/\w/)&&r<20)){if(e[t]===";")break;return-1}return t}function te(e,t,r){return{err:{code:e,msg:t,line:r.line||r,col:r.col}}}function D3(e){return Lu.isName(e)}function I3(e){return Lu.isName(e)}function he(e,t){let r=e.substring(0,t).split(/\r?\n/);return{line:r.length,col:r[r.length-1].length+1}}function ji(e){return e.startIndex+e[1].length}});var wg=f(Wu=>{var _g={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(e,t,r){return e}},N3=function(e){return Object.assign({},_g,e)};Wu.buildOptions=N3;Wu.defaultOptions=_g});var Eg=f((ON,xg)=>{"use strict";var Xu=class{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,r){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:r})}addChild(t){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}};xg.exports=Xu});var Sg=f((PN,Tg)=>{var C3=Go();function q3(e,t){let r={};if(e[t+3]==="O"&&e[t+4]==="C"&&e[t+5]==="T"&&e[t+6]==="Y"&&e[t+7]==="P"&&e[t+8]==="E"){t=t+9;let i=1,n=!1,o=!1,a="";for(;t<e.length;t++)if(e[t]==="<"&&!o){if(n&&F3(e,t))t+=7,[entityName,val,t]=k3(e,t+1),val.indexOf("&")===-1&&(r[L3(entityName)]={regx:RegExp(`&${entityName};`,"g"),val});else if(n&&V3(e,t))t+=8;else if(n&&H3(e,t))t+=8;else if(n&&j3(e,t))t+=9;else if(B3)o=!0;else throw new Error("Invalid DOCTYPE");i++,a=""}else if(e[t]===">"){if(o?e[t-1]==="-"&&e[t-2]==="-"&&(o=!1,i--):i--,i===0)break}else e[t]==="["?n=!0:a+=e[t];if(i!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:r,i:t}}function k3(e,t){let r="";for(;t<e.length&&e[t]!=="'"&&e[t]!=='"';t++)r+=e[t];if(r=r.trim(),r.indexOf(" ")!==-1)throw new Error("External entites are not supported");let i=e[t++],n="";for(;t<e.length&&e[t]!==i;t++)n+=e[t];return[r,n,t]}function B3(e,t){return e[t+1]==="!"&&e[t+2]==="-"&&e[t+3]==="-"}function F3(e,t){return e[t+1]==="!"&&e[t+2]==="E"&&e[t+3]==="N"&&e[t+4]==="T"&&e[t+5]==="I"&&e[t+6]==="T"&&e[t+7]==="Y"}function V3(e,t){return e[t+1]==="!"&&e[t+2]==="E"&&e[t+3]==="L"&&e[t+4]==="E"&&e[t+5]==="M"&&e[t+6]==="E"&&e[t+7]==="N"&&e[t+8]==="T"}function H3(e,t){return e[t+1]==="!"&&e[t+2]==="A"&&e[t+3]==="T"&&e[t+4]==="T"&&e[t+5]==="L"&&e[t+6]==="I"&&e[t+7]==="S"&&e[t+8]==="T"}function j3(e,t){return e[t+1]==="!"&&e[t+2]==="N"&&e[t+3]==="O"&&e[t+4]==="T"&&e[t+5]==="A"&&e[t+6]==="T"&&e[t+7]==="I"&&e[t+8]==="O"&&e[t+9]==="N"}function L3(e){if(C3.isName(e))return e;throw new Error(`Invalid entity name ${e}`)}Tg.exports=q3});var Pg=f((MN,Og)=>{var U3=/^[-+]?0x[a-fA-F0-9]+$/,W3=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);var X3={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function G3(e,t={}){if(t=Object.assign({},X3,t),!e||typeof e!="string")return e;let r=e.trim();if(t.skipLike!==void 0&&t.skipLike.test(r))return e;if(t.hex&&U3.test(r))return Number.parseInt(r,16);{let i=W3.exec(r);if(i){let n=i[1],o=i[2],a=$3(i[3]),s=i[4]||i[6];if(!t.leadingZeros&&o.length>0&&n&&r[2]!==".")return e;if(!t.leadingZeros&&o.length>0&&!n&&r[1]!==".")return e;{let u=Number(r),l=""+u;return l.search(/[eE]/)!==-1||s?t.eNotation?u:e:r.indexOf(".")!==-1?l==="0"&&a===""||l===a||n&&l==="-"+a?u:e:o?a===l||n+a===l?u:e:r===l||r===n+l?u:e}}else return e}}function $3(e){return e&&e.indexOf(".")!==-1&&(e=e.replace(/0+$/,""),e==="."?e="0":e[0]==="."?e="0"+e:e[e.length-1]==="."&&(e=e.substr(0,e.length-1))),e}Og.exports=G3});var Rg=f((DN,Mg)=>{"use strict";var Ku=Go(),Li=Eg(),Q3=Sg(),K3=Pg(),RN="<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,Ku.nameRegexp),Gu=class{constructor(t){this.options=t,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"\xA2"},pound:{regex:/&(pound|#163);/g,val:"\xA3"},yen:{regex:/&(yen|#165);/g,val:"\xA5"},euro:{regex:/&(euro|#8364);/g,val:"\u20AC"},copyright:{regex:/&(copy|#169);/g,val:"\xA9"},reg:{regex:/&(reg|#174);/g,val:"\xAE"},inr:{regex:/&(inr|#8377);/g,val:"\u20B9"}},this.addExternalEntities=z3,this.parseXml=tE,this.parseTextData=J3,this.resolveNameSpace=Y3,this.buildAttributesMap=eE,this.isItStopNode=oE,this.replaceEntitiesValue=iE,this.readStopNodeData=sE,this.saveTextToParentTag=nE,this.addChild=rE}};function z3(e){let t=Object.keys(e);for(let r=0;r<t.length;r++){let i=t[r];this.lastEntities[i]={regex:new RegExp("&"+i+";","g"),val:e[i]}}}function J3(e,t,r,i,n,o,a){if(e!==void 0&&(this.options.trimValues&&!i&&(e=e.trim()),e.length>0)){a||(e=this.replaceEntitiesValue(e));let s=this.options.tagValueProcessor(t,e,r,n,o);return s==null?e:typeof s!=typeof e||s!==e?s:this.options.trimValues?Qu(e,this.options.parseTagValue,this.options.numberParseOptions):e.trim()===e?Qu(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function Y3(e){if(this.options.removeNSPrefix){let t=e.split(":"),r=e.charAt(0)==="/"?"/":"";if(t[0]==="xmlns")return"";t.length===2&&(e=r+t[1])}return e}var Z3=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function eE(e,t,r){if(!this.options.ignoreAttributes&&typeof e=="string"){let i=Ku.getAllMatches(e,Z3),n=i.length,o={};for(let a=0;a<n;a++){let s=this.resolveNameSpace(i[a][1]),u=i[a][4],l=this.options.attributeNamePrefix+s;if(s.length)if(this.options.transformAttributeName&&(l=this.options.transformAttributeName(l)),l==="__proto__"&&(l="#__proto__"),u!==void 0){this.options.trimValues&&(u=u.trim()),u=this.replaceEntitiesValue(u);let p=this.options.attributeValueProcessor(s,u,t);p==null?o[l]=u:typeof p!=typeof u||p!==u?o[l]=p:o[l]=Qu(u,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(o[l]=!0)}if(!Object.keys(o).length)return;if(this.options.attributesGroupName){let a={};return a[this.options.attributesGroupName]=o,a}return o}}var tE=function(e){e=e.replace(/\r\n?/g,`
`);let t=new Li("!xml"),r=t,i="",n="";for(let o=0;o<e.length;o++)if(e[o]==="<")if(e[o+1]==="/"){let s=mr(e,">",o,"Closing Tag is not closed."),u=e.substring(o+2,s).trim();if(this.options.removeNSPrefix){let c=u.indexOf(":");c!==-1&&(u=u.substr(c+1))}this.options.transformTagName&&(u=this.options.transformTagName(u)),r&&(i=this.saveTextToParentTag(i,r,n));let l=n.substring(n.lastIndexOf(".")+1);if(u&&this.options.unpairedTags.indexOf(u)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${u}>`);let p=0;l&&this.options.unpairedTags.indexOf(l)!==-1?(p=n.lastIndexOf(".",n.lastIndexOf(".")-1),this.tagsNodeStack.pop()):p=n.lastIndexOf("."),n=n.substring(0,p),r=this.tagsNodeStack.pop(),i="",o=s}else if(e[o+1]==="?"){let s=$u(e,o,!1,"?>");if(!s)throw new Error("Pi Tag is not closed.");if(i=this.saveTextToParentTag(i,r,n),!(this.options.ignoreDeclaration&&s.tagName==="?xml"||this.options.ignorePiTags)){let u=new Li(s.tagName);u.add(this.options.textNodeName,""),s.tagName!==s.tagExp&&s.attrExpPresent&&(u[":@"]=this.buildAttributesMap(s.tagExp,n,s.tagName)),this.addChild(r,u,n)}o=s.closeIndex+1}else if(e.substr(o+1,3)==="!--"){let s=mr(e,"-->",o+4,"Comment is not closed.");if(this.options.commentPropName){let u=e.substring(o+4,s-2);i=this.saveTextToParentTag(i,r,n),r.add(this.options.commentPropName,[{[this.options.textNodeName]:u}])}o=s}else if(e.substr(o+1,2)==="!D"){let s=Q3(e,o);this.docTypeEntities=s.entities,o=s.i}else if(e.substr(o+1,2)==="!["){let s=mr(e,"]]>",o,"CDATA is not closed.")-2,u=e.substring(o+9,s);if(i=this.saveTextToParentTag(i,r,n),this.options.cdataPropName)r.add(this.options.cdataPropName,[{[this.options.textNodeName]:u}]);else{let l=this.parseTextData(u,r.tagname,n,!0,!1,!0);l==null&&(l=""),r.add(this.options.textNodeName,l)}o=s+2}else{let s=$u(e,o,this.options.removeNSPrefix),u=s.tagName,l=s.rawTagName,p=s.tagExp,c=s.attrExpPresent,g=s.closeIndex;this.options.transformTagName&&(u=this.options.transformTagName(u)),r&&i&&r.tagname!=="!xml"&&(i=this.saveTextToParentTag(i,r,n,!1));let A=r;if(A&&this.options.unpairedTags.indexOf(A.tagname)!==-1&&(r=this.tagsNodeStack.pop(),n=n.substring(0,n.lastIndexOf("."))),u!==t.tagname&&(n+=n?"."+u:u),this.isItStopNode(this.options.stopNodes,n,u)){let d="";if(p.length>0&&p.lastIndexOf("/")===p.length-1)o=s.closeIndex;else if(this.options.unpairedTags.indexOf(u)!==-1)o=s.closeIndex;else{let m=this.readStopNodeData(e,l,g+1);if(!m)throw new Error(`Unexpected end of ${l}`);o=m.i,d=m.tagContent}let _=new Li(u);u!==p&&c&&(_[":@"]=this.buildAttributesMap(p,n,u)),d&&(d=this.parseTextData(d,u,n,!0,c,!0,!0)),n=n.substr(0,n.lastIndexOf(".")),_.add(this.options.textNodeName,d),this.addChild(r,_,n)}else{if(p.length>0&&p.lastIndexOf("/")===p.length-1){u[u.length-1]==="/"?(u=u.substr(0,u.length-1),n=n.substr(0,n.length-1),p=u):p=p.substr(0,p.length-1),this.options.transformTagName&&(u=this.options.transformTagName(u));let d=new Li(u);u!==p&&c&&(d[":@"]=this.buildAttributesMap(p,n,u)),this.addChild(r,d,n),n=n.substr(0,n.lastIndexOf("."))}else{let d=new Li(u);this.tagsNodeStack.push(r),u!==p&&c&&(d[":@"]=this.buildAttributesMap(p,n,u)),this.addChild(r,d,n),r=d}i="",o=g}}else i+=e[o];return t.child};function rE(e,t,r){let i=this.options.updateTag(t.tagname,r,t[":@"]);i===!1||(typeof i=="string"&&(t.tagname=i),e.addChild(t))}var iE=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){let r=this.docTypeEntities[t];e=e.replace(r.regx,r.val)}for(let t in this.lastEntities){let r=this.lastEntities[t];e=e.replace(r.regex,r.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){let r=this.htmlEntities[t];e=e.replace(r.regex,r.val)}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e};function nE(e,t,r,i){return e&&(i===void 0&&(i=Object.keys(t.child).length===0),e=this.parseTextData(e,t.tagname,r,!1,t[":@"]?Object.keys(t[":@"]).length!==0:!1,i),e!==void 0&&e!==""&&t.add(this.options.textNodeName,e),e=""),e}function oE(e,t,r){let i="*."+r;for(let n in e){let o=e[n];if(i===o||t===o)return!0}return!1}function aE(e,t,r=">"){let i,n="";for(let o=t;o<e.length;o++){let a=e[o];if(i)a===i&&(i="");else if(a==='"'||a==="'")i=a;else if(a===r[0])if(r[1]){if(e[o+1]===r[1])return{data:n,index:o}}else return{data:n,index:o};else a==="	"&&(a=" ");n+=a}}function mr(e,t,r,i){let n=e.indexOf(t,r);if(n===-1)throw new Error(i);return n+t.length-1}function $u(e,t,r,i=">"){let n=aE(e,t+1,i);if(!n)return;let o=n.data,a=n.index,s=o.search(/\s/),u=o,l=!0;s!==-1&&(u=o.substr(0,s).replace(/\s\s*$/,""),o=o.substr(s+1));let p=u;if(r){let c=u.indexOf(":");c!==-1&&(u=u.substr(c+1),l=u!==n.data.substr(c+1))}return{tagName:u,tagExp:o,closeIndex:a,attrExpPresent:l,rawTagName:p}}function sE(e,t,r){let i=r,n=1;for(;r<e.length;r++)if(e[r]==="<")if(e[r+1]==="/"){let o=mr(e,">",r,`${t} is not closed`);if(e.substring(r+2,o).trim()===t&&(n--,n===0))return{tagContent:e.substring(i,r),i:o};r=o}else if(e[r+1]==="?")r=mr(e,"?>",r+1,"StopNode is not closed.");else if(e.substr(r+1,3)==="!--")r=mr(e,"-->",r+3,"StopNode is not closed.");else if(e.substr(r+1,2)==="![")r=mr(e,"]]>",r,"StopNode is not closed.")-2;else{let o=$u(e,r,">");o&&((o&&o.tagName)===t&&o.tagExp[o.tagExp.length-1]!=="/"&&n++,r=o.closeIndex)}}function Qu(e,t,r){if(t&&typeof e=="string"){let i=e.trim();return i==="true"?!0:i==="false"?!1:K3(e,r)}else return Ku.isExist(e)?e:""}Mg.exports=Gu});var Ng=f(Ig=>{"use strict";function uE(e,t){return Dg(e,t)}function Dg(e,t,r){let i,n={};for(let o=0;o<e.length;o++){let a=e[o],s=lE(a),u="";if(r===void 0?u=s:u=r+"."+s,s===t.textNodeName)i===void 0?i=a[s]:i+=""+a[s];else{if(s===void 0)continue;if(a[s]){let l=Dg(a[s],t,u),p=pE(l,t);a[":@"]?cE(l,a[":@"],u,t):Object.keys(l).length===1&&l[t.textNodeName]!==void 0&&!t.alwaysCreateTextNode?l=l[t.textNodeName]:Object.keys(l).length===0&&(t.alwaysCreateTextNode?l[t.textNodeName]="":l=""),n[s]!==void 0&&n.hasOwnProperty(s)?(Array.isArray(n[s])||(n[s]=[n[s]]),n[s].push(l)):t.isArray(s,u,p)?n[s]=[l]:n[s]=l}}}return typeof i=="string"?i.length>0&&(n[t.textNodeName]=i):i!==void 0&&(n[t.textNodeName]=i),n}function lE(e){let t=Object.keys(e);for(let r=0;r<t.length;r++){let i=t[r];if(i!==":@")return i}}function cE(e,t,r,i){if(t){let n=Object.keys(t),o=n.length;for(let a=0;a<o;a++){let s=n[a];i.isArray(s,r+"."+s,!0,!0)?e[s]=[t[s]]:e[s]=t[s]}}}function pE(e,t){let{textNodeName:r}=t,i=Object.keys(e).length;return!!(i===0||i===1&&(e[r]||typeof e[r]=="boolean"||e[r]===0))}Ig.prettify=uE});var qg=f((NN,Cg)=>{var{buildOptions:dE}=wg(),fE=Rg(),{prettify:mE}=Ng(),gE=Uu(),zu=class{constructor(t){this.externalEntities={},this.options=dE(t)}parse(t,r){if(typeof t!="string")if(t.toString)t=t.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(r){r===!0&&(r={});let o=gE.validate(t,r);if(o!==!0)throw Error(`${o.err.msg}:${o.err.line}:${o.err.col}`)}let i=new fE(this.options);i.addExternalEntities(this.externalEntities);let n=i.parseXml(t);return this.options.preserveOrder||n===void 0?n:mE(n,this.options)}addEntity(t,r){if(r.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(t.indexOf("&")!==-1||t.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(r==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[t]=r}};Cg.exports=zu});var Hg=f((CN,Vg)=>{var hE=`
`;function yE(e,t){let r="";return t.format&&t.indentBy.length>0&&(r=hE),Bg(e,t,"",r)}function Bg(e,t,r,i){let n="",o=!1;for(let a=0;a<e.length;a++){let s=e[a],u=vE(s);if(u===void 0)continue;let l="";if(r.length===0?l=u:l=`${r}.${u}`,u===t.textNodeName){let d=s[u];bE(l,t)||(d=t.tagValueProcessor(u,d),d=Fg(d,t)),o&&(n+=i),n+=d,o=!1;continue}else if(u===t.cdataPropName){o&&(n+=i),n+=`<![CDATA[${s[u][0][t.textNodeName]}]]>`,o=!1;continue}else if(u===t.commentPropName){n+=i+`<!--${s[u][0][t.textNodeName]}-->`,o=!0;continue}else if(u[0]==="?"){let d=kg(s[":@"],t),_=u==="?xml"?"":i,m=s[u][0][t.textNodeName];m=m.length!==0?" "+m:"",n+=_+`<${u}${m}${d}?>`,o=!0;continue}let p=i;p!==""&&(p+=t.indentBy);let c=kg(s[":@"],t),g=i+`<${u}${c}`,A=Bg(s[u],t,l,p);t.unpairedTags.indexOf(u)!==-1?t.suppressUnpairedNode?n+=g+">":n+=g+"/>":(!A||A.length===0)&&t.suppressEmptyNode?n+=g+"/>":A&&A.endsWith(">")?n+=g+`>${A}${i}</${u}>`:(n+=g+">",A&&i!==""&&(A.includes("/>")||A.includes("</"))?n+=i+t.indentBy+A+i:n+=A,n+=`</${u}>`),o=!0}return n}function vE(e){let t=Object.keys(e);for(let r=0;r<t.length;r++){let i=t[r];if(e.hasOwnProperty(i)&&i!==":@")return i}}function kg(e,t){let r="";if(e&&!t.ignoreAttributes)for(let i in e){if(!e.hasOwnProperty(i))continue;let n=t.attributeValueProcessor(i,e[i]);n=Fg(n,t),n===!0&&t.suppressBooleanAttributes?r+=` ${i.substr(t.attributeNamePrefix.length)}`:r+=` ${i.substr(t.attributeNamePrefix.length)}="${n}"`}return r}function bE(e,t){e=e.substr(0,e.length-t.textNodeName.length-1);let r=e.substr(e.lastIndexOf(".")+1);for(let i in t.stopNodes)if(t.stopNodes[i]===e||t.stopNodes[i]==="*."+r)return!0;return!1}function Fg(e,t){if(e&&e.length>0&&t.processEntities)for(let r=0;r<t.entities.length;r++){let i=t.entities[r];e=e.replace(i.regex,i.val)}return e}Vg.exports=yE});var Lg=f((qN,jg)=>{"use strict";var AE=Hg(),_E={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function Vt(e){this.options=Object.assign({},_E,e),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=EE),this.processTextOrObjNode=wE,this.options.format?(this.indentate=xE,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}Vt.prototype.build=function(e){return this.options.preserveOrder?AE(e,this.options):(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(e={[this.options.arrayNodeName]:e}),this.j2x(e,0).val)};Vt.prototype.j2x=function(e,t){let r="",i="";for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n))if(typeof e[n]>"u")this.isAttribute(n)&&(i+="");else if(e[n]===null)this.isAttribute(n)?i+="":n[0]==="?"?i+=this.indentate(t)+"<"+n+"?"+this.tagEndChar:i+=this.indentate(t)+"<"+n+"/"+this.tagEndChar;else if(e[n]instanceof Date)i+=this.buildTextValNode(e[n],n,"",t);else if(typeof e[n]!="object"){let o=this.isAttribute(n);if(o)r+=this.buildAttrPairStr(o,""+e[n]);else if(n===this.options.textNodeName){let a=this.options.tagValueProcessor(n,""+e[n]);i+=this.replaceEntitiesValue(a)}else i+=this.buildTextValNode(e[n],n,"",t)}else if(Array.isArray(e[n])){let o=e[n].length,a="";for(let s=0;s<o;s++){let u=e[n][s];typeof u>"u"||(u===null?n[0]==="?"?i+=this.indentate(t)+"<"+n+"?"+this.tagEndChar:i+=this.indentate(t)+"<"+n+"/"+this.tagEndChar:typeof u=="object"?this.options.oneListGroup?a+=this.j2x(u,t+1).val:a+=this.processTextOrObjNode(u,n,t):a+=this.buildTextValNode(u,n,"",t))}this.options.oneListGroup&&(a=this.buildObjectNode(a,n,"",t)),i+=a}else if(this.options.attributesGroupName&&n===this.options.attributesGroupName){let o=Object.keys(e[n]),a=o.length;for(let s=0;s<a;s++)r+=this.buildAttrPairStr(o[s],""+e[n][o[s]])}else i+=this.processTextOrObjNode(e[n],n,t);return{attrStr:r,val:i}};Vt.prototype.buildAttrPairStr=function(e,t){return t=this.options.attributeValueProcessor(e,""+t),t=this.replaceEntitiesValue(t),this.options.suppressBooleanAttributes&&t==="true"?" "+e:" "+e+'="'+t+'"'};function wE(e,t,r){let i=this.j2x(e,r+1);return e[this.options.textNodeName]!==void 0&&Object.keys(e).length===1?this.buildTextValNode(e[this.options.textNodeName],t,i.attrStr,r):this.buildObjectNode(i.val,t,i.attrStr,r)}Vt.prototype.buildObjectNode=function(e,t,r,i){if(e==="")return t[0]==="?"?this.indentate(i)+"<"+t+r+"?"+this.tagEndChar:this.indentate(i)+"<"+t+r+this.closeTag(t)+this.tagEndChar;{let n="</"+t+this.tagEndChar,o="";return t[0]==="?"&&(o="?",n=""),(r||r==="")&&e.indexOf("<")===-1?this.indentate(i)+"<"+t+r+o+">"+e+n:this.options.commentPropName!==!1&&t===this.options.commentPropName&&o.length===0?this.indentate(i)+`<!--${e}-->`+this.newLine:this.indentate(i)+"<"+t+r+o+this.tagEndChar+e+this.indentate(i)+n}};Vt.prototype.closeTag=function(e){let t="";return this.options.unpairedTags.indexOf(e)!==-1?this.options.suppressUnpairedNode||(t="/"):this.options.suppressEmptyNode?t="/":t=`></${e}`,t};Vt.prototype.buildTextValNode=function(e,t,r,i){if(this.options.cdataPropName!==!1&&t===this.options.cdataPropName)return this.indentate(i)+`<![CDATA[${e}]]>`+this.newLine;if(this.options.commentPropName!==!1&&t===this.options.commentPropName)return this.indentate(i)+`<!--${e}-->`+this.newLine;if(t[0]==="?")return this.indentate(i)+"<"+t+r+"?"+this.tagEndChar;{let n=this.options.tagValueProcessor(t,e);return n=this.replaceEntitiesValue(n),n===""?this.indentate(i)+"<"+t+r+this.closeTag(t)+this.tagEndChar:this.indentate(i)+"<"+t+r+">"+n+"</"+t+this.tagEndChar}};Vt.prototype.replaceEntitiesValue=function(e){if(e&&e.length>0&&this.options.processEntities)for(let t=0;t<this.options.entities.length;t++){let r=this.options.entities[t];e=e.replace(r.regex,r.val)}return e};function xE(e){return this.options.indentBy.repeat(e)}function EE(e){return e.startsWith(this.options.attributeNamePrefix)&&e!==this.options.textNodeName?e.substr(this.attrPrefixLen):!1}jg.exports=Vt});var Wg=f((kN,Ug)=>{"use strict";var TE=Uu(),SE=qg(),OE=Lg();Ug.exports={XMLParser:SE,XMLValidator:TE,XMLBuilder:OE}});function Gg(e){let r=new Xg.XMLParser({attributesGroupName:"@_",ignoreDeclaration:!0,parseAttributeValue:!0,ignoreAttributes:!1,removeNSPrefix:!0,trimValues:!0,isArray:s=>s==="adaptationset"||s==="representation",transformTagName:s=>s.toLowerCase(),transformAttributeName:s=>s.toLowerCase()}).parse(e),i=r.mpd?.period?.adaptationset;if(!Array.isArray(i))return $("Invalid MPD XML");let n="unknown";{let s=r.mpd?.["@_"]?.["@_mediapresentationduration"];if(typeof s=="string"){let u=/\d+(\.\d+)?S/,l=/\d+M/,p=u.exec(s),c=l.exec(s);(p||c)&&(n=0,p&&p.length>0&&(n=parseFloat(p[0])),c&&c.length>0&&(n+=60*(parseFloat(c[0])??0)))}}let o=0,a=[];for(let s of i){let u=[s];"contentcomponent"in s&&"@_"in s.contentcomponent&&u.push(s.contentcomponent),"segmenttemplate"in s&&"@_"in s.segmenttemplate&&u.push(s.segmenttemplate);let l={bitrate:M,content_type:void 0,mime_type:void 0,codecs:void 0,width:void 0,height:void 0,framerate:M},p=(g,A)=>{let d={...A};for(let _ of g){let m=_["@_"]??[];for(let y of Object.keys(m)){if(y==="@_bandwidth"){let v=m["@_bandwidth"];typeof v=="number"&&(d.bitrate=N(v))}if(y==="@_contenttype"){let v=m["@_contenttype"];typeof v=="string"&&(d.content_type=v)}if(y==="@_mimetype"){let v=m["@_mimetype"];typeof v=="string"&&(d.mime_type=v)}if(y==="@_codecs"){let v=m["@_codecs"];typeof v=="string"&&(d.codecs=v)}if(y==="@_width"){let v=m["@_width"];typeof v=="number"&&(d.width=v)}if(y==="@_height"){let v=m["@_height"];typeof v=="number"&&(d.height=v)}if(y==="@_framerate"){let v=m["@_framerate"];typeof v=="number"&&(d.framerate=N(v))}}}return d};l=p(u,l);let c=s.representation;if(!Array.isArray(c))break;for(let g of c){let A=o.toString();o++;let d=p([g],l),{codecs:_,mime_type:m,bitrate:y,width:v,height:T,framerate:h}=d,x=$("Invalid mimetype/codecs");if(typeof m=="string"&&typeof _=="string"){let B=`${m}; codecs="${_}"`;x=Xr(B)}if(x.isErr()){console.warn("Failed to parse mimetype from",m,_);continue}let{av_codecs:S,container:O}=x.unwrap(),D=gt(S,B=>({codec:dt(B),bitrate:y}),B=>{let q=He(B),Q=h,j=M,oe=M;return typeof v=="number"&&typeof T=="number"&&(oe=N(Nr(T)),j=N({width:v,height:T})),{codec:q,bitrate:y,fps:Q,dimensions:j,quality:oe}}),L={builder:"MPDParser",protocol:"dash",duration:n,container:le(O),av:D};a.push([L,A])}}return X(a)}var Xg,$g=I(()=>{"use strict";de();Fi();ft();mt();Ir();jn();Xg=wn(Wg(),1);Cr();Ve()});var $o,Qg=I(()=>{$o=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(i,n){this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push(n)},t.off=function(i,n){if(!this.listeners[i])return!1;var o=this.listeners[i].indexOf(n);return this.listeners[i]=this.listeners[i].slice(0),this.listeners[i].splice(o,1),o>-1},t.trigger=function(i){var n=this.listeners[i];if(n)if(arguments.length===2)for(var o=n.length,a=0;a<o;++a)n[a].call(this,arguments[1]);else for(var s=Array.prototype.slice.call(arguments,1),u=n.length,l=0;l<u;++l)n[l].apply(this,s)},t.dispose=function(){this.listeners={}},t.pipe=function(i){this.on("data",function(n){i.push(n)})},e}()});function Ht(){return Ht=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Ht.apply(this,arguments)}var Kg=I(()=>{});var Jg=f((YN,zg)=>{var Ui;typeof window<"u"?Ui=window:typeof global<"u"?Ui=global:typeof self<"u"?Ui=self:Ui={};zg.exports=Ui});function Yu(e){for(var t=PE(e),r=new Uint8Array(t.length),i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var Ju,PE,Yg=I(()=>{Ju=wn(Jg()),PE=function(t){return Ju.default.atob?Ju.default.atob(t):Buffer.from(t,"base64").toString("binary")}});var tl,ME,Zu,RE,xe,rl,DE,jt,el,Kr,Zg=I(()=>{Qg();Kg();Yg();tl=class extends $o{constructor(){super(),this.buffer=""}push(t){let r;for(this.buffer+=t,r=this.buffer.indexOf(`
`);r>-1;r=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,r)),this.buffer=this.buffer.substring(r+1)}},ME="	",Zu=function(e){let t=/([0-9.]*)?@?([0-9.]*)?/.exec(e||""),r={};return t[1]&&(r.length=parseInt(t[1],10)),t[2]&&(r.offset=parseInt(t[2],10)),r},RE=function(){let r="(?:"+"[^=]*"+")=(?:"+'"[^"]*"|[^,]*'+")";return new RegExp("(?:^|,)("+r+")")},xe=function(e){let t={};if(!e)return t;let r=e.split(RE()),i=r.length,n;for(;i--;)r[i]!==""&&(n=/([^=]*)=(.*)/.exec(r[i]).slice(1),n[0]=n[0].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^['"](.*)['"]$/g,"$1"),t[n[0]]=n[1]);return t},rl=class extends $o{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(t){let r,i;if(t=t.trim(),t.length===0)return;if(t[0]!=="#"){this.trigger("data",{type:"uri",uri:t});return}this.tagMappers.reduce((o,a)=>{let s=a(t);return s===t?o:o.concat([s])},[t]).forEach(o=>{for(let a=0;a<this.customParsers.length;a++)if(this.customParsers[a].call(this,o))return;if(o.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:o.slice(1)});return}if(o=o.replace("\r",""),r=/^#EXTM3U/.exec(o),r){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(r=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(o),r){i={type:"tag",tagType:"inf"},r[1]&&(i.duration=parseFloat(r[1])),r[2]&&(i.title=r[2]),this.trigger("data",i);return}if(r=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(o),r){i={type:"tag",tagType:"targetduration"},r[1]&&(i.duration=parseInt(r[1],10)),this.trigger("data",i);return}if(r=/^#EXT-X-VERSION:([0-9.]*)?/.exec(o),r){i={type:"tag",tagType:"version"},r[1]&&(i.version=parseInt(r[1],10)),this.trigger("data",i);return}if(r=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(o),r){i={type:"tag",tagType:"media-sequence"},r[1]&&(i.number=parseInt(r[1],10)),this.trigger("data",i);return}if(r=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(o),r){i={type:"tag",tagType:"discontinuity-sequence"},r[1]&&(i.number=parseInt(r[1],10)),this.trigger("data",i);return}if(r=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(o),r){i={type:"tag",tagType:"playlist-type"},r[1]&&(i.playlistType=r[1]),this.trigger("data",i);return}if(r=/^#EXT-X-BYTERANGE:(.*)?$/.exec(o),r){i=Ht(Zu(r[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",i);return}if(r=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(o),r){i={type:"tag",tagType:"allow-cache"},r[1]&&(i.allowed=!/NO/.test(r[1])),this.trigger("data",i);return}if(r=/^#EXT-X-MAP:(.*)$/.exec(o),r){if(i={type:"tag",tagType:"map"},r[1]){let a=xe(r[1]);a.URI&&(i.uri=a.URI),a.BYTERANGE&&(i.byterange=Zu(a.BYTERANGE))}this.trigger("data",i);return}if(r=/^#EXT-X-STREAM-INF:(.*)$/.exec(o),r){if(i={type:"tag",tagType:"stream-inf"},r[1]){if(i.attributes=xe(r[1]),i.attributes.RESOLUTION){let a=i.attributes.RESOLUTION.split("x"),s={};a[0]&&(s.width=parseInt(a[0],10)),a[1]&&(s.height=parseInt(a[1],10)),i.attributes.RESOLUTION=s}i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes["FRAME-RATE"]&&(i.attributes["FRAME-RATE"]=parseFloat(i.attributes["FRAME-RATE"])),i.attributes["PROGRAM-ID"]&&(i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10))}this.trigger("data",i);return}if(r=/^#EXT-X-MEDIA:(.*)$/.exec(o),r){i={type:"tag",tagType:"media"},r[1]&&(i.attributes=xe(r[1])),this.trigger("data",i);return}if(r=/^#EXT-X-ENDLIST/.exec(o),r){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(r=/^#EXT-X-DISCONTINUITY/.exec(o),r){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(r=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(o),r){i={type:"tag",tagType:"program-date-time"},r[1]&&(i.dateTimeString=r[1],i.dateTimeObject=new Date(r[1])),this.trigger("data",i);return}if(r=/^#EXT-X-KEY:(.*)$/.exec(o),r){i={type:"tag",tagType:"key"},r[1]&&(i.attributes=xe(r[1]),i.attributes.IV&&(i.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(i.attributes.IV=i.attributes.IV.substring(2)),i.attributes.IV=i.attributes.IV.match(/.{8}/g),i.attributes.IV[0]=parseInt(i.attributes.IV[0],16),i.attributes.IV[1]=parseInt(i.attributes.IV[1],16),i.attributes.IV[2]=parseInt(i.attributes.IV[2],16),i.attributes.IV[3]=parseInt(i.attributes.IV[3],16),i.attributes.IV=new Uint32Array(i.attributes.IV))),this.trigger("data",i);return}if(r=/^#EXT-X-START:(.*)$/.exec(o),r){i={type:"tag",tagType:"start"},r[1]&&(i.attributes=xe(r[1]),i.attributes["TIME-OFFSET"]=parseFloat(i.attributes["TIME-OFFSET"]),i.attributes.PRECISE=/YES/.test(i.attributes.PRECISE)),this.trigger("data",i);return}if(r=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(o),r){i={type:"tag",tagType:"cue-out-cont"},r[1]?i.data=r[1]:i.data="",this.trigger("data",i);return}if(r=/^#EXT-X-CUE-OUT:(.*)?$/.exec(o),r){i={type:"tag",tagType:"cue-out"},r[1]?i.data=r[1]:i.data="",this.trigger("data",i);return}if(r=/^#EXT-X-CUE-IN:(.*)?$/.exec(o),r){i={type:"tag",tagType:"cue-in"},r[1]?i.data=r[1]:i.data="",this.trigger("data",i);return}if(r=/^#EXT-X-SKIP:(.*)$/.exec(o),r&&r[1]){i={type:"tag",tagType:"skip"},i.attributes=xe(r[1]),i.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(i.attributes["SKIPPED-SEGMENTS"]=parseInt(i.attributes["SKIPPED-SEGMENTS"],10)),i.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(i.attributes["RECENTLY-REMOVED-DATERANGES"]=i.attributes["RECENTLY-REMOVED-DATERANGES"].split(ME)),this.trigger("data",i);return}if(r=/^#EXT-X-PART:(.*)$/.exec(o),r&&r[1]){i={type:"tag",tagType:"part"},i.attributes=xe(r[1]),["DURATION"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseFloat(i.attributes[a]))}),["INDEPENDENT","GAP"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=/YES/.test(i.attributes[a]))}),i.attributes.hasOwnProperty("BYTERANGE")&&(i.attributes.byterange=Zu(i.attributes.BYTERANGE)),this.trigger("data",i);return}if(r=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(o),r&&r[1]){i={type:"tag",tagType:"server-control"},i.attributes=xe(r[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseFloat(i.attributes[a]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=/YES/.test(i.attributes[a]))}),this.trigger("data",i);return}if(r=/^#EXT-X-PART-INF:(.*)$/.exec(o),r&&r[1]){i={type:"tag",tagType:"part-inf"},i.attributes=xe(r[1]),["PART-TARGET"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseFloat(i.attributes[a]))}),this.trigger("data",i);return}if(r=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(o),r&&r[1]){i={type:"tag",tagType:"preload-hint"},i.attributes=xe(r[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(a){if(i.attributes.hasOwnProperty(a)){i.attributes[a]=parseInt(i.attributes[a],10);let s=a==="BYTERANGE-LENGTH"?"length":"offset";i.attributes.byterange=i.attributes.byterange||{},i.attributes.byterange[s]=i.attributes[a],delete i.attributes[a]}}),this.trigger("data",i);return}if(r=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(o),r&&r[1]){i={type:"tag",tagType:"rendition-report"},i.attributes=xe(r[1]),["LAST-MSN","LAST-PART"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseInt(i.attributes[a],10))}),this.trigger("data",i);return}if(r=/^#EXT-X-DATERANGE:(.*)$/.exec(o),r&&r[1]){i={type:"tag",tagType:"daterange"},i.attributes=xe(r[1]),["ID","CLASS"].forEach(function(s){i.attributes.hasOwnProperty(s)&&(i.attributes[s]=String(i.attributes[s]))}),["START-DATE","END-DATE"].forEach(function(s){i.attributes.hasOwnProperty(s)&&(i.attributes[s]=new Date(i.attributes[s]))}),["DURATION","PLANNED-DURATION"].forEach(function(s){i.attributes.hasOwnProperty(s)&&(i.attributes[s]=parseFloat(i.attributes[s]))}),["END-ON-NEXT"].forEach(function(s){i.attributes.hasOwnProperty(s)&&(i.attributes[s]=/YES/i.test(i.attributes[s]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(s){i.attributes.hasOwnProperty(s)&&(i.attributes[s]=i.attributes[s].toString(16))});let a=/^X-([A-Z]+-)+[A-Z]+$/;for(let s in i.attributes){if(!a.test(s))continue;let u=/[0-9A-Fa-f]{6}/g.test(i.attributes[s]),l=/^\d+(\.\d+)?$/.test(i.attributes[s]);i.attributes[s]=u?i.attributes[s].toString(16):l?parseFloat(i.attributes[s]):String(i.attributes[s])}this.trigger("data",i);return}if(r=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(o),r){this.trigger("data",{type:"tag",tagType:"independent-segments"});return}if(r=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(o),r){i={type:"tag",tagType:"content-steering"},i.attributes=xe(r[1]),this.trigger("data",i);return}this.trigger("data",{type:"tag",data:o.slice(4)})})}addParser({expression:t,customType:r,dataParser:i,segment:n}){typeof i!="function"&&(i=o=>o),this.customParsers.push(o=>{if(t.exec(o))return this.trigger("data",{type:"custom",data:i(o),customType:r,segment:n}),!0})}addTagMapper({expression:t,map:r}){let i=n=>t.test(n)?r(n):n;this.tagMappers.push(i)}},DE=e=>e.toLowerCase().replace(/-(\w)/g,t=>t[1].toUpperCase()),jt=function(e){let t={};return Object.keys(e).forEach(function(r){t[DE(r)]=e[r]}),t},el=function(e){let{serverControl:t,targetDuration:r,partTargetDuration:i}=e;if(!t)return;let n="#EXT-X-SERVER-CONTROL",o="holdBack",a="partHoldBack",s=r&&r*3,u=i&&i*2;r&&!t.hasOwnProperty(o)&&(t[o]=s,this.trigger("info",{message:`${n} defaulting HOLD-BACK to targetDuration * 3 (${s}).`})),s&&t[o]<s&&(this.trigger("warn",{message:`${n} clamping HOLD-BACK (${t[o]}) to targetDuration * 3 (${s})`}),t[o]=s),i&&!t.hasOwnProperty(a)&&(t[a]=i*3,this.trigger("info",{message:`${n} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${t[a]}).`})),i&&t[a]<u&&(this.trigger("warn",{message:`${n} clamping PART-HOLD-BACK (${t[a]}) to partTargetDuration * 2 (${u}).`}),t[a]=u)},Kr=class extends $o{constructor(){super(),this.lineStream=new tl,this.parseStream=new rl,this.lineStream.pipe(this.parseStream),this.lastProgramDateTime=null;let t=this,r=[],i={},n,o,a=!1,s=function(){},u={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},l="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",p=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],segments:[]};let c=0,g=0,A={};this.on("end",()=>{i.uri||!i.parts&&!i.preloadHints||(!i.map&&n&&(i.map=n),!i.key&&o&&(i.key=o),!i.timeline&&typeof p=="number"&&(i.timeline=p),this.manifest.preloadSegment=i)}),this.parseStream.on("data",function(d){let _,m;({tag(){({version(){d.version&&(this.manifest.version=d.version)},"allow-cache"(){this.manifest.allowCache=d.allowed,"allowed"in d||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){let y={};"length"in d&&(i.byterange=y,y.length=d.length,"offset"in d||(d.offset=c)),"offset"in d&&(i.byterange=y,y.offset=d.offset),c=y.offset+y.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),d.title&&(i.title=d.title),d.duration>0&&(i.duration=d.duration),d.duration===0&&(i.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=r},key(){if(!d.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(d.attributes.METHOD==="NONE"){o=null;return}if(!d.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(d.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:d.attributes};return}if(d.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:d.attributes.URI};return}if(d.attributes.KEYFORMAT===l){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(d.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(d.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),d.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(d.attributes.KEYID&&d.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:d.attributes.KEYFORMAT,keyId:d.attributes.KEYID.substring(2)},pssh:Yu(d.attributes.URI.split(",")[1])};return}d.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),o={method:d.attributes.METHOD||"AES-128",uri:d.attributes.URI},typeof d.attributes.IV<"u"&&(o.iv=d.attributes.IV)},"media-sequence"(){if(!isFinite(d.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+d.number});return}this.manifest.mediaSequence=d.number},"discontinuity-sequence"(){if(!isFinite(d.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+d.number});return}this.manifest.discontinuitySequence=d.number,p=d.number},"playlist-type"(){if(!/VOD|EVENT/.test(d.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+d.playlist});return}this.manifest.playlistType=d.playlistType},map(){n={},d.uri&&(n.uri=d.uri),d.byterange&&(n.byterange=d.byterange),o&&(n.key=o)},"stream-inf"(){if(this.manifest.playlists=r,this.manifest.mediaGroups=this.manifest.mediaGroups||u,!d.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}i.attributes||(i.attributes={}),Ht(i.attributes,d.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||u,!(d.attributes&&d.attributes.TYPE&&d.attributes["GROUP-ID"]&&d.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}let y=this.manifest.mediaGroups[d.attributes.TYPE];y[d.attributes["GROUP-ID"]]=y[d.attributes["GROUP-ID"]]||{},_=y[d.attributes["GROUP-ID"]],m={default:/yes/i.test(d.attributes.DEFAULT)},m.default?m.autoselect=!0:m.autoselect=/yes/i.test(d.attributes.AUTOSELECT),d.attributes.LANGUAGE&&(m.language=d.attributes.LANGUAGE),d.attributes.URI&&(m.uri=d.attributes.URI),d.attributes["INSTREAM-ID"]&&(m.instreamId=d.attributes["INSTREAM-ID"]),d.attributes.CHARACTERISTICS&&(m.characteristics=d.attributes.CHARACTERISTICS),d.attributes.FORCED&&(m.forced=/yes/i.test(d.attributes.FORCED)),_[d.attributes.NAME]=m},discontinuity(){p+=1,i.discontinuity=!0,this.manifest.discontinuityStarts.push(r.length)},"program-date-time"(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=d.dateTimeString,this.manifest.dateTimeObject=d.dateTimeObject),i.dateTimeString=d.dateTimeString,i.dateTimeObject=d.dateTimeObject;let{lastProgramDateTime:y}=this;this.lastProgramDateTime=new Date(d.dateTimeString).getTime(),y===null&&this.manifest.segments.reduceRight((v,T)=>(T.programDateTime=v-T.duration*1e3,T.programDateTime),this.lastProgramDateTime)},targetduration(){if(!isFinite(d.duration)||d.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+d.duration});return}this.manifest.targetDuration=d.duration,el.call(this,this.manifest)},start(){if(!d.attributes||isNaN(d.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:d.attributes["TIME-OFFSET"],precise:d.attributes.PRECISE}},"cue-out"(){i.cueOut=d.data},"cue-out-cont"(){i.cueOutCont=d.data},"cue-in"(){i.cueIn=d.data},skip(){this.manifest.skip=jt(d.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",d.attributes,["SKIPPED-SEGMENTS"])},part(){a=!0;let y=this.manifest.segments.length,v=jt(d.attributes);i.parts=i.parts||[],i.parts.push(v),v.byterange&&(v.byterange.hasOwnProperty("offset")||(v.byterange.offset=g),g=v.byterange.offset+v.byterange.length);let T=i.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${T} for segment #${y}`,d.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((h,x)=>{h.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${x} lacks required attribute(s): LAST-PART`})})},"server-control"(){let y=this.manifest.serverControl=jt(d.attributes);y.hasOwnProperty("canBlockReload")||(y.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),el.call(this,this.manifest),y.canSkipDateranges&&!y.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){let y=this.manifest.segments.length,v=jt(d.attributes),T=v.type&&v.type==="PART";i.preloadHints=i.preloadHints||[],i.preloadHints.push(v),v.byterange&&(v.byterange.hasOwnProperty("offset")||(v.byterange.offset=T?g:0,T&&(g=v.byterange.offset+v.byterange.length)));let h=i.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${h} for segment #${y}`,d.attributes,["TYPE","URI"]),!!v.type)for(let x=0;x<i.preloadHints.length-1;x++){let S=i.preloadHints[x];S.type&&S.type===v.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${h} for segment #${y} has the same TYPE ${v.type} as preload hint #${x}`})}},"rendition-report"(){let y=jt(d.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(y);let v=this.manifest.renditionReports.length-1,T=["LAST-MSN","URI"];a&&T.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${v}`,d.attributes,T)},"part-inf"(){this.manifest.partInf=jt(d.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",d.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),el.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(jt(d.attributes));let y=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${y}`,d.attributes,["ID","START-DATE"]);let v=this.manifest.dateRanges[y];v.endDate&&v.startDate&&new Date(v.endDate)<new Date(v.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),v.duration&&v.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),v.plannedDuration&&v.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});let T=!!v.endOnNext;if(T&&!v.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),T&&(v.duration||v.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),v.duration&&v.endDate){let x=v.startDate.getTime()+v.duration*1e3;this.manifest.dateRanges[y].endDate=new Date(x)}if(!A[v.id])A[v.id]=v;else{for(let x in A[v.id])if(v[x]&&JSON.stringify(A[v.id][x])!==JSON.stringify(v[x])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}let h=this.manifest.dateRanges.findIndex(x=>x.id===v.id);this.manifest.dateRanges[h]=Ht(this.manifest.dateRanges[h],v),A[v.id]=Ht(A[v.id],v),this.manifest.dateRanges.pop()}},"independent-segments"(){this.manifest.independentSegments=!0},"content-steering"(){this.manifest.contentSteering=jt(d.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",d.attributes,["SERVER-URI"])}}[d.tagType]||s).call(t)},uri(){i.uri=d.uri,r.push(i),this.manifest.targetDuration&&!("duration"in i)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),i.duration=this.manifest.targetDuration),o&&(i.key=o),i.timeline=p,n&&(i.map=n),g=0,this.lastProgramDateTime!==null&&(i.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=i.duration*1e3),i={}},comment(){},custom(){d.segment?(i.custom=i.custom||{},i.custom[d.customType]=d.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[d.customType]=d.data)}})[d.type].call(t)})}warnOnMissingAttributes_(t,r,i){let n=[];i.forEach(function(o){r.hasOwnProperty(o)||n.push(o)}),n.length&&this.trigger("warn",{message:`${t} lacks required attribute(s): ${n.join(", ")}`})}push(t){this.lineStream.push(t)}end(){this.lineStream.push(`
`),this.manifest.dateRanges.length&&this.lastProgramDateTime===null&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(t){this.parseStream.addParser(t)}addTagMapper(t){this.parseStream.addTagMapper(t)}}});function il(e){let t=null;try{let i=new Kr;i.push(e),i.end(),t=i.manifest}catch{}if(!t&&Array.isArray(t.segments))return $("Parsing error");if(t.segments.some(i=>typeof i.duration!="number"))return $("Missing duration");let r=t.segments.reduce((i,n)=>(typeof n.duration=="number"&&(i+=n.duration),i),0);return X(r)}function eh(e){let t=null;try{let i=new Kr;i.push(e),i.end(),t=i.manifest}catch{}if(!t&&Array.isArray(t.segments))return $("Parsing error");let r=il(e).unwrapOr("unknown");return X({builder:"NakedHls",protocol:"hls",duration:r,container:le("Mp4"),av:{audio:!1,video:{codec:He("H264"),fps:M,dimensions:M,quality:M,bitrate:M}}})}function th(e,t){let r=null;try{let o=new Kr;o.push(e),o.end(),r=o.manifest}catch{}if(!r||!r.playlists)return $("Parsing error");let i=r.playlists,n=r.mediaGroups.AUDIO;return X(i.map(({uri:o,attributes:a})=>{let s=new URL(o,t).href,u=M;if(a.AUDIO&&n){let _=n[a.AUDIO]?.Default?.uri;if(!_){for(let m of Object.keys(n[a.AUDIO]??{}))if(_=n[a.AUDIO]?.[m]?.uri,_)break}_&&(u=N(new URL(_,t).href))}let l={audio:!1,video:"unknown"};a.CODECS&&(l=Fu(a.CODECS,M,M));let p=gt(l,_=>({codec:dt(_),bitrate:M}),_=>{let m=M,y=M,v=M,T=M;return a.BANDWIDTH&&(T=N(a.BANDWIDTH)),a["FRAME-RATE"]&&(m=N(a["FRAME-RATE"])),a.RESOLUTION&&(y=N(a.RESOLUTION),v=N(Nr(a.RESOLUTION.height))),{codec:He(_),bitrate:T,fps:m,dimensions:y,quality:v}}),g=u.isSome()?{audio:u.unwrap(),video:s}:p.video?{audio:!1,video:s}:{video:!1,audio:s},A=[le("Mp4"),le("WebM"),le("Mkv")];A=A.filter(_=>{if(p.video&&p.audio){let m=p.audio.codec.name,y=p.video.codec.name,v=!!_.supported_video_codecs.find(h=>h==y),T=!!_.supported_audio_codecs.find(h=>h==m);return v&&T}else if(p.video){let m=p.video.codec.name;return!!_.supported_video_codecs.find(y=>y==m)}else if(p.audio){let m=p.audio.codec.name;return!!_.supported_audio_codecs.find(y=>y==m)}return!1});let d=A[0]??le("Mkv");return[{builder:"Hls",protocol:"hls",duration:"unknown",av:p,container:d},g]}))}var rh=I(()=>{"use strict";de();Fi();ft();Cr();Ir();mt();Zg();Ve()});var al={};Z(al,{MasterHLSProbe:()=>Wi,MaybeCreateProbeFromNetworkRequest:()=>NE});function IE(e){let t=null,r=!1;for(let[n,o]of e)if(n.av.video===!1){let a=n.av.audio.bitrate.unwrapOr(0);t?t.bitrate<a&&(t={id:o,bitrate:a,audio:n.av.audio}):t={id:o,bitrate:a,audio:n.av.audio}}else r=!0;return!r||!t?e.map(([n,o])=>[n,o,M]):e.filter(([n,o])=>!!n.av.video).map(([n,o])=>{let a=M;return n.av.audio===!1&&(n.av.audio={...t.audio},a=N(t.id)),[n,o,a]})}function ol(e,t){let r={bulk:e.bulk,originalId:e.originalId,isPrivate:e.isPrivate,tabId:e.tabId,title:e.title,topUrl:e.topUrl,pageUrl:e.pageUrl,thumbnailUrl:e.thumbnailUrl,headers:e.headers,extension:t.av.video?t.container.extension:t.container.audio_only_extension,core_media:t};if(t.av.video&&(t.av.video.bitrate.isSome()&&(r.bitrate=t.av.video.bitrate.unwrap()),t.av.video.dimensions.isSome())){let i=t.av.video.dimensions.unwrap();r.size=`${i.width}x${i.height}`}return t.duration!="unknown"&&typeof t.duration=="number"&&(r.duration=t.duration),r}function ih(e,t){let r=t.find(i=>i.name=="Origin");return(r?.value?.includes("vimeo.com")||r?.value?.includes("vhx.tv"))&&e.includes("master.json")?e.replace("master.json","master.mpd"):e}function NE(e,t,r){return e.method!="GET"?null:(Array.isArray(r)||(r=[]),t=t?.toLowerCase()??"",Wi.canHandle(e.url,t,r)?new Wi(e.url,r):Ko.canHandle(e.url,t,r)?new Ko(e.url,r):null)}var nl,Qo,xt,Ko,Wi,sl=I(()=>{"use strict";de();$g();rh();nl=z(),Qo=(Ne(),P(Ie)),xt=(_e(),P(Ae));Ko=class{constructor(t,r){t=ih(t,r),this.mpd_url=t,this.headers=r}static canHandle(t,r,i){if(r.includes("application/dash+xml"))return!0;t=ih(t,i);try{if(new URL(t).pathname.endsWith(".mpd"))return!0}catch{}return!1}async onHitDataAvailable(t){let r=await xt.request({url:this.mpd_url,headers:this.headers});r.ok||console.warn("Failed to fetch MPD content");let i=await r.text(),n=Gg(i);if(n.isErr()){console.error("Failed to parse MPD",n.unwrapErr());return}let o=IE(n.unwrap());for(let[a,s,u]of o){let p={...ol(t,a),id:"dash:"+xt.hashHex(s),descrPrefix:nl._("dash_streaming"),chunked:"dash-adp",group:"grp-"+xt.hashHex(this.mpd_url),mpd_url:this.mpd_url};if(a.av.video!==!1){if(p.mpd_video_id=s,a.av.video.bitrate.isSome()&&(p.bitrate=a.av.video.bitrate.unwrap()),u.isSome()&&(p.mpd_audio_id=u.unwrap()),a.av.video.dimensions.isSome()){let c=a.av.video.dimensions.unwrap();p.size=`${c.width}x${c.height}`}a.duration!="unknown"&&typeof a.duration=="number"&&(p.duration=a.duration),Qo.dispatch("hit.new",p)}else p.mpd_audio_id=s,a.av.audio.bitrate.isSome()&&(p.bitrate=a.av.audio.bitrate.unwrap()),a.duration!="unknown"&&typeof a.duration=="number"&&(p.duration=a.duration),Qo.dispatch("hit.new",p)}}},Wi=class{constructor(t,r){this.m3u8_url=t,this.headers=r}static canHandle(t,r,i){return!!(t.includes(".m3u8")||r.includes("mpegurl"))}async onHitDataAvailable(t){let r=await xt.request({url:this.m3u8_url,headers:this.headers});if(!r.ok){console.warn("Failed to fetch M3U8 content");return}let i=await r.text(),n=th(i,this.m3u8_url);if(n.isErr()){let a=eh(i);if(a.isErr()){console.warn("can't parse M3U8");return}let s=a.unwrap(),l={...ol(t,s),id:"nakedhls:"+xt.hashHex(this.m3u8_url),descrPrefix:nl._("hls_streaming"),chunked:"hls",group:"grp-"+xt.hashHex(this.m3u8_url),mediaManifest:this.m3u8_url};Qo.dispatch("hit.new",l);return}let o=n.unwrap();{let a=o.as_iter().find(([,s])=>!!s.video).map(([,s])=>s.video);if(a.isSome()){let s=a.unwrap(),u=await xt.request({url:s,headers:this.headers});if(!u.ok){console.warn("Failed to fetch M3U8 content");return}let l=await u.text(),p=il(l);if(p.isOk())for(let[c]of o)c.duration=p.unwrap()}}for(let[a,s]of o){let u=ol(t,a),l="";s.audio&&(l+=s.audio),s.video&&(l+=s.video);let p={...u,id:"hls:"+xt.hashHex(l),descrPrefix:nl._("hls_streaming"),chunked:"hls",group:"grp-"+xt.hashHex(this.m3u8_url+a.container.name),masterManifest:this.m3u8_url};!s.audio&&s.video?p.mediaManifest=s.video:!s.video&&s.audio?p.mediaManifest=s.audio:s.video&&s.audio&&(p.audioMediaManifest=s.audio,p.videoMediaManifest=s.video),Qo.dispatch("hit.new",p)}}}});var lh={};Z(lh,{default:()=>UE,forbidden:()=>uh,matchHit:()=>sh});async function jE(e){let t={id:"tbvws:"+e.videoId,group:"tbvws:"+e.videoId,isPrivate:e.isPrivate,tabId:e.tabId,title:e.title,from:"tbvws",videoId:e.videoId,topUrl:e.topUrl,pageUrl:e.pageUrl,thumbnailUrl:e.thumbnailUrl&&e.videoDetails.thumbnail?.thumbnails[0]?.url,duration:parseInt(e.videoDetails.lengthSeconds)||void 0,headers:[],baseJs:e.baseJs,bulk:e.bulk};e.hlsManifestUrl&&new BE(e.hlsManifestUrl,{}).onHitDataAvailable(t);let r=e.adaptiveFormats,i=e.formats,n=r.as_iter().filter(A=>typeof A.url=="string").map(A=>({result:Vu(A,"dash"),json:A})).toArray(),o=i.as_iter().filter(A=>typeof A.url=="string").map(A=>({result:Vu(A,"non-adaptative"),json:A})).toArray(),a=[...n,...o];a.forEach(({result:A,json:d})=>{A.isErr()&&console.warn("tbvws JSON parsing error",A.unwrapErr(),d)});let s=a.as_iter().filterMap(({result:A,json:d})=>A.toOption().map(_=>({core_media:_,url:d.url}))).toArray(),u=s.as_iter().filter(({core_media:A})=>!!A.av.audio&&!!A.av.video).map(A=>A).toArray(),l=s.as_iter().filter(({core_media:A})=>!A.av.audio).map(A=>A).toArray(),p=s.as_iter().filter(({core_media:A})=>!A.av.video).map(A=>A).sort((A,d)=>{if(A.core_media.av.audio&&d.core_media.av.audio){let _=A.core_media.av.audio.bitrate.unwrapOr(0),m=d.core_media.av.audio.bitrate.unwrapOr(0);return _-m}else throw"unreachable"}),c=[];for(let A of l){let d=p.as_iter().filter(_=>_.core_media.container.name==A.core_media.container.name).toArray();if(d.length>0){let _=d[0],m={...A,core_media:{...A.core_media,av:{video:A.core_media.av.video,audio:_.core_media.av.audio}},videoUrl:A.url,audioUrl:_.url};delete m.url,c.push(m)}}[...u,...c].as_iter().map(({core_media:A,...d})=>{let _=A.av.video,m={...t,...d,extension:A.container.extension,videoCodec:_.codec.name,audioCodec:A.av.audio.codec.name,core_media:A};if(_.quality.isSome()&&(m.quality=_.quality.unwrap()+"p"),_.fps.isSome()&&(m.fps=_.fps.unwrap()),_.dimensions.isSome()){let y=_.dimensions.unwrap();m.size=`${y.width}x${y.height}`}return m}).toArray().forEach(A=>{CE.dispatch("hit.new",A)})}function LE(){return oh.isProbablyAvailable()&&oh.isAtLeastVersion("2.0.0")}function sh(e){return![e.url,e.audioUrl,e.videoUrl,e.pageUrl,e.topUrl].every(t=>t?!ah.test(t)&&!HE.test(t):!0)}async function uh(){let e=Et._("chrome_noyt_text"),t=zo.hash(e),r=Et._("chrome_noyt_text3"),i=zo.hash(r),n=r;i==-1960581238&&t!=-1126813505&&(n=e);try{switch((await kE.alert({title:Et._("chrome_warning_yt"),text:[n,Et._("chrome_noyt_text2")],height:400,buttons:[{text:Et._("chrome_install_firefox"),className:"btn-outline-secondary",close:!0,trigger:{what:"installFirefox"}},{text:Et._("chrome_install_fx_vdh"),className:"btn-outline-primary",close:!0,trigger:{what:"vdhForFirefox"}}]})).what){case"installFirefox":return nh.gotoOrOpenTab("https://getfirefox.com/");case"vdhForFirefox":return nh.gotoOrOpenTab("https://addons.mozilla.org/firefox/addon/video-downloadhelper/")}}catch(o){console.error("tbvws error",o)}}var Et,ul,CE,qE,zo,nh,kE,oh,BE,FE,VE,HE,ah,UE,ch=I(()=>{"use strict";lg();Et=z(),ul=Et.browser,CE=(Ne(),P(Ie)),qE=($r(),P(Gr)),zo=(_e(),P(Ae)),nh=(Ft(),P(Bt)),kE=(Hi(),P(Vi)),oh=(hr(),P(gr)),{MasterHLSProbe:BE}=(sl(),P(al)),FE="youtube",VE=new RegExp("^https?://([^/]*\\.)?youtube(?:\\-nocookie)?(\\.co)?.([^./]+)/"),HE=new RegExp("^https?://([^/]*.)?googlevideo\\."),ah=new RegExp("^https?://([^/]*\\.)?youtube(\\.co)?.([^./]+)/.*");Et.rpc.listen({tbvwsDetectedVideo:async e=>{try{await jE(e)}catch(t){console.error("VDH error: detectedVideo",t)}}});ul.webNavigation.onCompleted.addListener(async function(e){let t=await Et.prefs,r={tabId:e.tabId,frameIds:[e.frameId]};if(VE.test(e.url))try{let i=await ul.tabs.get(e.tabId);zo.executeScriptWithGlobal(r,{_$vdhData:{...r,isPrivate:!1},_$vdhSmartNameSpecs:await qE.getSpecs(e.url),_$vdhTopUrl:i.url,_$vdhExtractMethod:t.tbvwsExtractionMethod,_$vdhSupportChallenge:LE()},"/injected/tbvws.js")}catch(i){console.error("Cannot find tab",i)}if(t.bulkEnabled&&ah.test(e.url))try{let i=await ul.tabs.get(e.tabId);zo.executeScriptWithGlobal(r,{_$vdhTopUrl:i.url},"/injected/tbvws-bulk.js")}catch(i){console.error("VDH error: could not inject bulk script",i)}},{url:[{hostContains:FE}]});UE={matchHit:sh,forbidden:uh}});var ph={};Z(ph,{BulkDownload:()=>GE});async function GE(e,t){let r=new Set;for(let i of e.bulk_ids){let n=`https://www.${XE}.com/watch?v=${i}&vdh-bulk=1`,o=await Yo.tabs.create({url:n,active:!1});await Yo.tabs.update(o.id,{muted:!0}),r.add(o.id)}for(let i=0;i<60;i++){let n=await Zo.getSerializedHits();for(let o of n){let a=o[0];for(let s of r){let u=a.tabId==s,l=!!a.masterManifest,p=a.extension=="mp4";if(u&&l&&p){r.delete(a.tabId),WE.execute(t,a.id),Yo.tabs.remove(a.tabId);break}}}if(r.size==0){console.log("All hits were found and downloaded");break}await new Promise(o=>setTimeout(o,1e3))}}var Jo,Yo,Zo,WE,XE,dh=I(()=>{"use strict";mt();Oi();Jo=z(),Yo=Jo.browser,Zo=(Ne(),P(Ie)),WE=(Gi(),P(Xi)),XE="youtube";Jo.rpc.listen({tbvwsSelectedIds:e=>{let t=[],{flat:r}=Zo.getHits();for(let i of r.values())i.from=="tbvws-bulk"&&i.topUrl==e.topUrl&&!i.running&&t.push(i.id);if(t.length>0&&Zo.dispatch("hit.delete",t),e.ids.length>0){let i="tbvws-bulk:"+Math.floor(Math.random()*1e9),n={id:i,group:i,title:Jo._("selected_media"),descrPrefix:Jo._("bulk_n_videos",""+e.ids.length),from:"tbvws-bulk",bulk_ids:e.ids,pageUrl:e.pageUrl,topUrl:e.topUrl,thumbnailUrl:Yo.runtime.getURL("/content/images/tbvws.png"),core_media:{builder:"YoutubeBulk",protocol:"unknown",duration:"unknown",container:le("Mp4"),av:Hn()}};Zo.dispatch("hit.new",n)}}})});var Jr={};Z(Jr,{alertAudioNeedsReg:()=>JE,checkLicense:()=>gh,setLicense:()=>hh,validateLicense:()=>dl});function KE(e){return e&&e.substring(0,1).toUpperCase()+e.substring(1)||""}function mh(e,t){let r=new TextEncoder("utf-8").encode(t+e.key+e.email);return crypto.subtle.digest("SHA-256",r).then(i=>cl.bufferToHex(i))}async function dl(e){let t=await fh.check();if(!t.status)return{key:e,last:Date.now(),status:"nocoapp"};let r=t.info.home,i;try{i=await cl.request({url:"https://www.downloadhelper.net/license-check.json",content:"key="+encodeURIComponent(e)+"&product=converthelper",headers:{"Content-type":"application/x-www-form-urlencoded"},method:"POST"})}catch{throw new Error(yr._("network_error_no_response"))}if(!i.ok)throw new Error(yr._("network_error_status",i.status+" "+i.statusText));let n=await i.json(),o={key:e,last:Date.now(),remoteStatus:n.status,status:n.status,name:n.name,email:n.email},a=KE(zr);if((n.target=="fx"||n.target=="firefox")&&zr!="firefox"?(o.status="mismatch",o.brExt=a,o.brLicense="Firefox"):n.target=="edge"&&zr!="edge"?(o.status="mismatch",o.brExt=a,o.brLicense="Edge"):(n.target=="crx"||n.target=="chrome")&&zr!="chrome"&&(o.status="mismatch",o.brExt=a,o.brLicense="Chrome"),o.status=="accepted"){let s=await mh(o,r);o.sign=s}return await pl.set(o),o}function gh(){return new Promise((e,t)=>{ll.runtime.getPlatformInfo().then(r=>{if(r.os=="linux"&&!QE)return e({status:"unneeded"});zE().then(i=>{if(i===null)return e({status:"unset"});let n={status:"unset"};if(i.email&&(n.email=i.email),i.key&&(n.key=i.key),i.name&&(n.name=i.name),i.status=="mismatch")return n.status="mismatch",n.brLicense=i.brLicense,n.brExt=i.brExt,e(n);fh.check().then(o=>o.status?mh(i,o.info.home):(n.status="nocoapp",e(n),null)).then(o=>{if(o)return!i.remoteStatus&&n.key?new Promise((a,s)=>{dl(n.key).then(u=>{i=u,a(o)}).catch(u=>{s(u)})}):o}).then(o=>{o&&(i.remoteStatus=="accepted"&&o===i.sign?n.status="accepted":i.remoteStatus=="blocked"?n.status="blocked":i.remoteStatus=="locked"&&(n.status="locked"),e(n))}).catch(t)}).catch(t)}).catch(t)})}function hh(e){return pl.set(e)}function JE(){$E.alert({title:yr._("converter_needs_reg"),text:yr._("converter_reg_audio"),buttons:[{text:yr._("get_conversion_license"),className:"btn-success",rpcMethod:"goto",rpcArgs:["https://www.downloadhelper.net/convert"+(zr?"?browser="+encodeURIComponent(zr):"")]}]})}var yr,ll,fh,cl,$E,zr,QE,pl,zE,Yr=I(()=>{"use strict";yr=z(),ll=yr.browser,fh=(hr(),P(gr)),cl=(_e(),P(Ae)),$E=(Hi(),P(Vi)),{browser:zr,linuxlic:QE}=Jt().buildOptions;pl=new cl.Cache(()=>ll.storage.local.get("license").then(e=>e.license||null),e=>ll.storage.local.set({license:e}));zE=pl.get();yr.rpc.listen({checkLicense:gh,validateLicense:dl,setLicense:hh})});var yh,vh=I(()=>{"use strict";yh="R0lGODlhNgE2AaEAAAAAAP///wAAAAAAACH5BAEKAAIALAAAAAA2ATYBAAL+jI+py+0Po5y02ouz3rz7D4biSJbmiabqyrbuC8fyTNf2jef6zvf+DwwKh8Si8YhMKpfMpvMJjUqn1KrVAshqt9yu9wsOi8dZCDncO4PN6rb7Td7A5/Q5m56u3+v8/lfuFygIsAeXh/cwqMgHuOjoVvh2aJf4aHnWeKn5V4m4w9i5KbqVOToaCckD6mDaSqjhaoraNmkYGntZivs4q1YrebvrqCus2IupqhdcPEjMHHgcl+zZ8MwLa70YPfabypptjL3WTXr1IuaDLs45zW7Oot7u5ayVjvbeEv95n6Gv448PBUAcAykUtHEw4IiENBhGszdOYQqHMih+i7gPo0T+ExZhdGTw0UXIjRhGwuNXEuU/lSQXsiT40mBMhDNbejC5AucBnRNr2uTAU6DPh+Tq/SQR9ERQh7mWlbvo7oImp76olrHah2i/oU2hzsNKD5pXYGO5bFNW9mlKjQu6VuM6FGvWtFXpXrU7F2/YV3hXvWWrYKnbtmj/RiV8Te+6r30Lg4QLWKYluUwhDwO7uMtZao8jIxA8ubFlxoa1Yd7qeWdoxazXJu5MqTVs07KxjA5XO3Bc0Zx19/Z9GDjt0pozm6X8O0Hl1BGm8g6u/Haz065Jz8ZN/Hhuya8Rx86u9vr07ROWXyavmvnm5Om/iw/vffh7o6ihf14Nnn5+ZPv+71bHPp9/AebV317r2YKeAX7FZ51t3TGoXX8LQghfBebJR6F+A3LT114TClfcc2QVaFyF0T0IYoQbMsRhfRimaOJ9KJ5onwQXApihgDlKI6GHju144IgDGoice0AWWWMALf43HokieuMkkzG29yKNDcJY14Y+skdliBL+iKWOFkoniFZf+rSkVPgNiaSQR7ro5YpcKkhmljvyJaVYCSq55pt5imkljmHiKSdzaTp4XpSFIqgoolcG2iSbT6o4KKGOCgrplHTOKGOSZi7q5qBBxlnplkaK2iaUkv5paaVgZqrhnYNdGqmfoKpqK62a8slpl5S62ueYvW7q6ayowvn+K6x+fCprsNxV2emj0WI6bbLl1bksdbfWKmyiq25rZ67dSutrmdo2O+yotJwL7KnKtvosqe0y+i263uqqZ6PzhvoukZOGe+yZ6aa67p7G9ltirPviGjC4+aqZ7o3cIozsrgdXa7EwptIr7rsfUsyqugCD7HC2FT/cMcYoN4wvoCqbrK/HF9vo7Mvw2vyxzf5m5KlcO9fLctA3gNZzDEQXHbPO7JKcw9HyDr1bjwm7XK7CTAtNk3pLZ420llPfXDXVxJI79tNck80sTFp3+HXaV799ttk0r+1R1F6fLDavxWILdkN2p1yD03I3x7fbSsszuOGB/11q21uH3bfeaFf+xDjci9N9d8iPl20t5BB1DbjfmN/5c+iSJ54UR5UfzvPkbOMducQZj57P6p4XlbfPjhtcOO6REwxO77yrJ7vVOAdfMKvIJw+05ZzPvjfxy8MM8fSvst489qYXb/3I13Y/5+mdP2/87cNHDz7H46bP/PbCJ22+wOyPLzL7ipOfN/ex8z0/6Av3fz/xQQ9t+qtf+jbWv/y9L3vxYyD+Eug6+UEwgAXcnADL90AI0g949rNgBc9HQA3yR3kiVKD0Toi+EKKwhLQ7CuHQlDqpuXCGqoOh7V7YQhrqEIdJOhQIfLjDIMKub0C8SQyFGMQiZrCGOUSiE5f4Opfc8IlCVOL+BTHoISpqMV6Ds2IWtwhG3clQik0MIw2t6MWv/c6MT0TjEUnHxjhCjohvbJwc/7UyLg4wcZQr4xVzh0cewY+Hrigd1i7nP48hkGHOMyCBqqfCROZkimkMpBcFJ4vdDXIGmNwVBwXpQEfmbG4p5KPRKNlJ6pnuk49s2f78qBRUyvJehyRkKwzZyD5Kco6LbF8tRXk9UkYygueY5S4zGMwH9tJcsAugLokJxyEm84/LzOP3SrnBU/qxkhJkpPbWd0tNhvKZphwjJKnVQFe6sWbInCYToSVMaIIzmyS04bCcU7eBRVEE3DynN9s5J3wWU5/mDEE/1cmimf2xlSchaOb++FlHmdmTlsdzZwkUuo13ylOP3gOou+Y4SqE4NJpkPKYjWbnOkRqUnbakpz9ditCJwnOhIY2lShV50YhW1FAKFahIWJrRnE6RlShNKFA1OrFrmlSMJeUXSJPp09rdFGdIhek8O0pTqGK0qtaMZzlf6snWOTWdQzjoL2taxWnqVAVmbSRak6jWoWpzm/xbqxVqaleR0nWFY3UiXuWaz71i05da/Css52pS/bX1KIZdKmI3+k2JHlYijYUsIhNbV8AqpLJfbVoqX/nRNsZ1sgMV7DD7ikTOWhVqxkSdRaOwWLJyFItqLAZRi0paiLZ2tVQV6vRua8m8frGZauSqNYD+203CXtayyiyub5eH3JLFVq+YNS1zgclS1TJzJbsNa0F/2L3o2gu1j+3sL5mq299aEruORcpnh9vU4In3f1glp3lzuc+VWm++klVf3O4bWaVeF7f3HC1Flwtg2Qo4wS3NBn936l8E81bBXp1wg4+7XgIPWJzpnWlWearZn/KVflvdUzVBOd4uCte4oD1tUitM29qGL6TT5eQCU6xcGANSmjPWaoilOlgslniTJ76kj3MLZBfv8cUXXiOPQ+tRstXYvkuuclebbNMDPxXESG5okE2oZSyzWLtYnXJ5rQxmD1uwyIo1apcnOWI0M3S2Tq4nlD/cwxU/17VxvrIzZXz+Zxrr2b19TjM6bSxTBuN5pmR+RpY3TGguVxcXD95yLB6t6DGjN6YF7rF692xhTKu4u6fIcHCPymHWSvq6tjV1cksNau+KeNWKbvWrhbxfFvuOjqQWRaWjHM5Yx7i0ee71Jn696GBHGtLxHV+NbS1d9qo51f919mej2l8lY1jYO551sa2rbBzLGdrNHra3pXztnhoYeaKWNaeh3OgW8/nLdRY3rguNYjh3OtA3PquxjYxvM9sZ3uuet7YNHep4nzSwYVa4B/tNZ4DTW+BgvbLDQWjwWhecxK/tMKM3LmcK/vuDt+62fvcdYQo3F+MJB/m978xtVWY74xzH959LLu/+msN82R/3NL1FDu4crxznZ96uvREe8ocHvb5t/nHEBe3zg+c86U/+ObKpDeGeU/rqJs4vTokLdpxDfeuurni97fhQV+Iy64cm99HPjt/v9jbsZpd2X91OX3Ov0utz1xzd3z72S3OdyHznJdZ1PHVYSzfez/73pq9qcn/vQsOofSvh5W74v0M+8b4+ddTJ23XMQ1HzdLb7P5PNZNS7+7yFH73fX7/4Iwu+7Gp3rujFTHq2MxnvM2/50jHY+N9z/tie53f41tz6ha69J28OsMqDynMWFrLokd/8zdMOXulPnvpwLz3yb89m7R8/5u1+OavzKv7tMzzTSp90e2OfftD+R3/11v8+9j8Q/9kTm/0sp3/fPZ5/2KZvzBZK1zZmAZh6uqaAoXd/RoSAnbd+oQZ07keAefeAp1d+1ed9DEhSAHiB0wZXEdNxe5d7Dvh+mwVUljdOh9cBgwZbKTiCrFeCLeh074BRKkiCsOeBendGMDh+l6eDJ1eB+HCDMRh3QZh9JxgQRfiDKziDQFGD5sCEOweEdbeAbDSFKYd788eD9RdHWSh/ToiE+BeFVwCGGGh/Vkh+cnSGQnd9asiFGmhpE3SATQiHBZhrVUeHMYeDtdd/2zZwexiHc0aGNkd5CVh87FaHVDiGzxdegKZBGUiIJih1pmd07yaI5SZzSVj+iYd4iZsnfZLYh164SY+ohwkkika4gaWYh4GIiouohVBoiIl4aJYIiJo4iTQ4i2KHarz4aYM4iquIh794h57VfJTIf1Xoh8pzhdylhEKYjGJYjKDYjMb4jJwYjTk4jRFXjWpzjYX4jc+3fE3WfYj3OUOIjRKYhstoduW4hc6IjuAYj+LIgtCHi+eYjdCojhzIjurUjao2j7oYjkN3j7ZXkIizj4MoiQtpkDsoh8w3kLIYkcJlgGuIkP7HVmVIkA7pjspnkWKVkAepkP+4YCEpeWFGTdyXi7a4iSWJke8IeBCXkb0Ifyj5ePJIc594hBy5kp7oZzeJjDrnYS4YkyP+p37M+JE12YkRiIi+aJPJN46qN0LSqI9NqZS1CJQCKXUXt39YSYtW2YFVaX61SJQWmG9Pd5TtSJJziIFl2Xtu6JMtiXgd2X5DqZEs+ZBSSXxDtJbA5oZuqXtw+ZU66ZJdWJjDx5VUCYrq9nlC6ZWsKIK7iIsCyJaOaZmEaY5xOXxviIlt53JI95N/KJcbKYOuuHufiZiq6Ig+aHV8yJjGN3GqSZpvOZXuc4x+iZl6uZmaGZVtOJYmaZaBV3mZxYi2iZIkN5mvGYtNV5wnaZeSyZPKOZwBJ5spOZi/SXXAKJ1tSZyxWJdkKZNBmUlE951g6ZzgCZ1iCYHRVp65OYH+zxmbrViUF9iXuomc86l/+ImA9emboNlBTvmA/MmaW2mKVxmAAhqZ8UmMwfmBdCmaK8mc0HWd6Yegx9mdigig+5mU+nmZ2Dk/mql9FQqfBCqfDPqBIoqeCiqhGXqgG2qircmi42mg+VefVOah/umgTPmS1qmM6bijDPmgSRB8MHpuwOmjN7qbRzCkS9mVP4qiHZqXNmqYq3mbnOllTKqY1baj93ml+XikOGqlWjqls+l81OWlOAmlSWoES5qTYyqRAfmmbQqmSMCmaSqlOTqSQUqn77WOX4qnIjmMEalp9QiY9Kijc8qPAHl+6TmAZyqeSBqmEral4WmmNNqnwqimjWjHoTLajiwUqZmZqP/3ovnZmQB0qYf5qR4Zo4rXqSWUqu+pcYlmqqc4qz2KqaUZlrTpaJCYiZlKilmaeTPKqqX6oacKqrYarJs6rIvpqsYKk7iqqaM6fbRarKGKqs6aUpHIq69orccKrK6nrOvZqiL0qu3pptnaq3ekruvKru3qru8Kr/Eqr/NKr/Vqr/eKr/mqr/vKr/3qr/8KsAErsANLsPZaAAA7"});var $i={};Z($i,{convert2:()=>iT,getCodecs:()=>xh,getFormats:()=>wh,getOutputConfigs:()=>vl,info:()=>ZE,makeUniqueFileName:()=>rT,open:()=>tT,play:()=>eT,resetOutputConfigs:()=>_h,setOutputConfigs:()=>Ah,sideDownload:()=>sT,sideDownloadAbort:()=>oT,sideDownloadMPD:()=>aT,updateHit:()=>YE});function YE(e){console.warn("TODO converter.updateHit")}function ml(e){(e||[]).forEach(t=>{t.name=="Accept-Encoding"&&(t.value=t.value.split(",").map(r=>r.trim()).filter(r=>r!="br").join(", "))})}function ZE(e,t=!1,r=[]){ml(r);let i=pe.call("probe",e,t,r);return t?i.then(n=>JSON.parse(n)):i}function eT(e){return pe.call("play",e)}function tT(e){return pe.call("open",e)}function rT(e){return pe.call("makeUniqueFileName",e)}async function iT(e,t,r,i){let n=[];n.push("-i",e);let o=ta[t];for(let p in o.params){let c=o.params[p];c!==null&&(typeof c!="string"||c.length>0)&&(n.push("-"+p),n.push(""+c))}if(o.extra){let p=/^\s*(.*?)\s*$/.exec(o.extra)[1].split(/\s+/);for(let c of p)n.push(c)}o.audioonly&&n.push("-vn");let a=e.split(".");a[a.length-1]=o.ext;let s=a.join(".");n.push("-y",s);let u=++gl;ra[u]=r;let l=++hl;vr[l]=i;try{let p=await pe.call("convert",n,{progressTime:""+u,startHandler:""+l});if(p.exitCode!=0)throw new ea.DetailsError("Convert2 error: ",p.stderr);return s}finally{delete u[u],delete vr[l]}}function Ah(e){return yl.set(Object.assign({},ta,e))}function _h(){return vl().then(e=>{let t=Object.assign({},e);return Object.keys(t).forEach(r=>{t[r].readonly||delete t[r]}),yl.set(t)})}function wh(){return pe.call("formats")}function xh(){return pe.call("codecs")}function nT(e,t,r){let i=ra[e];i&&i(t,r)}function oT(e){return pe.call("abortConvert",e)}async function aT(e,t,r,i){let n=[];ml(i.headers),i.headers&&i.headers.length&&(n.push("-headers"),n.push(i.headers.map(s=>s.name+": "+s.value).join(`\r
`)+`\r
`)),n.push("-i",e),t&&n.push("-map",`0:${t}`),r&&n.push("-map",`0:${r}`),t&&n.push("-codec","copy"),n.push("-y"),n.push(i.filePath);let o=++gl;ra[o]=i.on_progress;let a=++hl;vr[a]=i.on_start;try{let s=await pe.call("convert",n,{progressTime:""+o,startHandler:""+a});if(s.exitCode!=0)throw new ea.DetailsError("SideDownload error: ",s.stderr)}finally{delete o[o],delete vr[a]}}async function sT(e,t,r){let i=[],n;if(r.qr_code_needed){let{path:s,fd:u}=await pe.call("tmp.file",{prefix:"vdh-wm-",postfix:".gif"});await pe.call("fs.write2",u,yh),await pe.call("fs.close",u),n=s}if(r.qr_code_needed&&i.push("-i",n),r.headers&&r.headers.length>0){ml(r.headers);let s=r.headers.map(u=>`${u.name}: ${u.value}\r
`).join("")+`\r
`;i.push("-headers"),i.push(s)}if(e&&i.push("-i",e),t&&i.push("-i",t),r.qr_code_needed&&e){i.push("-filter_complex","[0][1]scale2ref=w=oh*mdar:h=ih*0.4[logo][video];[video][logo]overlay=5:H-h-5");let s="h264";r.filePath.endsWith("webm")&&(s="libvpx-vp9"),i.push(...`-c:v ${s} -preset superfast`.split(" "))}else r.merge&&i.push("-map","0:v:0","-map","1:a:0"),e&&i.push("-c","copy");i.push("-y",r.filePath);let o=++gl;ra[o]=r.on_progress;let a=++hl;vr[a]=r.on_start;try{let s=await pe.call("convert",i,{progressTime:""+o,startHandler:""+a});if(s.exitCode!=0)throw new ea.DetailsError("SideDownload error: ",s.stderr)}finally{if(n)try{await pe.call("fs.unlink",n)}catch{}delete o[o],delete vr[a]}}function uT(e,t){let r=vr[e];if(r)try{r(t)}catch(i){console.error("start handler error",i)}}var fl,bh,pe,ea,ta,gl,ra,hl,vr,yl,vl,Qi=I(()=>{"use strict";vh();fl=z(),bh=fl.browser,pe=(hr(),P(gr)),ea=(_e(),P(Ae));gl=0,ra={},hl=0,vr={};yl=new ea.Cache(()=>bh.storage.local.get("outputConfigs").then(e=>e.outputConfigs||ta),e=>bh.storage.local.set({outputConfigs:e})),vl=yl.get();fl.rpc.listen({getOutputConfigs:vl,setOutputConfigs:Ah,resetOutputConfigs:_h,editConverterConfigs:e=>{fl.ui.open("convoutput"+(e?"#"+e:""),{type:"tab",url:"content/convoutput.html"})},getFormats:wh,getCodecs:xh,convertStartNotification:uT});pe.listen({convertOutput:nT});ta={"e6587753-4ca5-4d2e-b7ba-beaf1e7f191c":{title:"Re-encoded MP4 (h264/aac)",ext:"mp4",params:{"c:a":"aac",f:"mp4","c:v":"h264"},audioonly:!1,readonly:!0},"249a7d34-3640-4ac3-8300-13827811d2cf":{title:"MPEG (mpeg1+mp2)",ext:"mpg",params:{"c:a":"mp2",f:"mpeg",r:24,"c:v":"mpeg1video"},extra:"-mbd rd -trellis 2 -cmp 2 -subcmp 2 -g 100",audioonly:!1,readonly:!0},"6de4f5ce-8cfe-4f0f-8246-bacb7b0d7624":{title:"WMV 500Kb (Windows Media Player)",ext:"wmv",params:{"c:a":"wmav2",f:"asf","c:v":"wmv2","b:v":"500k"},extra:null,audioonly:!1,readonly:!0},"21a19146-e116-4460-8356-a8eab9cf61ce":{title:"WMV 1Mb (Windows Media Player)",ext:"wmv",params:{"c:a":"wmav2",f:"asf","c:v":"wmv2","b:v":"1000k"},extra:null,audioonly:!1,readonly:!0},"933b1b41-6862-4ce0-9605-10fa5e4b310c":{title:"WMV 2Mb (Windows Media Player)",ext:"wmv",params:{"c:a":"wmav2",f:"asf","c:v":"wmv2","b:v":"2000k"},extra:null,audioonly:!1,readonly:!0},"90195ab2-d891-443c-a164-8f0953ec8975":{title:"WMV 4Mb (Windows Media Player)",ext:"wmv",params:{"c:a":"wmav2",f:"asf","c:v":"wmv2","b:v":"4000k"},extra:null,audioonly:!1,readonly:!0},"3a4cc0a6-6eb0-4cff-90fb-fdf8eb6a9571":{title:"AVI 500Kb (mpeg4/mp3)",ext:"avi",params:{"c:a":"mp3",f:"avi","c:v":"mpeg4","b:v":"500k","b:a":"128k"},extra:null,audioonly:!1,readonly:!0},"ebdbb895-7a1e-43e2-bef4-be6e62cb8507":{title:"AVI 1Mb (mpeg4/mp3)",ext:"avi",params:{"c:a":"mp3",f:"avi","c:v":"mpeg4","b:v":"1000k","b:a":"128k"},extra:null,audioonly:!1,readonly:!0},"0b6280d3-f8f2-4cb6-8235-a5a4b91488f7":{title:"AVI 2Mb (mpeg4/mp3)",ext:"avi",params:{"c:a":"mp3",f:"avi","c:v":"mpeg4","b:v":"2000k","b:a":"128k"},extra:null,audioonly:!1,readonly:!0},"9ea8a22b-5738-4d0f-8494-3037ec568191":{title:"AVI 4Mb (mpeg4/mp3)",ext:"avi",params:{"c:a":"mp3",f:"avi","c:v":"mpeg4","b:v":"4000k","b:a":"128k"},extra:null,audioonly:!1,readonly:!0},"4174b9dd-c2a0-409d-801d-c84f96be0b76":{title:"MP3",ext:"mp3",params:{"b:a":"128k","c:a":"mp3",f:"mp3"},extra:null,audioonly:!0,readonly:!0},"05cb6b27-9167-4d83-833d-218a107d0376":{title:"MP3 HQ",ext:"mp3",params:{"b:a":"256k","c:a":"mp3",f:"mp3"},extra:null,audioonly:!0,readonly:!0},"69397f64-54f2-4ee4-b47a-b4fc42ee2ec1":{title:"MP4 500Kb",ext:"mp4",params:{"c:v":"mpeg4","c:a":"aac",f:"mp4","b:v":"500k","b:a":"128k",ac:2},extra:"-mbd rd -flags +mv4+aic -trellis 2 -cmp 2 -subcmp 2 -g 300",audioonly:!1,readonly:!0},"16044db3-3b75-4155-b549-c0ba19c18887":{title:"MP4 1Mb",ext:"mp4",params:{"c:v":"mpeg4","c:a":"aac",f:"mp4","b:v":"1000k","b:a":"128k",ac:2},extra:"-mbd rd -flags +mv4+aic -trellis 2 -cmp 2 -subcmp 2 -g 300",audioonly:!1,readonly:!0},"b5535083-bf16-4ae0-a21f-7c637ce0617f":{title:"MP4 2Mb",ext:"mp4",params:{"c:v":"mpeg4","c:a":"aac",f:"mp4","b:v":"2000k","b:a":"128k",ac:2},extra:"-mbd rd -flags +mv4+aic -trellis 2 -cmp 2 -subcmp 2 -g 300",audioonly:!1,readonly:!0},"dfbed97f-46c9-4db8-b5d1-4d19901bc236":{title:"MP4 4Mb",ext:"mp4",params:{"c:v":"mpeg4","c:a":"aac",f:"mp4","b:v":"4000k","b:a":"128k",ac:2},extra:"-mbd rd -flags +mv4+aic -trellis 2 -cmp 2 -subcmp 2 -g 300",audioonly:!1,readonly:!0},"912806c1-6c43-44ad-ac6e-05f105bade55":{title:"iPhone",ext:"m4v",params:{"c:v":"mpeg4","c:a":"aac",s:"480x320","b:v":"800k",f:"mp4",r:"24","b:a":"128k"},extra:null,audioonly:!1,readonly:!0},"2416dcbf-146d-4ca4-b948-f6f702fb043c":{title:"iPod",ext:"m4v",params:{"c:v":"mpeg4","c:a":"aac",s:"320x240","b:v":"500k",f:"mp4",r:"24","b:a":"128k"},extra:null,audioonly:!1,readonly:!0},"42fb9cf9-94f9-45c1-954f-1c5879f3d372":{title:"Galaxy Tab",ext:"mp4",params:{"c:a":"aac","b:a":"160k",ac:"2","c:v":"h264",f:"mp4"},extra:"-crf 22",audioonly:!1,readonly:!0},"edf545c2-88fc-4354-b91d-83e2f31d3c14":{title:"MOV (QuickTime player)",ext:"mov",params:{f:"mov","c:v":"h264",preset:"fast","profile:v":"baseline","c:a":"aac","b:a":"128k"},extra:null,audioonly:!1,readonly:!0},"f31ac68e-db3b-4b17-95d7-04456cbc3c26":{title:"Mobile 3GP (Qcif)",ext:"3gp",params:{f:"3gp","c:v":"h263","c:a":"aac","b:a":"12k",s:"176x144","b:v":"64k",ar:"8000",r:"24"},extra:null,audioonly:!1,readonly:!0},"85cd71a0-fb61-45a4-9fed-6f2e6e405bc3":{title:"MPEG-2 DVD (PAL)",ext:"mpeg",params:{f:"mpeg2video",target:"pal-dvd"},extra:null,audioonly:!1,readonly:!0},"47b9b2eb-8fd4-4e10-8993-f7d467ed1928":{title:"MPEG-2 DVD (NTSC)",ext:"mpeg",params:{f:"mpeg2video",target:"ntsc-dvd"},extra:null,audioonly:!1,readonly:!0}}});var Th=f((R5,Eh)=>{"use strict";var Ki=z(),lT=(Yr(),P(Jr));async function cT(e){let t=await Ki.prefs;Math.round(Date.now()/1e3)<t.donateNotAgainExpire||lT.checkLicense().then(r=>{r&&r.status=="accepted"||Ki.ui.open("funding",{type:t.alertDialogType,url:"content/funding.html",height:550})})}Eh.exports.newDownload=async function(){let e=await Ki.prefs,t=e.downloadCount;t++,e.downloadCount=t,t>0&&t%100==0&&cT(t)};Ki.rpc.listen({fundingLater:async()=>{let e=await Ki.prefs;e.donateNotAgainExpire=Math.round(Date.now()/1e3)+60*60*24*30}})});async function yT(e,t,r,i,n){let o=await Y.prefs,a=!!r,s=Date.now(),u=!1;if(u=Sh.matchHit(e),ia.noyt&&u){Sh.forbidden();return}re.update(e.id,{operation:"queued"});let l,p;{let{status:h,info:x}=await We.check();l=h,l&&(p=x.version)}let c;if(e.gallery_urls?c="gallery":e.core_media.builder=="YoutubeBulk"?c="youtube_bulk":e.core_media.builder=="Hls"||e.core_media.builder=="NakedHls"?c="hls":e.core_media.builder=="MPDParser"?c="mpd":e.core_media.builder=="HTTPMedia"?o.coappDownloads=="browser"||!l&&!a?c="file_inbrowser":c="file_coapp":e.core_media.builder=="YoutubeFormat"&&(c="youtube_format"),!c)throw new Error("No download strategy for builder: "+e.core_media.builder);if(i&&c!="hls"&&c!="mpd"&&c!="file_coapp"&&c!="youtube_bulk"){br.alert({title:Y._("dialog_audio_impossible_title"),text:Y._("dialog_audio_impossible")});return}if(c!="file_inbrowser"&&c!="gallery"){if(!l){br.alert({title:Y._("coapp_required"),text:Y._("coapp_required_text"),buttons:[{text:Y._("coapp_install"),className:"btn-success",rpcMethod:"installCoApp"}]});return}let h=gT;if(c=="mpd"&&(h=hT),!Oh.isMinimumVersion(p,h)){try{await We.call("quit")}catch{}await new Promise(O=>setTimeout(O,2e3));let{status:x,info:S}=await We.check();if(!x||!Oh.isMinimumVersion(S.version,h)){We.call("quit"),br.alert({title:Y._("coapp_outofdate"),text:Y._("coapp_outofdate_text",[S.version,h]),buttons:[{text:Y._("coapp_update"),className:"btn-success",rpcMethod:"installCoApp"}]});return}p=S.version}}let g=!1;{let h=!1;{let{status:x}=await dT.checkLicense();h=x=="accepted"||x=="unneeded"}if(!h){let x=ia.target=="google",S=ia.target=="mozilla",O=ia.target=="microsoft",D=120,L=D*60*1e3,B=await Mn("last_advanced_download",0),q=s-B,Q="https://www.downloadhelper.net/convert";if(i&&(c=="mpd"||c=="hls"||u)){br.alert({title:Y._("chrome_premium_required"),text:Y._("converter_reg_audio"),buttons:[{text:Y._("continue"),className:"btn-success",rpcMethod:"goto",rpcArgs:[Q]}]});return}if(a){br.alert({title:Y._("chrome_premium_required"),text:Y._("converter_needs_reg"),buttons:[{text:Y._("continue"),className:"btn-success",rpcMethod:"goto",rpcArgs:[Q]}]});return}if((x||O||a)&&(c=="mpd"||c=="hls"||u)&&q<L){br.alert({title:Y._("chrome_premium_required"),text:Y._("chrome_premium_hls",[D]),buttons:[{text:Y._("continue"),className:"btn-success",rpcMethod:"goto",rpcArgs:[Q]}]});return}S&&u&&!i&&(g=!0)}}if(c=="gallery"){for(let h of e.gallery_urls){let S={url:new URL(h,e.topUrl).href};zi.downloads.download(S)}return}if(c=="youtube_bulk"){pT.BulkDownload(e,i?"quickdownloadaudio":"quickdownload");return}if(c=="file_inbrowser"){re.updateRunning(e.id,1),re.update(e.id,{operation:"downloading",opStartDate:Date.now()}),re.updateProgress(e.id,0);let h={url:e.url},x=await zi.downloads.download(h);n.set(e.id,{inbrowser:x});let S=0;for(;;){let O=await zi.downloads.search({id:x});if(O.length>0){let D=O[0],L=D.bytesReceived-S;S=D.bytesReceived;let B=D.bytesReceived/D.totalBytes;if(re.update(e.id,{raw_bitrate:L}),re.updateProgress(e.id,100*B),D.error){Ph("No download item found");break}if(D.state=="complete")break}else break;await new Promise(D=>setTimeout(D,1e3))}return"inbrowser"}let A,d=o.lastDownloadDirectory;{try{await We.call("fs.stat",d)}catch{d=await We.call("path.homeJoin",d),await We.call("fs.mkdirp",d)}let h=e.core_media.container.extension;(i||!e.core_media.av.video)&&(h=e.core_media.container.audio_only_extension);let x=e.title??"video",S=await fT.getFilenameFromTitle(x,h);if(t)A=(await We.call("makeUniqueFileName",d,S)).filePath;else{let O=await br.saveAs(S,d);if(O)A=O.filePath,A.endsWith(`.${h}`)||(A+=`.${h}`),d=O.directory;else return}await We.call("fs.mkdirp",d),o.rememberLastDir&&(o.lastDownloadDirectory=d)}for(re.updateRunning(e.id,1);n.size>=o.downloadControlledMax;)await new Promise(h=>setTimeout(h,2e3));n.set(e.id,{}),re.update(e.id,{operation:"downloading",opStartDate:Date.now()}),re.updateProgress(e.id,1);let _=0;typeof e.duration=="number"&&(_=e.duration);let m=0,y=Date.now(),v=(h,x)=>{let S=parseFloat(x.total_size),O=Date.now(),D=(O-y)/1e3,B=~~((S-m)/D);if(B>0&&(re.update(e.id,{raw_bitrate:B}),y=O,m=S),h<0&&(h=0),_>0){let q=Math.floor(100*h/_);q>100&&(q=1/0),re.updateProgress(e.id,q)}},T=h=>n.set(e.id,{ffmpeg_pid:h});if(c=="hls"){let h=e;if(_==0){let S=h.mediaManifest??h.videoMediaManifest??h.audioMediaManifest,O=await ye.info(S,!0,e.headers);_=parseFloat(O.format?.duration)}let x={filePath:A,qr_code_needed:g,headers:e.headers,on_progress:v,on_start:T};i?await ye.sideDownload(null,h.audioMediaManifest??h.mediaManifest,x):h.mediaManifest?await ye.sideDownload(h.mediaManifest,null,x):await ye.sideDownload(h.videoMediaManifest,h.audioMediaManifest,x)}if(c=="mpd"){let h=e;if(_==0){let S=await ye.info(h.mpd_url,!0,e.headers);_=parseFloat(S.format?.duration)}let x={filePath:A,qr_code_needed:g,headers:h.headers,on_progress:v,on_start:T};i?await ye.sideDownloadMPD(h.mpd_url,null,h.mpd_audio_id,x):await ye.sideDownloadMPD(h.mpd_url,h.mpd_video_id,h.mpd_audio_id,x)}if(c=="file_coapp"){if(_==0){let x=await ye.info(e.url,!0,e.headers);_=parseFloat(x.format?.duration)}let h={filePath:A,qr_code_needed:g,headers:e.headers,on_progress:v,on_start:T};i?await ye.sideDownload(null,e.url,h):await ye.sideDownload(e.url,null,h)}if(c=="youtube_format"){if(!e.baseJs)throw new Error("baseJs expected");let h,x;if(e.videoUrl||e.url){let B=e.videoUrl??e.url;x=new URL(B)}else{console.warn("unconsistent hit");return}e.audioUrl&&(h=new URL(e.audioUrl));let S=x.searchParams.get("n"),O;S&&(O=await We.call("vm.run",`((a) => {${e.baseJs}})('${S}')`),x.searchParams.set("n",O)),h&&h.searchParams.set("n",O);let D=await ye.info(x.href,!0,e.headers);_=parseFloat(D.format?.duration);let L={filePath:A,qr_code_needed:g,headers:e.headers,on_progress:v,on_start:T};h?await ye.sideDownload(x.href,h.href,L):await ye.sideDownload(x.href,null,L)}if(a){let h=(O,D)=>{O<0&&(O=0),re.update(e.id,{raw_bitrate:1024*(parseFloat(D.bitrate)??0)}),_>0&&re.updateProgress(e.id,Math.floor(100*O/_))},x=O=>n.set(e.id,{ffmpeg_pid:O});re.update(e.id,{operation:"converting",opStartDate:Date.now()});let S=await ye.convert2(A,r,h,x);if(!o.converterKeepTmpFiles)try{await We.call("fs.unlink",A),A=S}catch{}}return g&&!o.qrMessageNotAgain&&!e.bulk&&Y.ui.open("explainqr#"+encodeURIComponent(e.id),{type:o.alertDialogType,url:"content/explain-qr.html"}),re.update(e.id,{localFilePath:A}),re.update(e.id,{localDirectory:d}),await Rn("last_advanced_download",s),A}async function Zr(e,t,r,i,n){let o=await Y.prefs,a;try{if(a=await yT(e,t,r,i,n),a&&(await mT.newDownload(),o.notifyReady)){let s=Y._("file_ready",a=="inbrowser"?e.title:a);e.isPrivate&&o.noPrivateNotification||zi.notifications.create(e.id,{type:"basic",title:Y._("vdh_notification"),iconUrl:zi.runtime.getURL("content/images/icon-36.png"),message:s})}}catch(s){console.error(s),Ph(s)}finally{n.delete(e.id),re.updateRunning(e.id,-1),re.updateProgress(e.id,null),re.update(e.id,{operation:null})}return a}var Ph,Y,Sh,pT,ia,re,We,br,Oh,dT,zi,fT,ye,mT,gT,hT,Mh=I(()=>{"use strict";Dn();({error:Ph}=(Xn(),P(Wn))),Y=z(),Sh=(ch(),P(lh)),pT=(dh(),P(ph)),ia=Jt().buildOptions,re=(Yi(),P(Ji)),We=(hr(),P(gr)),br=(Hi(),P(Vi)),Oh=(_e(),P(Ae)),dT=(Yr(),P(Jr)),zi=Y.browser,fT=($r(),P(Gr)),ye=(Qi(),P($i)),mT=Th(),gT="2.0.9",hT="2.0.13"});var Xi={};Z(Xi,{availableActions:()=>Ch,describeAll:()=>MT,execute:()=>qh,execute_default:()=>PT});async function Ch(e){let t=en.getHit(e);if(!t)return[];let r=["details","copyurl"],i=t.operation=="downloading",n=t.operation=="converting",o=!!t.localFilePath,a=!!t.core_media?.av.audio,s=t.core_media?.builder=="YoutubeBulk",u=[],l="";return Ge.has(t.id)?(l="abort",u=["abort",...r]):o?(l=(await C.prefs)["default-action-1"],Xe.isDegradedVersion()?u=["deletehit",...r]:u=["openlocalfile","openlocalcontainer","deletehit",...r]):!n&&!i?(l=(await C.prefs)["default-action-0"],u=["quickdownload","download"],(a||s)&&(u=[...u,"quickdownloadaudio","downloadaudio"]),u=[...u,"downloadconvert","blacklist","deletehit",...r]):(l="copyurl",u=r),u.sort((p,c)=>p==c?0:p==l?-1:c==l?1:0)}function vT(e){C.ui.open("details#"+encodeURIComponent(e.id),{type:"tab",url:"content/details.html"})}async function bT(e){let t;if(e.core_media?.builder=="Hls"){let r=e;t=r.masterManifest??r.mediaManifest}else e.core_media?.builder=="MPDParser"?t=e.mpd_url:e.core_media?.builder=="HTTPMedia"&&(t=e.url);if(t)try{await navigator.clipboard.writeText(t)}catch{na.scripting.executeScript({target:{tabId:e.tabId},func:i=>navigator.clipboard.writeText(i),args:[t]})}}async function AT(e){en.dispatch("hit.delete",e.id)}async function _T(e){"localFilePath"in e&&await Zi.open(e.localFilePath)}async function wT(e){"localDirectory"in e&&await Zi.open(e.localDirectory)}async function xT(e){let t=Ge.get(e.id);if(!t)throw new Error("Attempt to abord non-downloading hit");t.inbrowser&&na.downloads.cancel(e.id),t.ffmpeg_pid&&await Xe.call("abortConvert",t.ffmpeg_pid)}async function ET(e){let t=await C.prefs,r="dlconv#"+e.id;await C.rpc.call("main","embed",na.runtime.getURL("content/dlconv-embed.html?panel="+r));let{outputConfigId:i}=await C.wait(r);return t.dlconvLastOutput=i,await Zr(e,!0,i,!1,Ge)}async function TT(e){let t="content/blacklist-embed.html?panel=blacklist#"+encodeURIComponent(e.id);await Ih.call("main","embed",na.runtime.getURL(t))}async function ST(){{let{status:s,info:u}=await Xe.check();if(!s){ei.alert({title:C._("coapp_required"),text:C._("coapp_required_text"),buttons:[{text:C._("coapp_install"),className:"btn-success",rpcMethod:"installCoApp"}]});return}let l=u.version;if(!Rh.isMinimumVersion(l,bl)){try{await Xe.call("quit")}catch{}await new Promise(g=>setTimeout(g,2e3));let{status:p,info:c}=await Xe.check();if(!p||!Rh.isMinimumVersion(c.version,bl)){Xe.call("quit"),ei.alert({title:C._("coapp_outofdate"),text:C._("coapp_outofdate_text",[c.version,bl]),buttons:[{text:C._("coapp_update"),className:"btn-success",rpcMethod:"installCoApp"}]});return}}}{let{status:s}=await Nh.checkLicense();if(!(s=="accepted"||s=="unneeded")){ei.alert({title:C._("converter_needs_reg"),buttons:[{text:C._("get_conversion_license"),className:"btn-success",rpcMethod:"goto",rpcArgs:["https://www.downloadhelper.net/convert"]}]});return}}C.ui.close("main");let e,t,r,i;{let s=await Xe.call("filepicker","pick_file","~/dwhelper","Video file"),u=s.split(`
`);e=u[0];let l=u[2];if(!e)return;let p=l.split("."),c=p.pop(),g=p.join(".")+"-combined."+c;if(s=await Xe.call("filepicker","pick_file","~/dwhelper","Audio file"),u=s.split(`
`),t=u[0],!t||(s=await Xe.call("filepicker","save_file","~/dwhelper","Save as\u2026",g),u=s.split(`
`),r=u[0],i=u[1],!r||!i))return}let n={id:r,group:r,operation:"converting",status:"inactive",opStartDate:Date.now(),descrPrefix:"merge",title:r};en.dispatch("hit.new",n);let o=(s,u)=>{s<0&&(s=0);try{Ee.update(n.id,{raw_bitrate:1024*parseFloat(u.bitrate)})}catch{}},a=s=>Ge.set(n.id,{ffmpeg_pid:s});try{Ee.updateRunning(n.id,1),Ee.update(n.id,{localFilePath:r}),Ee.update(n.id,{localDirectory:i}),await Zi.sideDownload(e,t,{filePath:r,merge:!0,on_progress:o,on_start:a})}catch(s){console.error(s),Dh(s)}finally{Ge.delete(n.id),Ee.updateRunning(n.id,-1),Ee.update(n.id,{operation:null})}}async function OT(){{let{status:o}=await Xe.check();if(!o){ei.alert({title:C._("coapp_required"),text:C._("coapp_required_text"),buttons:[{text:C._("coapp_install"),className:"btn-success",rpcMethod:"installCoApp"}]});return}}{let{status:o}=await Nh.checkLicense();if(!(o=="accepted"||o=="unneeded")){ei.alert({title:C._("converter_needs_reg"),buttons:[{text:C._("get_conversion_license"),className:"btn-success",rpcMethod:"goto",rpcArgs:["https://www.downloadhelper.net/convert"]}]});return}}C.ui.close("main");let e=await C.prefs,t=await ei.selectConvertFiles(e.lastDownloadDirectory||"dwhelper");if(!t)return;let r=t.selected,i=t.outputConfig,n=t.directory;e.dlconvLastOutput=i;for(let o of r){o=await Xe.call("path.homeJoin",n,o);let a=await Zi.info(o,!0),s=parseFloat(a.format?.duration),u={id:o,group:o,operation:"converting",status:"inactive",opStartDate:Date.now(),descrPrefix:"local convert",title:o};en.dispatch("hit.new",u);let l=(c,g)=>{c<0&&(c=0);try{Ee.update(u.id,{raw_bitrate:1024*parseFloat(g.bitrate)})}catch{}s>0&&Ee.updateProgress(u.id,Math.floor(100*c/s))},p=c=>Ge.set(u.id,{ffmpeg_pid:c});try{Ee.updateRunning(u.id,1),Ee.update(u.id,{localFilePath:o}),Ee.update(u.id,{localDirectory:n}),o=await Zi.convert2(o,i,l,p)}finally{Ge.delete(u.id),Ee.updateRunning(u.id,-1),Ee.update(u.id,{operation:null})}}}function qh(e,t){let r=en.getHit(t),i=!!r.running,n=!!r.localFilePath,o=!i&&!n,a=!0;try{if(e=="details"&&vT(r),e=="copyurl")bT(r);else{if(!i&&e=="deletehit")return AT(r),a;if(o){if(e=="download"&&Zr(r,!1,null,!1,Ge),e=="quickdownload"&&Zr(r,!0,null,!1,Ge),e=="downloadaudio"&&Zr(r,!1,null,!0,Ge),e=="quickdownloadaudio"&&Zr(r,!0,null,!0,Ge),e=="downloadconvert")return ET(r),a;if(e=="blacklist")return TT(r),a}else{if(i&&e=="abort")return xT(r),a;n&&(e=="openlocalfile"&&_T(r),e=="openlocalcontainer"&&wT(r))}}}catch(s){return Dh(s),a}return!a}async function PT(e){let t=await Ch(e);return t.length>0?qh(t[0],e):!1}function MT(){return{abort:{name:"abort",title:C._("action_abort_title"),description:C._("action_abort_description"),icon:"images/icon-action-abort-64.png",icon18:"images/icon-action-abort-64.png",catPriority:2},download:{name:"download",title:C._("action_download_title"),description:C._("action_download_description"),icon:"images/icon-action-download-64.png",icon18:"images/icon-action-download-64.png",catPriority:0},quickdownload:{name:"quickdownload",title:C._("action_quickdownload_title"),description:C._("action_quickdownload_description"),icon:"images/icon-action-quick-download2-64.png",icon18:"images/icon-action-quick-download2-64.png",catPriority:0},downloadaudio:{name:"downloadaudio",title:C._("action_downloadaudio_title"),description:C._("action_downloadaudio_description"),icon:"images/icon-action-download-only-sound-64.png",icon18:"images/icon-action-download-only-sound-64.png",catPriority:0},quickdownloadaudio:{name:"quickdownloadaudio",title:C._("action_quickdownloadaudio_title"),description:C._("action_quickdownloadaudio_description"),icon:"images/icon-action-quick-download-only-sound-64.png",icon18:"images/icon-action-quick-download-only-sound-64.png",catPriority:0},downloadconvert:{name:"downloadconvert",title:C._("action_downloadconvert_title"),description:C._("action_downloadconvert_description"),icon:"images/icon-action-download-convert-64.png",icon18:"images/icon-action-download-convert-64.png",catPriority:0},details:{name:"details",title:C._("action_details_title"),description:C._("action_details_description"),icon:"images/icon-action-details-64.png",icon18:"images/icon-action-details-64.png",catPriority:0},copyurl:{name:"copyurl",title:C._("action_copyurl_title"),description:C._("action_copyurl_description"),icon:"images/icon-action-copy-link-64.png",icon18:"images/icon-action-copy-link-64.png",catPriority:0},deletehit:{name:"deletehit",title:C._("action_deletehit_title"),description:C._("action_deletehit_description"),icon:"images/icon-action-delete-64.png",icon18:"images/icon-action-delete-64.png",catPriority:0},pin:{name:"pin",title:C._("action_pin_title"),description:C._("action_pin_description"),icon:"images/icon-action-pin-64.png",icon18:"images/icon-action-pin-64.png",catPriority:0},blacklist:{name:"blacklist",title:C._("action_blacklist_title"),description:C._("action_blacklist_description"),icon:"images/icon-action-blacklist-64.png",icon18:"images/icon-action-blacklist-64.png",catPriority:0},openlocalfile:{name:"openlocalfile",title:C._("action_openlocalfile_title"),description:C._("action_openlocalfile_description"),icon:"images/icon-action-play-64.png",icon18:"images/icon-action-play-64.png",catPriority:1},openlocalcontainer:{name:"openlocalcontainer",title:C._("action_openlocalcontainer_title"),description:C._("action_openlocalcontainer_description"),icon:"images/icon-action-open-dir-64.png",icon18:"images/icon-action-open-dir-64.png",catPriority:1}}}var Dh,Xe,C,Ih,en,Zi,ei,Nh,na,Ee,Rh,Ge,bl,Gi=I(()=>{"use strict";Mh();({error:Dh}=(Xn(),P(Wn))),Xe=(hr(),P(gr)),C=z(),Ih=Mt(),en=(Ne(),P(Ie)),Zi=(Qi(),P($i)),ei=(Hi(),P(Vi)),Nh=(Yr(),P(Jr)),na=C.browser,Ee=(Yi(),P(Ji)),Rh=(_e(),P(Ae)),Ge=new Map;bl="2.0.17";Ih.listen({convertLocal:OT,mergeLocal:ST})});var Ji={};Z(Ji,{clearHits:()=>Bh,create:()=>BT,progressReducer:()=>qT,reducer:()=>LT,setHitOperation:()=>jT,update:()=>kh,updateOriginal:()=>VT,updateProgress:()=>HT,updateRunning:()=>FT});function qT(e={},t){let r;switch(t.type){case"hit.progress":r=e[t.payload.id],r!==t.payload.progress&&(e=Object.assign({},e,{[t.payload.id]:t.payload.progress}));break;case"hit.clear-progress":r=e[t.payload],typeof r<"u"&&(e=Object.assign({},e),delete e[t.payload]);break}return e}function kT(e){let t=e.status,{url:r,urls:i}=NT.current();return e.status=="running"?"running":(e.status=="active"&&e.topUrl!=r?e.topUrl in i?t="inactive":t="orphan":e.status=="inactive"&&!(e.topUrl in i)?t="orphan":(e.status=="inactive"||e.status=="orphan")&&e.topUrl==r&&(t="active"),t=="orphan"&&e.pinned&&(t="pinned"),t)}function BT(e){it.dispatch("hit.new",e)}function kh(e,t={}){it.dispatch("hit.update",{id:e,changes:t})}function FT(e,t){it.dispatch("hit.updateRunning",{id:e,runningDelta:t})}function VT(e,t={}){it.dispatch("hit.updateOriginal",{id:e,changes:t})}function HT(e,t){t===null?it.dispatch("hit.clear-progress",e):it.dispatch("hit.progress",{id:e,progress:t})}function jT(e,t){let r=it.getHit(e);r&&r.operation!==t&&kh(e,{operation:t})}function Bh(e){let t=[],{flat:r}=it.getHits();for(let i of r.values())(e=="all"&&i.status!="running"&&i.status!="pinned"||e=="pinned"&&i.status=="pinned"||e=="inactive"&&i.status=="inactive"||e=="orphans"&&i.status=="orphan")&&t.push(i.id);it.dispatch("hit.delete",t)}function LT(e,t){CT&&console.log("bg:hits:reducer",t.type),e||(e={flat:new Map});let r=e.flat;function i(n,o={}){!n.referrer&&o.pageUrl&&(o.referrer=o.pageUrl);let a=o.core_media??n.core_media;n.core_media&&o.core_media&&(a=sd(n.core_media,o.core_media));let s=n.status!="orphan";if(n={...n,...o,core_media:a},n={...n,status:kT(n)},n.status=="orphan"&&s){let u=Date.now(),l=RT.unsafe_prefs.orphanExpiration*1e3;n.orphanT0=u,n.orphanT=u+l,setTimeout(()=>it.dispatch("hit.orphanTimeout",n.id),l+100)}return n}switch(t.type){case"hit.new":{if(r.size>1e4)return console.error("Hit DB is reaching limit. Something is wrong. Abording."),{flat:r};let n=t.payload;n.created=new Date().getTime();let o=r.get(n.id)??{};if(o.status=="running")return{flat:r};o.status="active";let a=i(o,n);a.core_media||console.trace("Missing core_media"),r.set(a.id,a)}break;case"hits.urlUpdated":for(let n of r.keys())r.set(n,i(r.get(n)));break;case"hit.update":{let{id:n,changes:o}=t.payload;Array.isArray(n)||(n=[n]);for(let a of n){let s=r.get(a);if(s){let u=i(s,o);r.set(u.id,u)}else console.trace("unknown hit")}}break;case"hit.updateRunning":{let{id:n,runningDelta:o}=t.payload,a=r.get(n);if(a){let s=a.running??0,u={running:s+o};s==0&&(u.status="running"),u.running<=0&&(u.running=0,u.status="active"),r.set(n,i(a,u))}else console.trace("unknown hit")}break;case"hit.updateOriginal":{let{id:n,changes:o}=t.payload;for(let a of r.values())(n===a.id||n===a.originalId)&&r.set(a.id,i(a,o))}break;case"hit.delete":{let n=t.payload;Array.isArray(n)||(n=[n]);for(let o of n)r.delete(o)}break;case"hit.orphanTimeout":{let n=t.payload,o=r.get(n);if(o&&o.status=="orphan"&&!isNaN(o.orphanT)&&Date.now()>o.orphanT){let a=t.payload;Array.isArray(a)||(a=[a]);for(let s of a)r.delete(s)}}break;case"blacklist-changed":break;default:return!t.type.startsWith("@@redux")&&t.type!="hit.clear-progress"&&t.type!="log.new"&&t.type!="log.clear"&&t.type!="hit.progress"&&console.trace("Unexpected action:",t.type),e}return{flat:r}}var RT,DT,IT,it,NT,CT,Yi=I(()=>{"use strict";Oi();RT=z(),DT=Mt(),IT=(Gi(),P(Xi)),it=(Ne(),P(Ie)),NT=(Ft(),P(Bt)),CT=Jt().channel=="dev";DT.listen({actionCommand:(e,t)=>IT.execute(e,t),clearHits:Bh})});var Al=f((q5,Vh)=>{"use strict";var Fh=Object.prototype.toString;Vh.exports=function(t){var r=Fh.call(t),i=r==="[object Arguments]";return i||(i=r!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&Fh.call(t.callee)==="[object Function]"),i}});var Qh=f((k5,$h)=>{"use strict";var Gh;Object.keys||(tn=Object.prototype.hasOwnProperty,_l=Object.prototype.toString,Hh=Al(),wl=Object.prototype.propertyIsEnumerable,jh=!wl.call({toString:null},"toString"),Lh=wl.call(function(){},"prototype"),rn=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],oa=function(e){var t=e.constructor;return t&&t.prototype===e},Uh={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},Wh=function(){if(typeof window>"u")return!1;for(var e in window)try{if(!Uh["$"+e]&&tn.call(window,e)&&window[e]!==null&&typeof window[e]=="object")try{oa(window[e])}catch{return!0}}catch{return!0}return!1}(),Xh=function(e){if(typeof window>"u"||!Wh)return oa(e);try{return oa(e)}catch{return!1}},Gh=function(t){var r=t!==null&&typeof t=="object",i=_l.call(t)==="[object Function]",n=Hh(t),o=r&&_l.call(t)==="[object String]",a=[];if(!r&&!i&&!n)throw new TypeError("Object.keys called on a non-object");var s=Lh&&i;if(o&&t.length>0&&!tn.call(t,0))for(var u=0;u<t.length;++u)a.push(String(u));if(n&&t.length>0)for(var l=0;l<t.length;++l)a.push(String(l));else for(var p in t)!(s&&p==="prototype")&&tn.call(t,p)&&a.push(String(p));if(jh)for(var c=Xh(t),g=0;g<rn.length;++g)!(c&&rn[g]==="constructor")&&tn.call(t,rn[g])&&a.push(rn[g]);return a});var tn,_l,Hh,wl,jh,Lh,rn,oa,Uh,Wh,Xh;$h.exports=Gh});var sa=f((B5,Jh)=>{"use strict";var UT=Array.prototype.slice,WT=Al(),Kh=Object.keys,aa=Kh?function(t){return Kh(t)}:Qh(),zh=Object.keys;aa.shim=function(){if(Object.keys){var t=function(){var r=Object.keys(arguments);return r&&r.length===arguments.length}(1,2);t||(Object.keys=function(i){return WT(i)?zh(UT.call(i)):zh(i)})}else Object.keys=aa;return Object.keys||aa};Jh.exports=aa});var nn=f((F5,Yh)=>{"use strict";Yh.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),i=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var n=42;t[r]=n;for(r in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var o=Object.getOwnPropertySymbols(t);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(t,r);if(a.value!==n||a.enumerable!==!0)return!1}return!0}});var ua=f((V5,ey)=>{"use strict";var Zh=typeof Symbol<"u"&&Symbol,XT=nn();ey.exports=function(){return typeof Zh!="function"||typeof Symbol!="function"||typeof Zh("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:XT()}});var iy=f((H5,ry)=>{"use strict";var ty={foo:{}},GT=Object;ry.exports=function(){return{__proto__:ty}.foo===ty.foo&&!({__proto__:null}instanceof GT)}});var ay=f((j5,oy)=>{"use strict";var $T="Function.prototype.bind called on incompatible ",QT=Object.prototype.toString,KT=Math.max,zT="[object Function]",ny=function(t,r){for(var i=[],n=0;n<t.length;n+=1)i[n]=t[n];for(var o=0;o<r.length;o+=1)i[o+t.length]=r[o];return i},JT=function(t,r){for(var i=[],n=r||0,o=0;n<t.length;n+=1,o+=1)i[o]=t[n];return i},YT=function(e,t){for(var r="",i=0;i<e.length;i+=1)r+=e[i],i+1<e.length&&(r+=t);return r};oy.exports=function(t){var r=this;if(typeof r!="function"||QT.apply(r)!==zT)throw new TypeError($T+r);for(var i=JT(arguments,1),n,o=function(){if(this instanceof n){var p=r.apply(this,ny(i,arguments));return Object(p)===p?p:this}return r.apply(t,ny(i,arguments))},a=KT(0,r.length-i.length),s=[],u=0;u<a;u++)s[u]="$"+u;if(n=Function("binder","return function ("+YT(s,",")+"){ return binder.apply(this,arguments); }")(o),r.prototype){var l=function(){};l.prototype=r.prototype,n.prototype=new l,l.prototype=null}return n}});var la=f((L5,sy)=>{"use strict";var ZT=ay();sy.exports=Function.prototype.bind||ZT});var xl=f((U5,uy)=>{"use strict";var e2=Function.prototype.call,t2=Object.prototype.hasOwnProperty,r2=la();uy.exports=r2.call(e2,t2)});var Te=f((W5,fy)=>{"use strict";var H,ni=SyntaxError,dy=Function,ii=TypeError,El=function(e){try{return dy('"use strict"; return ('+e+").constructor;")()}catch{}},Ar=Object.getOwnPropertyDescriptor;if(Ar)try{Ar({},"")}catch{Ar=null}var Tl=function(){throw new ii},i2=Ar?function(){try{return arguments.callee,Tl}catch{try{return Ar(arguments,"callee").get}catch{return Tl}}}():Tl,ti=ua()(),n2=iy()(),ne=Object.getPrototypeOf||(n2?function(e){return e.__proto__}:null),ri={},o2=typeof Uint8Array>"u"||!ne?H:ne(Uint8Array),_r={"%AggregateError%":typeof AggregateError>"u"?H:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?H:ArrayBuffer,"%ArrayIteratorPrototype%":ti&&ne?ne([][Symbol.iterator]()):H,"%AsyncFromSyncIteratorPrototype%":H,"%AsyncFunction%":ri,"%AsyncGenerator%":ri,"%AsyncGeneratorFunction%":ri,"%AsyncIteratorPrototype%":ri,"%Atomics%":typeof Atomics>"u"?H:Atomics,"%BigInt%":typeof BigInt>"u"?H:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?H:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?H:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?H:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?H:Float32Array,"%Float64Array%":typeof Float64Array>"u"?H:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?H:FinalizationRegistry,"%Function%":dy,"%GeneratorFunction%":ri,"%Int8Array%":typeof Int8Array>"u"?H:Int8Array,"%Int16Array%":typeof Int16Array>"u"?H:Int16Array,"%Int32Array%":typeof Int32Array>"u"?H:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ti&&ne?ne(ne([][Symbol.iterator]())):H,"%JSON%":typeof JSON=="object"?JSON:H,"%Map%":typeof Map>"u"?H:Map,"%MapIteratorPrototype%":typeof Map>"u"||!ti||!ne?H:ne(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?H:Promise,"%Proxy%":typeof Proxy>"u"?H:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?H:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?H:Set,"%SetIteratorPrototype%":typeof Set>"u"||!ti||!ne?H:ne(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?H:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ti&&ne?ne(""[Symbol.iterator]()):H,"%Symbol%":ti?Symbol:H,"%SyntaxError%":ni,"%ThrowTypeError%":i2,"%TypedArray%":o2,"%TypeError%":ii,"%Uint8Array%":typeof Uint8Array>"u"?H:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?H:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?H:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?H:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?H:WeakMap,"%WeakRef%":typeof WeakRef>"u"?H:WeakRef,"%WeakSet%":typeof WeakSet>"u"?H:WeakSet};if(ne)try{null.error}catch(e){ly=ne(ne(e)),_r["%Error.prototype%"]=ly}var ly,a2=function e(t){var r;if(t==="%AsyncFunction%")r=El("async function () {}");else if(t==="%GeneratorFunction%")r=El("function* () {}");else if(t==="%AsyncGeneratorFunction%")r=El("async function* () {}");else if(t==="%AsyncGenerator%"){var i=e("%AsyncGeneratorFunction%");i&&(r=i.prototype)}else if(t==="%AsyncIteratorPrototype%"){var n=e("%AsyncGenerator%");n&&ne&&(r=ne(n.prototype))}return _r[t]=r,r},cy={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},on=la(),ca=xl(),s2=on.call(Function.call,Array.prototype.concat),u2=on.call(Function.apply,Array.prototype.splice),py=on.call(Function.call,String.prototype.replace),pa=on.call(Function.call,String.prototype.slice),l2=on.call(Function.call,RegExp.prototype.exec),c2=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,p2=/\\(\\)?/g,d2=function(t){var r=pa(t,0,1),i=pa(t,-1);if(r==="%"&&i!=="%")throw new ni("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&r!=="%")throw new ni("invalid intrinsic syntax, expected opening `%`");var n=[];return py(t,c2,function(o,a,s,u){n[n.length]=s?py(u,p2,"$1"):a||o}),n},f2=function(t,r){var i=t,n;if(ca(cy,i)&&(n=cy[i],i="%"+n[0]+"%"),ca(_r,i)){var o=_r[i];if(o===ri&&(o=a2(i)),typeof o>"u"&&!r)throw new ii("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:o}}throw new ni("intrinsic "+t+" does not exist!")};fy.exports=function(t,r){if(typeof t!="string"||t.length===0)throw new ii("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new ii('"allowMissing" argument must be a boolean');if(l2(/^%?[^%]*%?$/,t)===null)throw new ni("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=d2(t),n=i.length>0?i[0]:"",o=f2("%"+n+"%",r),a=o.name,s=o.value,u=!1,l=o.alias;l&&(n=l[0],u2(i,s2([0,1],l)));for(var p=1,c=!0;p<i.length;p+=1){var g=i[p],A=pa(g,0,1),d=pa(g,-1);if((A==='"'||A==="'"||A==="`"||d==='"'||d==="'"||d==="`")&&A!==d)throw new ni("property names with quotes must have matching quotes");if((g==="constructor"||!c)&&(u=!0),n+="."+g,a="%"+n+"%",ca(_r,a))s=_r[a];else if(s!=null){if(!(g in s)){if(!r)throw new ii("base intrinsic for "+t+" exists, but the property is not available.");return}if(Ar&&p+1>=i.length){var _=Ar(s,g);c=!!_,c&&"get"in _&&!("originalValue"in _.get)?s=_.get:s=s[g]}else c=ca(s,g),s=s[g];c&&!u&&(_r[a]=s)}}return s}});var an=f((X5,my)=>{"use strict";var m2=Te(),Sl=m2("%Object.defineProperty%",!0),Ol=function(){if(Sl)try{return Sl({},"a",{value:1}),!0}catch{return!1}return!1};Ol.hasArrayLengthDefineBug=function(){if(!Ol())return null;try{return Sl([],"length",{value:1}).length!==1}catch{return!0}};my.exports=Ol});var fa=f((G5,gy)=>{"use strict";var g2=Te(),da=g2("%Object.getOwnPropertyDescriptor%",!0);if(da)try{da([],"length")}catch{da=null}gy.exports=da});var ma=f(($5,yy)=>{"use strict";var h2=an()(),Pl=Te(),sn=h2&&Pl("%Object.defineProperty%",!0);if(sn)try{sn({},"a",{value:1})}catch{sn=!1}var y2=Pl("%SyntaxError%"),oi=Pl("%TypeError%"),hy=fa();yy.exports=function(t,r,i){if(!t||typeof t!="object"&&typeof t!="function")throw new oi("`obj` must be an object or a function`");if(typeof r!="string"&&typeof r!="symbol")throw new oi("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new oi("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new oi("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new oi("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new oi("`loose`, if provided, must be a boolean");var n=arguments.length>3?arguments[3]:null,o=arguments.length>4?arguments[4]:null,a=arguments.length>5?arguments[5]:null,s=arguments.length>6?arguments[6]:!1,u=!!hy&&hy(t,r);if(sn)sn(t,r,{configurable:a===null&&u?u.configurable:!a,enumerable:n===null&&u?u.enumerable:!n,value:i,writable:o===null&&u?u.writable:!o});else if(s||!n&&!o&&!a)t[r]=i;else throw new y2("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}});var Lt=f((Q5,_y)=>{"use strict";var v2=sa(),b2=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",A2=Object.prototype.toString,_2=Array.prototype.concat,vy=ma(),w2=function(e){return typeof e=="function"&&A2.call(e)==="[object Function]"},by=an()(),x2=function(e,t,r,i){if(t in e){if(i===!0){if(e[t]===r)return}else if(!w2(i)||!i())return}by?vy(e,t,r,!0):vy(e,t,r)},Ay=function(e,t){var r=arguments.length>2?arguments[2]:{},i=v2(t);b2&&(i=_2.call(i,Object.getOwnPropertySymbols(t)));for(var n=0;n<i.length;n+=1)x2(e,i[n],t[i[n]],r[i[n]])};Ay.supportsDescriptors=!!by;_y.exports=Ay});var Oy=f((K5,Sy)=>{"use strict";var Ty=Te(),wy=ma(),E2=an()(),xy=fa(),Ey=Ty("%TypeError%"),T2=Ty("%Math.floor%");Sy.exports=function(t,r){if(typeof t!="function")throw new Ey("`fn` is not a function");if(typeof r!="number"||r<0||r>4294967295||T2(r)!==r)throw new Ey("`length` must be a positive 32-bit integer");var i=arguments.length>2&&!!arguments[2],n=!0,o=!0;if("length"in t&&xy){var a=xy(t,"length");a&&!a.configurable&&(n=!1),a&&!a.writable&&(o=!1)}return(n||o||!i)&&(E2?wy(t,"length",r,!0,!0):wy(t,"length",r)),t}});var wr=f((z5,ga)=>{"use strict";var Ml=la(),ai=Te(),S2=Oy(),O2=ai("%TypeError%"),My=ai("%Function.prototype.apply%"),Ry=ai("%Function.prototype.call%"),Dy=ai("%Reflect.apply%",!0)||Ml.call(Ry,My),un=ai("%Object.defineProperty%",!0),P2=ai("%Math.max%");if(un)try{un({},"a",{value:1})}catch{un=null}ga.exports=function(t){if(typeof t!="function")throw new O2("a function is required");var r=Dy(Ml,Ry,arguments);return S2(r,1+P2(0,t.length-(arguments.length-1)),!0)};var Py=function(){return Dy(Ml,My,arguments)};un?un(ga.exports,"apply",{value:Py}):ga.exports.apply=Py});var Se=f((J5,Cy)=>{"use strict";var Iy=Te(),Ny=wr(),M2=Ny(Iy("String.prototype.indexOf"));Cy.exports=function(t,r){var i=Iy(t,!!r);return typeof i=="function"&&M2(t,".prototype.")>-1?Ny(i):i}});var Rl=f((Y5,Vy)=>{"use strict";var R2=sa(),By=nn()(),Fy=Se(),qy=Object,D2=Fy("Array.prototype.push"),ky=Fy("Object.prototype.propertyIsEnumerable"),I2=By?Object.getOwnPropertySymbols:null;Vy.exports=function(t,r){if(t==null)throw new TypeError("target must be an object");var i=qy(t);if(arguments.length===1)return i;for(var n=1;n<arguments.length;++n){var o=qy(arguments[n]),a=R2(o),s=By&&(Object.getOwnPropertySymbols||I2);if(s)for(var u=s(o),l=0;l<u.length;++l){var p=u[l];ky(o,p)&&D2(a,p)}for(var c=0;c<a.length;++c){var g=a[c];if(ky(o,g)){var A=o[g];i[g]=A}}}return i}});var Il=f((Z5,Hy)=>{"use strict";var Dl=Rl(),N2=function(){if(!Object.assign)return!1;for(var e="abcdefghijklmnopqrst",t=e.split(""),r={},i=0;i<t.length;++i)r[t[i]]=t[i];var n=Object.assign({},r),o="";for(var a in n)o+=a;return e!==o},C2=function(){if(!Object.assign||!Object.preventExtensions)return!1;var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch{return e[1]==="y"}return!1};Hy.exports=function(){return!Object.assign||N2()||C2()?Dl:Object.assign}});var Ly=f((eC,jy)=>{"use strict";var q2=Lt(),k2=Il();jy.exports=function(){var t=k2();return q2(Object,{assign:t},{assign:function(){return Object.assign!==t}}),t}});var Gy=f((tC,Xy)=>{"use strict";var B2=Lt(),F2=wr(),V2=Rl(),Uy=Il(),H2=Ly(),j2=F2.apply(Uy()),Wy=function(t,r){return j2(Object,arguments)};B2(Wy,{getPolyfill:Uy,implementation:V2,shim:H2});Xy.exports=Wy});var Qy=f((rC,$y)=>{"use strict";var cn=function(){return typeof function(){}.name=="string"},ln=Object.getOwnPropertyDescriptor;if(ln)try{ln([],"length")}catch{ln=null}cn.functionsHaveConfigurableNames=function(){if(!cn()||!ln)return!1;var t=ln(function(){},"name");return!!t&&!!t.configurable};var L2=Function.prototype.bind;cn.boundFunctionsHaveNames=function(){return cn()&&typeof L2=="function"&&function(){}.bind().name!==""};$y.exports=cn});var Jy=f((iC,zy)=>{"use strict";var Ky=ma(),U2=an()(),W2=Qy().functionsHaveConfigurableNames(),X2=TypeError;zy.exports=function(t,r){if(typeof t!="function")throw new X2("`fn` is not a function");var i=arguments.length>2&&!!arguments[2];return(!i||W2)&&(U2?Ky(t,"name",r,!0,!0):Ky(t,"name",r)),t}});var Nl=f((nC,Yy)=>{"use strict";var G2=Jy(),$2=Object,Q2=TypeError;Yy.exports=G2(function(){if(this!=null&&this!==$2(this))throw new Q2("RegExp.prototype.flags getter called on non-object");var t="";return this.hasIndices&&(t+="d"),this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.unicodeSets&&(t+="v"),this.sticky&&(t+="y"),t},"get flags",!0)});var Cl=f((oC,Zy)=>{"use strict";var K2=Nl(),z2=Lt().supportsDescriptors,J2=Object.getOwnPropertyDescriptor;Zy.exports=function(){if(z2&&/a/mig.flags==="gim"){var t=J2(RegExp.prototype,"flags");if(t&&typeof t.get=="function"&&typeof RegExp.prototype.dotAll=="boolean"&&typeof RegExp.prototype.hasIndices=="boolean"){var r="",i={};if(Object.defineProperty(i,"hasIndices",{get:function(){r+="d"}}),Object.defineProperty(i,"sticky",{get:function(){r+="y"}}),r==="dy")return t.get}}return K2}});var rv=f((aC,tv)=>{"use strict";var Y2=Lt().supportsDescriptors,Z2=Cl(),e4=Object.getOwnPropertyDescriptor,t4=Object.defineProperty,r4=TypeError,ev=Object.getPrototypeOf,i4=/a/;tv.exports=function(){if(!Y2||!ev)throw new r4("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=Z2(),r=ev(i4),i=e4(r,"flags");return(!i||i.get!==t)&&t4(r,"flags",{configurable:!0,enumerable:!1,get:t}),t}});var av=f((sC,ov)=>{"use strict";var n4=Lt(),o4=wr(),a4=Nl(),iv=Cl(),s4=rv(),nv=o4(iv());n4(nv,{getPolyfill:iv,implementation:a4,shim:s4});ov.exports=nv});var Ut=f((uC,sv)=>{"use strict";var u4=nn();sv.exports=function(){return u4()&&!!Symbol.toStringTag}});var kl=f((lC,lv)=>{"use strict";var l4=Ut()(),c4=Se(),ql=c4("Object.prototype.toString"),ha=function(t){return l4&&t&&typeof t=="object"&&Symbol.toStringTag in t?!1:ql(t)==="[object Arguments]"},uv=function(t){return ha(t)?!0:t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&ql(t)!=="[object Array]"&&ql(t.callee)==="[object Function]"},p4=function(){return ha(arguments)}();ha.isLegacyArguments=uv;lv.exports=p4?ha:uv});var cv=f(()=>{});var Rv=f((dC,Mv)=>{var Gl=typeof Map=="function"&&Map.prototype,Bl=Object.getOwnPropertyDescriptor&&Gl?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,va=Gl&&Bl&&typeof Bl.get=="function"?Bl.get:null,pv=Gl&&Map.prototype.forEach,$l=typeof Set=="function"&&Set.prototype,Fl=Object.getOwnPropertyDescriptor&&$l?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,ba=$l&&Fl&&typeof Fl.get=="function"?Fl.get:null,dv=$l&&Set.prototype.forEach,d4=typeof WeakMap=="function"&&WeakMap.prototype,dn=d4?WeakMap.prototype.has:null,f4=typeof WeakSet=="function"&&WeakSet.prototype,fn=f4?WeakSet.prototype.has:null,m4=typeof WeakRef=="function"&&WeakRef.prototype,fv=m4?WeakRef.prototype.deref:null,g4=Boolean.prototype.valueOf,h4=Object.prototype.toString,y4=Function.prototype.toString,v4=String.prototype.match,Ql=String.prototype.slice,Xt=String.prototype.replace,b4=String.prototype.toUpperCase,mv=String.prototype.toLowerCase,xv=RegExp.prototype.test,gv=Array.prototype.concat,nt=Array.prototype.join,A4=Array.prototype.slice,hv=Math.floor,jl=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Vl=Object.getOwnPropertySymbols,Ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,si=typeof Symbol=="function"&&typeof Symbol.iterator=="object",se=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===si||!0)?Symbol.toStringTag:null,Ev=Object.prototype.propertyIsEnumerable,yv=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function vv(e,t){if(e===1/0||e===-1/0||e!==e||e&&e>-1e3&&e<1e3||xv.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof e=="number"){var i=e<0?-hv(-e):hv(e);if(i!==e){var n=String(i),o=Ql.call(t,n.length+1);return Xt.call(n,r,"$&_")+"."+Xt.call(Xt.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Xt.call(t,r,"$&_")}var Ul=cv(),bv=Ul.custom,Av=Sv(bv)?bv:null;Mv.exports=function e(t,r,i,n){var o=r||{};if(Wt(o,"quoteStyle")&&o.quoteStyle!=="single"&&o.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Wt(o,"maxStringLength")&&(typeof o.maxStringLength=="number"?o.maxStringLength<0&&o.maxStringLength!==1/0:o.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=Wt(o,"customInspect")?o.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Wt(o,"indent")&&o.indent!==null&&o.indent!=="	"&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Wt(o,"numericSeparator")&&typeof o.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var s=o.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return Pv(t,o);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var u=String(t);return s?vv(t,u):u}if(typeof t=="bigint"){var l=String(t)+"n";return s?vv(t,l):l}var p=typeof o.depth>"u"?5:o.depth;if(typeof i>"u"&&(i=0),i>=p&&p>0&&typeof t=="object")return Wl(t)?"[Array]":"[Object]";var c=F4(o,i);if(typeof n>"u")n=[];else if(Ov(n,t)>=0)return"[Circular]";function g(j,oe,Oe){if(oe&&(n=A4.call(n),n.push(oe)),Oe){var ae={depth:o.depth};return Wt(o,"quoteStyle")&&(ae.quoteStyle=o.quoteStyle),e(j,ae,i+1,n)}return e(j,o,i+1,n)}if(typeof t=="function"&&!_v(t)){var A=M4(t),d=ya(t,g);return"[Function"+(A?": "+A:" (anonymous)")+"]"+(d.length>0?" { "+nt.call(d,", ")+" }":"")}if(Sv(t)){var _=si?Xt.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):Ll.call(t);return typeof t=="object"&&!si?pn(_):_}if(q4(t)){for(var m="<"+mv.call(String(t.nodeName)),y=t.attributes||[],v=0;v<y.length;v++)m+=" "+y[v].name+"="+Tv(_4(y[v].value),"double",o);return m+=">",t.childNodes&&t.childNodes.length&&(m+="..."),m+="</"+mv.call(String(t.nodeName))+">",m}if(Wl(t)){if(t.length===0)return"[]";var T=ya(t,g);return c&&!B4(T)?"["+Xl(T,c)+"]":"[ "+nt.call(T,", ")+" ]"}if(x4(t)){var h=ya(t,g);return!("cause"in Error.prototype)&&"cause"in t&&!Ev.call(t,"cause")?"{ ["+String(t)+"] "+nt.call(gv.call("[cause]: "+g(t.cause),h),", ")+" }":h.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+nt.call(h,", ")+" }"}if(typeof t=="object"&&a){if(Av&&typeof t[Av]=="function"&&Ul)return Ul(t,{depth:p-i});if(a!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(R4(t)){var x=[];return pv&&pv.call(t,function(j,oe){x.push(g(oe,t,!0)+" => "+g(j,t))}),wv("Map",va.call(t),x,c)}if(N4(t)){var S=[];return dv&&dv.call(t,function(j){S.push(g(j,t))}),wv("Set",ba.call(t),S,c)}if(D4(t))return Hl("WeakMap");if(C4(t))return Hl("WeakSet");if(I4(t))return Hl("WeakRef");if(T4(t))return pn(g(Number(t)));if(O4(t))return pn(g(jl.call(t)));if(S4(t))return pn(g4.call(t));if(E4(t))return pn(g(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(t===global)return"{ [object globalThis] }";if(!w4(t)&&!_v(t)){var O=ya(t,g),D=yv?yv(t)===Object.prototype:t instanceof Object||t.constructor===Object,L=t instanceof Object?"":"null prototype",B=!D&&se&&Object(t)===t&&se in t?Ql.call(Gt(t),8,-1):L?"Object":"",q=D||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",Q=q+(B||L?"["+nt.call(gv.call([],B||[],L||[]),": ")+"] ":"");return O.length===0?Q+"{}":c?Q+"{"+Xl(O,c)+"}":Q+"{ "+nt.call(O,", ")+" }"}return String(t)};function Tv(e,t,r){var i=(r.quoteStyle||t)==="double"?'"':"'";return i+e+i}function _4(e){return Xt.call(String(e),/"/g,"&quot;")}function Wl(e){return Gt(e)==="[object Array]"&&(!se||!(typeof e=="object"&&se in e))}function w4(e){return Gt(e)==="[object Date]"&&(!se||!(typeof e=="object"&&se in e))}function _v(e){return Gt(e)==="[object RegExp]"&&(!se||!(typeof e=="object"&&se in e))}function x4(e){return Gt(e)==="[object Error]"&&(!se||!(typeof e=="object"&&se in e))}function E4(e){return Gt(e)==="[object String]"&&(!se||!(typeof e=="object"&&se in e))}function T4(e){return Gt(e)==="[object Number]"&&(!se||!(typeof e=="object"&&se in e))}function S4(e){return Gt(e)==="[object Boolean]"&&(!se||!(typeof e=="object"&&se in e))}function Sv(e){if(si)return e&&typeof e=="object"&&e instanceof Symbol;if(typeof e=="symbol")return!0;if(!e||typeof e!="object"||!Ll)return!1;try{return Ll.call(e),!0}catch{}return!1}function O4(e){if(!e||typeof e!="object"||!jl)return!1;try{return jl.call(e),!0}catch{}return!1}var P4=Object.prototype.hasOwnProperty||function(e){return e in this};function Wt(e,t){return P4.call(e,t)}function Gt(e){return h4.call(e)}function M4(e){if(e.name)return e.name;var t=v4.call(y4.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}function Ov(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1}function R4(e){if(!va||!e||typeof e!="object")return!1;try{va.call(e);try{ba.call(e)}catch{return!0}return e instanceof Map}catch{}return!1}function D4(e){if(!dn||!e||typeof e!="object")return!1;try{dn.call(e,dn);try{fn.call(e,fn)}catch{return!0}return e instanceof WeakMap}catch{}return!1}function I4(e){if(!fv||!e||typeof e!="object")return!1;try{return fv.call(e),!0}catch{}return!1}function N4(e){if(!ba||!e||typeof e!="object")return!1;try{ba.call(e);try{va.call(e)}catch{return!0}return e instanceof Set}catch{}return!1}function C4(e){if(!fn||!e||typeof e!="object")return!1;try{fn.call(e,fn);try{dn.call(e,dn)}catch{return!0}return e instanceof WeakSet}catch{}return!1}function q4(e){return!e||typeof e!="object"?!1:typeof HTMLElement<"u"&&e instanceof HTMLElement?!0:typeof e.nodeName=="string"&&typeof e.getAttribute=="function"}function Pv(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,i="... "+r+" more character"+(r>1?"s":"");return Pv(Ql.call(e,0,t.maxStringLength),t)+i}var n=Xt.call(Xt.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,k4);return Tv(n,"single",t)}function k4(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+b4.call(t.toString(16))}function pn(e){return"Object("+e+")"}function Hl(e){return e+" { ? }"}function wv(e,t,r,i){var n=i?Xl(r,i):nt.call(r,", ");return e+" ("+t+") {"+n+"}"}function B4(e){for(var t=0;t<e.length;t++)if(Ov(e[t],`
`)>=0)return!1;return!0}function F4(e,t){var r;if(e.indent==="	")r="	";else if(typeof e.indent=="number"&&e.indent>0)r=nt.call(Array(e.indent+1)," ");else return null;return{base:r,prev:nt.call(Array(t+1),r)}}function Xl(e,t){if(e.length===0)return"";var r=`
`+t.prev+t.base;return r+nt.call(e,","+r)+`
`+t.prev}function ya(e,t){var r=Wl(e),i=[];if(r){i.length=e.length;for(var n=0;n<e.length;n++)i[n]=Wt(e,n)?t(e[n],e):""}var o=typeof Vl=="function"?Vl(e):[],a;if(si){a={};for(var s=0;s<o.length;s++)a["$"+o[s]]=o[s]}for(var u in e)Wt(e,u)&&(r&&String(Number(u))===u&&u<e.length||si&&a["$"+u]instanceof Symbol||(xv.call(/[^\w$]/,u)?i.push(t(u,e)+": "+t(e[u],e)):i.push(u+": "+t(e[u],e))));if(typeof Vl=="function")for(var l=0;l<o.length;l++)Ev.call(e,o[l])&&i.push("["+t(o[l])+"]: "+t(e[o[l]],e));return i}});var Jl=f((fC,Dv)=>{"use strict";var Kl=Te(),ui=Se(),V4=Rv(),H4=Kl("%TypeError%"),Aa=Kl("%WeakMap%",!0),_a=Kl("%Map%",!0),j4=ui("WeakMap.prototype.get",!0),L4=ui("WeakMap.prototype.set",!0),U4=ui("WeakMap.prototype.has",!0),W4=ui("Map.prototype.get",!0),X4=ui("Map.prototype.set",!0),G4=ui("Map.prototype.has",!0),zl=function(e,t){for(var r=e,i;(i=r.next)!==null;r=i)if(i.key===t)return r.next=i.next,i.next=e.next,e.next=i,i},$4=function(e,t){var r=zl(e,t);return r&&r.value},Q4=function(e,t,r){var i=zl(e,t);i?i.value=r:e.next={key:t,next:e.next,value:r}},K4=function(e,t){return!!zl(e,t)};Dv.exports=function(){var t,r,i,n={assert:function(o){if(!n.has(o))throw new H4("Side channel does not contain "+V4(o))},get:function(o){if(Aa&&o&&(typeof o=="object"||typeof o=="function")){if(t)return j4(t,o)}else if(_a){if(r)return W4(r,o)}else if(i)return $4(i,o)},has:function(o){if(Aa&&o&&(typeof o=="object"||typeof o=="function")){if(t)return U4(t,o)}else if(_a){if(r)return G4(r,o)}else if(i)return K4(i,o);return!1},set:function(o,a){Aa&&o&&(typeof o=="object"||typeof o=="function")?(t||(t=new Aa),L4(t,o,a)):_a?(r||(r=new _a),X4(r,o,a)):(i||(i={key:{},next:null}),Q4(i,o,a))}};return n}});var Nv=f((mC,Iv)=>{"use strict";var z4=Te(),J4=xl(),mn=Jl()(),Tt=z4("%TypeError%"),Yl={assert:function(e,t){if(!e||typeof e!="object"&&typeof e!="function")throw new Tt("`O` is not an object");if(typeof t!="string")throw new Tt("`slot` must be a string");if(mn.assert(e),!Yl.has(e,t))throw new Tt("`"+t+"` is not present on `O`")},get:function(e,t){if(!e||typeof e!="object"&&typeof e!="function")throw new Tt("`O` is not an object");if(typeof t!="string")throw new Tt("`slot` must be a string");var r=mn.get(e);return r&&r["$"+t]},has:function(e,t){if(!e||typeof e!="object"&&typeof e!="function")throw new Tt("`O` is not an object");if(typeof t!="string")throw new Tt("`slot` must be a string");var r=mn.get(e);return!!r&&J4(r,"$"+t)},set:function(e,t,r){if(!e||typeof e!="object"&&typeof e!="function")throw new Tt("`O` is not an object");if(typeof t!="string")throw new Tt("`slot` must be a string");var i=mn.get(e);i||(i={},mn.set(e,i)),i["$"+t]=r}};Object.freeze&&Object.freeze(Yl);Iv.exports=Yl});var kv=f((gC,qv)=>{"use strict";var gn=Nv(),Y4=SyntaxError,Cv=typeof StopIteration=="object"?StopIteration:null;qv.exports=function(t){if(!Cv)throw new Y4("this environment lacks StopIteration");gn.set(t,"[[Done]]",!1);var r={next:function(){var n=gn.get(this,"[[Iterator]]"),o=gn.get(n,"[[Done]]");try{return{done:o,value:o?void 0:n.next()}}catch(a){if(gn.set(n,"[[Done]]",!0),a!==Cv)throw a;return{done:!0,value:void 0}}}};return gn.set(r,"[[Iterator]]",t),r}});var Zl=f((hC,Bv)=>{var Z4={}.toString;Bv.exports=Array.isArray||function(e){return Z4.call(e)=="[object Array]"}});var ec=f((yC,Fv)=>{"use strict";var eS=String.prototype.valueOf,tS=function(t){try{return eS.call(t),!0}catch{return!1}},rS=Object.prototype.toString,iS="[object String]",nS=Ut()();Fv.exports=function(t){return typeof t=="string"?!0:typeof t!="object"?!1:nS?tS(t):rS.call(t)===iS}});var rc=f((vC,jv)=>{"use strict";var tc=typeof Map=="function"&&Map.prototype?Map:null,oS=typeof Set=="function"&&Set.prototype?Set:null,wa;tc||(wa=function(t){return!1});var Hv=tc?Map.prototype.has:null,Vv=oS?Set.prototype.has:null;!wa&&!Hv&&(wa=function(t){return!1});jv.exports=wa||function(t){if(!t||typeof t!="object")return!1;try{if(Hv.call(t),Vv)try{Vv.call(t)}catch{return!0}return t instanceof tc}catch{}return!1}});var nc=f((bC,Wv)=>{"use strict";var aS=typeof Map=="function"&&Map.prototype?Map:null,ic=typeof Set=="function"&&Set.prototype?Set:null,xa;ic||(xa=function(t){return!1});var Lv=aS?Map.prototype.has:null,Uv=ic?Set.prototype.has:null;!xa&&!Uv&&(xa=function(t){return!1});Wv.exports=xa||function(t){if(!t||typeof t!="object")return!1;try{if(Uv.call(t),Lv)try{Lv.call(t)}catch{return!0}return t instanceof ic}catch{}return!1}});var rb=f((AC,Sa)=>{"use strict";var Xv=kl(),Gv=kv();ua()()||nn()()?(Ea=Symbol.iterator,Sa.exports=function(t){if(t!=null&&typeof t[Ea]<"u")return t[Ea]();if(Xv(t))return Array.prototype[Ea].call(t)}):($v=Zl(),Qv=ec(),oc=Te(),Kv=oc("%Map%",!0),zv=oc("%Set%",!0),qe=Se(),ac=qe("Array.prototype.push"),sc=qe("String.prototype.charCodeAt"),Jv=qe("String.prototype.slice"),Yv=function(t,r){var i=t.length;if(r+1>=i)return r+1;var n=sc(t,r);if(n<55296||n>56319)return r+1;var o=sc(t,r+1);return o<56320||o>57343?r+1:r+2},Ta=function(t){var r=0;return{next:function(){var n=r>=t.length,o;return n||(o=t[r],r+=1),{done:n,value:o}}}},uc=function(t,r){if($v(t)||Xv(t))return Ta(t);if(Qv(t)){var i=0;return{next:function(){var o=Yv(t,i),a=Jv(t,i,o);return i=o,{done:o>t.length,value:a}}}}if(r&&typeof t["_es6-shim iterator_"]<"u")return t["_es6-shim iterator_"]()},!Kv&&!zv?Sa.exports=function(t){if(t!=null)return uc(t,!0)}:(Zv=rc(),eb=nc(),lc=qe("Map.prototype.forEach",!0),cc=qe("Set.prototype.forEach",!0),(typeof process>"u"||!process.versions||!process.versions.node)&&(pc=qe("Map.prototype.iterator",!0),dc=qe("Set.prototype.iterator",!0)),fc=qe("Map.prototype.@@iterator",!0)||qe("Map.prototype._es6-shim iterator_",!0),mc=qe("Set.prototype.@@iterator",!0)||qe("Set.prototype._es6-shim iterator_",!0),tb=function(t){if(Zv(t)){if(pc)return Gv(pc(t));if(fc)return fc(t);if(lc){var r=[];return lc(t,function(n,o){ac(r,[o,n])}),Ta(r)}}if(eb(t)){if(dc)return Gv(dc(t));if(mc)return mc(t);if(cc){var i=[];return cc(t,function(n){ac(i,n)}),Ta(i)}}},Sa.exports=function(t){return tb(t)||uc(t)}));var Ea,$v,Qv,oc,Kv,zv,qe,ac,sc,Jv,Yv,Ta,uc,Zv,eb,lc,cc,pc,dc,fc,mc,tb});var gc=f((_C,nb)=>{"use strict";var ib=function(e){return e!==e};nb.exports=function(t,r){return t===0&&r===0?1/t===1/r:!!(t===r||ib(t)&&ib(r))}});var hc=f((wC,ob)=>{"use strict";var sS=gc();ob.exports=function(){return typeof Object.is=="function"?Object.is:sS}});var sb=f((xC,ab)=>{"use strict";var uS=hc(),lS=Lt();ab.exports=function(){var t=uS();return lS(Object,{is:t},{is:function(){return Object.is!==t}}),t}});var pb=f((EC,cb)=>{"use strict";var cS=Lt(),pS=wr(),dS=gc(),ub=hc(),fS=sb(),lb=pS(ub(),Object);cS(lb,{getPolyfill:ub,implementation:dS,shim:fS});cb.exports=lb});var gb=f((TC,mb)=>{"use strict";var fb=Function.prototype.toString,li=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,vc,Oa;if(typeof li=="function"&&typeof Object.defineProperty=="function")try{vc=Object.defineProperty({},"length",{get:function(){throw Oa}}),Oa={},li(function(){throw 42},null,vc)}catch(e){e!==Oa&&(li=null)}else li=null;var mS=/^\s*class\b/,bc=function(t){try{var r=fb.call(t);return mS.test(r)}catch{return!1}},yc=function(t){try{return bc(t)?!1:(fb.call(t),!0)}catch{return!1}},Pa=Object.prototype.toString,gS="[object Object]",hS="[object Function]",yS="[object GeneratorFunction]",vS="[object HTMLAllCollection]",bS="[object HTML document.all class]",AS="[object HTMLCollection]",_S=typeof Symbol=="function"&&!!Symbol.toStringTag,wS=!(0 in[,]),Ac=function(){return!1};typeof document=="object"&&(db=document.all,Pa.call(db)===Pa.call(document.all)&&(Ac=function(t){if((wS||!t)&&(typeof t>"u"||typeof t=="object"))try{var r=Pa.call(t);return(r===vS||r===bS||r===AS||r===gS)&&t("")==null}catch{}return!1}));var db;mb.exports=li?function(t){if(Ac(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;try{li(t,null,vc)}catch(r){if(r!==Oa)return!1}return!bc(t)&&yc(t)}:function(t){if(Ac(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;if(_S)return yc(t);if(bc(t))return!1;var r=Pa.call(t);return r!==hS&&r!==yS&&!/^\[object HTML/.test(r)?!1:yc(t)}});var vb=f((SC,yb)=>{"use strict";var xS=gb(),ES=Object.prototype.toString,hb=Object.prototype.hasOwnProperty,TS=function(t,r,i){for(var n=0,o=t.length;n<o;n++)hb.call(t,n)&&(i==null?r(t[n],n,t):r.call(i,t[n],n,t))},SS=function(t,r,i){for(var n=0,o=t.length;n<o;n++)i==null?r(t.charAt(n),n,t):r.call(i,t.charAt(n),n,t)},OS=function(t,r,i){for(var n in t)hb.call(t,n)&&(i==null?r(t[n],n,t):r.call(i,t[n],n,t))},PS=function(t,r,i){if(!xS(r))throw new TypeError("iterator must be a function");var n;arguments.length>=3&&(n=i),ES.call(t)==="[object Array]"?TS(t,r,n):typeof t=="string"?SS(t,r,n):OS(t,r,n)};yb.exports=PS});var Ab=f((OC,bb)=>{"use strict";var _c=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],MS=typeof globalThis>"u"?global:globalThis;bb.exports=function(){for(var t=[],r=0;r<_c.length;r++)typeof MS[_c[r]]=="function"&&(t[t.length]=_c[r]);return t}});var Sc=f((PC,Eb)=>{"use strict";var Ra=vb(),RS=Ab(),_b=wr(),Ec=Se(),Ma=fa(),DS=Ec("Object.prototype.toString"),xb=Ut()(),wb=typeof globalThis>"u"?global:globalThis,xc=RS(),Tc=Ec("String.prototype.slice"),wc=Object.getPrototypeOf,IS=Ec("Array.prototype.indexOf",!0)||function(t,r){for(var i=0;i<t.length;i+=1)if(t[i]===r)return i;return-1},Da={__proto__:null};xb&&Ma&&wc?Ra(xc,function(e){var t=new wb[e];if(Symbol.toStringTag in t){var r=wc(t),i=Ma(r,Symbol.toStringTag);if(!i){var n=wc(r);i=Ma(n,Symbol.toStringTag)}Da["$"+e]=_b(i.get)}}):Ra(xc,function(e){var t=new wb[e],r=t.slice||t.set;r&&(Da["$"+e]=_b(r))});var NS=function(t){var r=!1;return Ra(Da,function(i,n){if(!r)try{"$"+i(t)===n&&(r=Tc(n,1))}catch{}}),r},CS=function(t){var r=!1;return Ra(Da,function(i,n){if(!r)try{i(t),r=Tc(n,1)}catch{}}),r};Eb.exports=function(t){if(!t||typeof t!="object")return!1;if(!xb){var r=Tc(DS(t),8,-1);return IS(xc,r)>-1?r:r!=="Object"?!1:CS(t)}return Ma?NS(t):null}});var Sb=f((MC,Tb)=>{"use strict";var qS=Sc();Tb.exports=function(t){return!!qS(t)}});var Oc=f((RC,Ib)=>{"use strict";var kS=wr(),BS=Se(),Db=Te(),FS=Sb(),Ob=Db("ArrayBuffer",!0),Pb=Db("Float32Array",!0),Ia=BS("ArrayBuffer.prototype.byteLength",!0),Mb=Ob&&!Ia&&new Ob().slice,Rb=Mb&&kS(Mb);Ib.exports=Ia||Rb?function(t){if(!t||typeof t!="object")return!1;try{return Ia?Ia(t):Rb(t,0),!0}catch{return!1}}:Pb?function(t){try{return new Pb(t).buffer===t&&!FS(t)}catch(r){return typeof t=="object"&&r.name==="RangeError"}}:function(t){return!1}});var Cb=f((DC,Nb)=>{"use strict";var VS=Date.prototype.getDay,HS=function(t){try{return VS.call(t),!0}catch{return!1}},jS=Object.prototype.toString,LS="[object Date]",US=Ut()();Nb.exports=function(t){return typeof t!="object"||t===null?!1:US?HS(t):jS.call(t)===LS}});var Vb=f((IC,Fb)=>{"use strict";var Pc=Se(),qb=Ut()(),kb,Bb,Mc,Rc;qb&&(kb=Pc("Object.prototype.hasOwnProperty"),Bb=Pc("RegExp.prototype.exec"),Mc={},Na=function(){throw Mc},Rc={toString:Na,valueOf:Na},typeof Symbol.toPrimitive=="symbol"&&(Rc[Symbol.toPrimitive]=Na));var Na,WS=Pc("Object.prototype.toString"),XS=Object.getOwnPropertyDescriptor,GS="[object RegExp]";Fb.exports=qb?function(t){if(!t||typeof t!="object")return!1;var r=XS(t,"lastIndex"),i=r&&kb(r,"value");if(!i)return!1;try{Bb(t,Rc)}catch(n){return n===Mc}}:function(t){return!t||typeof t!="object"&&typeof t!="function"?!1:WS(t)===GS}});var Lb=f((NC,jb)=>{"use strict";var $S=Se(),Hb=$S("SharedArrayBuffer.prototype.byteLength",!0);jb.exports=Hb?function(t){if(!t||typeof t!="object")return!1;try{return Hb(t),!0}catch{return!1}}:function(t){return!1}});var Wb=f((CC,Ub)=>{"use strict";var QS=Number.prototype.toString,KS=function(t){try{return QS.call(t),!0}catch{return!1}},zS=Object.prototype.toString,JS="[object Number]",YS=Ut()();Ub.exports=function(t){return typeof t=="number"?!0:typeof t!="object"?!1:YS?KS(t):zS.call(t)===JS}});var $b=f((qC,Gb)=>{"use strict";var Xb=Se(),ZS=Xb("Boolean.prototype.toString"),eO=Xb("Object.prototype.toString"),tO=function(t){try{return ZS(t),!0}catch{return!1}},rO="[object Boolean]",iO=Ut()();Gb.exports=function(t){return typeof t=="boolean"?!0:t===null||typeof t!="object"?!1:iO&&Symbol.toStringTag in t?tO(t):eO(t)===rO}});var Jb=f((kC,Dc)=>{"use strict";var nO=Object.prototype.toString,oO=ua()();oO?(Qb=Symbol.prototype.toString,Kb=/^Symbol\(.*\)$/,zb=function(t){return typeof t.valueOf()!="symbol"?!1:Kb.test(Qb.call(t))},Dc.exports=function(t){if(typeof t=="symbol")return!0;if(nO.call(t)!=="[object Symbol]")return!1;try{return zb(t)}catch{return!1}}):Dc.exports=function(t){return!1};var Qb,Kb,zb});var eA=f((BC,Zb)=>{"use strict";var Yb=typeof BigInt<"u"&&BigInt;Zb.exports=function(){return typeof Yb=="function"&&typeof BigInt=="function"&&typeof Yb(42)=="bigint"&&typeof BigInt(42)=="bigint"}});var iA=f((FC,Ic)=>{"use strict";var aO=eA()();aO?(tA=BigInt.prototype.valueOf,rA=function(t){try{return tA.call(t),!0}catch{}return!1},Ic.exports=function(t){return t===null||typeof t>"u"||typeof t=="boolean"||typeof t=="string"||typeof t=="number"||typeof t=="symbol"||typeof t=="function"?!1:typeof t=="bigint"?!0:rA(t)}):Ic.exports=function(t){return!1};var tA,rA});var oA=f((VC,nA)=>{"use strict";var sO=ec(),uO=Wb(),lO=$b(),cO=Jb(),pO=iA();nA.exports=function(t){if(t==null||typeof t!="object"&&typeof t!="function")return null;if(sO(t))return"String";if(uO(t))return"Number";if(lO(t))return"Boolean";if(cO(t))return"Symbol";if(pO(t))return"BigInt"}});var uA=f((HC,sA)=>{"use strict";var Ca=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,aA=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null,qa;Ca||(qa=function(t){return!1});var Cc=Ca?Ca.prototype.has:null,Nc=aA?aA.prototype.has:null;!qa&&!Cc&&(qa=function(t){return!1});sA.exports=qa||function(t){if(!t||typeof t!="object")return!1;try{if(Cc.call(t,Cc),Nc)try{Nc.call(t,Nc)}catch{return!0}return t instanceof Ca}catch{}return!1}});var cA=f((jC,kc)=>{"use strict";var dO=Te(),lA=Se(),fO=dO("%WeakSet%",!0),qc=lA("WeakSet.prototype.has",!0);qc?(ka=lA("WeakMap.prototype.has",!0),kc.exports=function(t){if(!t||typeof t!="object")return!1;try{if(qc(t,qc),ka)try{ka(t,ka)}catch{return!0}return t instanceof fO}catch{}return!1}):kc.exports=function(t){return!1};var ka});var dA=f((LC,pA)=>{"use strict";var mO=rc(),gO=nc(),hO=uA(),yO=cA();pA.exports=function(t){if(t&&typeof t=="object"){if(mO(t))return"Map";if(gO(t))return"Set";if(hO(t))return"WeakMap";if(yO(t))return"WeakSet"}return!1}});var gA=f((UC,mA)=>{"use strict";var vO=Se(),fA=vO("ArrayBuffer.prototype.byteLength",!0),bO=Oc();mA.exports=function(t){return bO(t)?fA?fA(t):t.byteLength:NaN}});var HA=f((WC,VA)=>{"use strict";var kA=Gy(),ot=Se(),hA=av(),AO=Te(),ci=rb(),_O=Jl(),yA=pb(),vA=kl(),bA=Zl(),AA=Oc(),_A=Cb(),wA=Vb(),xA=Lb(),EA=sa(),TA=oA(),SA=dA(),OA=Sc(),PA=gA(),MA=ot("SharedArrayBuffer.prototype.byteLength",!0),RA=ot("Date.prototype.getTime"),Bc=Object.getPrototypeOf,DA=ot("Object.prototype.toString"),Fa=AO("%Set%",!0),Fc=ot("Map.prototype.has",!0),Va=ot("Map.prototype.get",!0),IA=ot("Map.prototype.size",!0),Ha=ot("Set.prototype.add",!0),BA=ot("Set.prototype.delete",!0),ja=ot("Set.prototype.has",!0),Ba=ot("Set.prototype.size",!0);function NA(e,t,r,i){for(var n=ci(e),o;(o=n.next())&&!o.done;)if($e(t,o.value,r,i))return BA(e,o.value),!0;return!1}function FA(e){if(typeof e>"u")return null;if(typeof e!="object")return typeof e=="symbol"?!1:typeof e=="string"||typeof e=="number"?+e==+e:!0}function wO(e,t,r,i,n,o){var a=FA(r);if(a!=null)return a;var s=Va(t,a),u=kA({},n,{strict:!1});return typeof s>"u"&&!Fc(t,a)||!$e(i,s,u,o)?!1:!Fc(e,a)&&$e(i,s,u,o)}function xO(e,t,r){var i=FA(r);return i??(ja(t,i)&&!ja(e,i))}function CA(e,t,r,i,n,o){for(var a=ci(e),s,u;(s=a.next())&&!s.done;)if(u=s.value,$e(r,u,n,o)&&$e(i,Va(t,u),n,o))return BA(e,u),!0;return!1}function $e(e,t,r,i){var n=r||{};if(n.strict?yA(e,t):e===t)return!0;var o=TA(e),a=TA(t);if(o!==a)return!1;if(!e||!t||typeof e!="object"&&typeof t!="object")return n.strict?yA(e,t):e==t;var s=i.has(e),u=i.has(t),l;if(s&&u){if(i.get(e)===i.get(t))return!0}else l={};return s||i.set(e,l),u||i.set(t,l),SO(e,t,n,i)}function qA(e){return!e||typeof e!="object"||typeof e.length!="number"||typeof e.copy!="function"||typeof e.slice!="function"||e.length>0&&typeof e[0]!="number"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function EO(e,t,r,i){if(Ba(e)!==Ba(t))return!1;for(var n=ci(e),o=ci(t),a,s,u;(a=n.next())&&!a.done;)if(a.value&&typeof a.value=="object")u||(u=new Fa),Ha(u,a.value);else if(!ja(t,a.value)){if(r.strict||!xO(e,t,a.value))return!1;u||(u=new Fa),Ha(u,a.value)}if(u){for(;(s=o.next())&&!s.done;)if(s.value&&typeof s.value=="object"){if(!NA(u,s.value,r.strict,i))return!1}else if(!r.strict&&!ja(e,s.value)&&!NA(u,s.value,r.strict,i))return!1;return Ba(u)===0}return!0}function TO(e,t,r,i){if(IA(e)!==IA(t))return!1;for(var n=ci(e),o=ci(t),a,s,u,l,p,c;(a=n.next())&&!a.done;)if(l=a.value[0],p=a.value[1],l&&typeof l=="object")u||(u=new Fa),Ha(u,l);else if(c=Va(t,l),typeof c>"u"&&!Fc(t,l)||!$e(p,c,r,i)){if(r.strict||!wO(e,t,l,p,r,i))return!1;u||(u=new Fa),Ha(u,l)}if(u){for(;(s=o.next())&&!s.done;)if(l=s.value[0],c=s.value[1],l&&typeof l=="object"){if(!CA(u,e,l,c,r,i))return!1}else if(!r.strict&&(!e.has(l)||!$e(Va(e,l),c,r,i))&&!CA(u,e,l,c,kA({},r,{strict:!1}),i))return!1;return Ba(u)===0}return!0}function SO(e,t,r,i){var n,o;if(typeof e!=typeof t||e==null||t==null||DA(e)!==DA(t)||vA(e)!==vA(t))return!1;var a=bA(e),s=bA(t);if(a!==s)return!1;var u=e instanceof Error,l=t instanceof Error;if(u!==l||(u||l)&&(e.name!==t.name||e.message!==t.message))return!1;var p=wA(e),c=wA(t);if(p!==c||(p||c)&&(e.source!==t.source||hA(e)!==hA(t)))return!1;var g=_A(e),A=_A(t);if(g!==A||(g||A)&&RA(e)!==RA(t)||r.strict&&Bc&&Bc(e)!==Bc(t))return!1;var d=OA(e),_=OA(t);if(d!==_)return!1;if(d||_){if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}var m=qA(e),y=qA(t);if(m!==y)return!1;if(m||y){if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}var v=AA(e),T=AA(t);if(v!==T)return!1;if(v||T)return PA(e)!==PA(t)?!1:typeof Uint8Array=="function"&&$e(new Uint8Array(e),new Uint8Array(t),r,i);var h=xA(e),x=xA(t);if(h!==x)return!1;if(h||x)return MA(e)!==MA(t)?!1:typeof Uint8Array=="function"&&$e(new Uint8Array(e),new Uint8Array(t),r,i);if(typeof e!=typeof t)return!1;var S=EA(e),O=EA(t);if(S.length!==O.length)return!1;for(S.sort(),O.sort(),n=S.length-1;n>=0;n--)if(S[n]!=O[n])return!1;for(n=S.length-1;n>=0;n--)if(o=S[n],!$e(e[o],t[o],r,i))return!1;var D=SA(e),L=SA(t);return D!==L?!1:D==="Set"||L==="Set"?EO(e,t,r,i):D==="Map"?TO(e,t,r,i):!0}VA.exports=function(t,r,i){return $e(t,r,i,_O())}});var Vc={};Z(Vc,{getProxyHeaders:()=>WO});async function XA(){let e=await at.prefs,t={};return e.mediaExtensions.split("|").forEach(function(r){t[r]=1}),t}async function GA(){let e=(await at.prefs).networkFilterOut;if(e)try{return new RegExp(e,"i")}catch{console.warn("networkFilterOut preference is not a valid regex");return}}function LA(){Ot.webRequest.onHeadersReceived.addListener(KA,{urls:["<all_urls>"]},["responseHeaders"])}function LO(){Ot.webRequest.onHeadersReceived.removeListener(KA)}function UA(){St={},Ot.webRequest.onSendHeaders.addListener(zA,{urls:["<all_urls>"]},YA),Ot.webRequest.onErrorOccurred.addListener(JA,{urls:["<all_urls>"]})}function UO(){Ot.webRequest.onSendHeaders.removeListener(zA),Ot.webRequest.onErrorOccurred.removeListener(JA),St=null}function ZA(e){let t=pi[e.url];if(t){clearTimeout(t.timer),delete pi[e.url];let r=e.requestHeaders.filter(i=>typeof WA[i.name.toLowerCase()]>"u");t.handlers.forEach(i=>{i.resolve({proxy:e.proxyInfo,headers:r})})}}function WO(e){function t(){let i=pi[e];i&&(i.handlers.forEach(n=>{n.reject(new Error("timeout monitoring proxyHeaders"))}),delete pi[e])}let r=pi[e];return r?clearTimeout(r.timer):r=pi[e]={handlers:[]},new Promise((i,n)=>{r.handlers.push({resolve:i,reject:n}),r.timer=setTimeout(t,3e4),fetch(e,{method:"HEAD",credentials:"include"})})}var at,OO,PO,jA,MO,RO,Ot,DO,IO,NO,CO,qO,kO,BO,FO,VO,HO,WA,$A,QA,KA,jO,St,zA,JA,YA,pi,Hc=I(()=>{"use strict";Fi();de();Ir();mt();ft();Oi();at=z(),OO=(Ne(),P(Ie)),PO=(Yi(),P(Ji)),jA=(_e(),P(Ae)),MO=($r(),P(Gr)),{MaybeCreateProbeFromNetworkRequest:RO}=(sl(),P(al)),Ot=at.browser,DO=new RegExp("^bytes [0-9]+-[0-9]+/([0-9]+)$"),IO=new RegExp("^(audio|video)/(?:x-)?([^; ]+)"),NO=new RegExp('filename\\s*=\\s*"\\s*([^"]+?)\\s*"'),CO=new RegExp("/([^/]+?)(?:\\.([a-z0-9]{1,5}))?(?:\\?|#|$)","i"),qO=new RegExp("\\.([a-z0-9]{1,5})(?:\\?|#|$)","i"),kO=new RegExp("\\bsource=yt_otf\\b"),BO=new RegExp("/ptracking\\b"),FO=new RegExp("^https://www.gstatic.com/youtube/doodle\\b"),VO=new RegExp("^(https?)://v[^\\/]*\\.tumblr\\.com/(tumblr_[0-9a-zA-Z_]+)\\.(?:mp4|mov)"),HO=new RegExp("^https://soundcloud.com/"),WA={host:!0,range:!0,"content-length":!0};$A=XA();at.prefs.then(e=>e.on("mediaExtensions",()=>{$A=XA()}));QA=GA();at.prefs.then(e=>e.on("networkFilterOut",()=>{QA=GA()}));KA=async e=>{let t=await at.prefs,r;if(St&&(r=St[e.requestId],r&&delete St[e.requestId]),e.tabId<0)return;let i=await QA;if(kO.test(e.url)||BO.test(e.url)||FO.test(e.url)||i&&i.test(e.url))return;function n(d,_){if(!_&&(!s&&isNaN(u)&&!l||!s&&!l&&(isNaN(u)||t.mediaweightThreshold===0||u<t.mediaweightThreshold)||s&&s[2].toLowerCase()=="ms-asf"))return;let m={id:"network-probe:"+jA.hashHex(e.url),status:"active",url:e.url,tabId:e.tabId,frameId:e.frameId,fromCache:!0,referrer:g};!isNaN(u)&&!d&&(m.length=u),e.proxyInfo&&e.proxyInfo.type.substr(0,4)=="http"&&(m.proxy=e.proxyInfo);let y=o["content-disposition"];if(y){let h=NO.exec(y);h&&h[1]&&(m.headerFilename=h[1])}let v=CO.exec(e.url);v&&(m.urlFilename=v[1]),m.title=m.headerFilename||m.urlFilename||at._("media");let T=VO.exec(e.url);T&&(m.thumbnailUrl=T[1]+"://media.tumblr.com/"+T[2]+"_frame1.jpg"),l?(m.type="video",m.extension=l[1]):s?(m.type=s[1],m.extension=s[2]):m.extension=p,m.headers=r&&r.filter(h=>typeof WA[h.name.toLowerCase()]>"u")||[],Ot.tabs.get(e.tabId).then(async h=>{if(h){m.topUrl=h.url,m.isPrivate=h.incognito,m.title=m.headerFilename||h.title||m.urlFilename||at._("media");let x=await MO.getSpecs(h.url);x&&(x.headerFilename=m.headerFilename,x.urlFilename=m.urlFilename),d&&(m.originalId=m.id,await d.onHitDataAvailable(m)),jA.executeScriptWithGlobal({tabId:h.id},{_$vdhHitId:m.id,_$vdhSmartNameSpecs:x},"/injected/pagedata.js").catch(S=>{Ot.webNavigation.getFrame({tabId:h.id,frameId:m.frameId}).then(O=>{O&&(console.warn("pagedata execution error",S.message),PO.updateOriginal(m.id,{title:h.title||m.title,pageUrl:O.url,topUrl:h.url}))})})}if(!d){m.group=m.id;let x=M,S={builder:"HTTPMedia",protocol:"non-adaptative",duration:"unknown"};{if(a){let O=Xr(a);if(O.isErr())console.warn("Couldn't not parse mimetype",a);else{let{container:D,av_codecs:L}=O.unwrap();x=N({...S,container:le(D),av:gt(L,B=>({codec:dt(B),bitrate:M}),B=>({codec:He(B),fps:M,dimensions:M,quality:M,bitrate:M}))})}}x.isNone()&&l?.[1]&&(x=td(l[1]).map(O=>({...S,container:O,av:{audio:!1,video:Hn()}})))}x.isSome()&&(m.core_media=x.unwrap(),OO.dispatch("hit.new",m))}})}let o={};(e.responseHeaders||[]).forEach(d=>{o[d.name.toLowerCase()]=d.value});let a=o["content-type"],s=IO.exec(a),u=parseInt(o["content-length"]);if(isNaN(u)){let d=o["content-range"];if(d){let _=DO.exec(d);_&&(u=parseInt(_[1]))}}let l=qO.exec(e.url),p=null,c=await $A;if(l){if(p=l[1].toLowerCase(),p=="m4s"&&t.dashHideM4s||p=="ts"&&t.mpegtsHideTs)return;c[l[1]]||(l=null)}let g=e.originUrl||e.documentUrl||void 0;if(HO.test(g)&&u<1e6&&a=="audio/mpeg")return;let A=RO(e,a,r);if(A)try{n(A,!0,g,r,e)}catch(d){console.error("Uncaught PostHook error:",d)}else{let d=s&&(s[1]=="audio"||s[1]=="video"),_=!isNaN(u)&&t.mediaweightThreshold>0&&u>=t.mediaweightThreshold;n(null,d||_)}},jO=["main_frame","sub_frame","xmlhttprequest","object","media"];at.browserType=="firefox"&&jO.push("object_subrequest");at.prefs.then(e=>{e.networkProbe&&LA(),e.monitorNetworkRequests&&UA(),e.on("networkProbe",(t,r)=>{r?LA():LO()}),e.on("monitorNetworkRequests",(t,r)=>{r?UA():UO()})});St=null,zA=e=>{ZA(e),St&&(St[e.requestId]=e.requestHeaders)},JA=e=>{ZA(e),St&&delete St[e.requestId]},YA=["requestHeaders"];Ot.runtime.getManifest().manifest_version>=3&&YA.push("extraHeaders");pi={}});var Uc={};Z(Uc,{analyzePage:()=>Lc});async function jc(){let e=await hn.tabs.query({active:!0,currentWindow:!0});if(e.length===0)throw new Error("Can't find current tab");return{tabId:e[0].id}}async function Lc(e){let t;e?t={tabId:e}:t=await jc(),await hn.scripting.insertCSS({target:t,css:GO});let r=await $t.prefs;await r_.executeScriptWithGlobal(t,{_$vdhParams:{extensions:r.medialinkExtensions,maxHits:r.medialinkMaxHits,minFilesPerGroup:r.medialinkMinFilesPerGroup,minImgSize:r.medialinkMinImgSize,scanImages:r.medialinkScanImages,scanLinks:r.medialinkScanLinks}},"/injected/gallery.js")}function t_(e){return".vdh-mask."+e+" { display: block; }"}var $t,hn,e_,r_,XO,GO,Wc=I(()=>{"use strict";$t=z(),hn=$t.browser,e_=(Ne(),P(Ie)),r_=(_e(),P(Ae)),XO=(Hc(),P(Vc)),GO=".vdh-mask { position: absolute; display: none; background-color: rgba(255,0,0,0.5); z-index: 2147483647; }";$t.rpc.listen({analyzePage:()=>{Lc()},galleryGroups:e=>{Object.keys(e.groups).forEach(t=>{let r=e.groups[t],i="??",n="??";try{n=new URL(r.baseUrl).hostname}catch(s){console.warn("Uncaught URL error",s)}switch(r.type){case"image":i=$t._("gallery_from_domain",n);break;case"link":i=$t._("gallery_links_from_domain",n);break}let o;if(r.extensions){let s=Object.keys(r.extensions);s.sort((l,p)=>r.extensions[l]-r.extensions[p]);let u=[];s.forEach(l=>{let p=$t._("number_type",[""+r.extensions[l],l.toUpperCase()]);u.push(p)}),o=$t._("gallery_files_types",u.length>0&&u.join(", ")||""+r.urls.length)}let a="gallery:"+r_.hashHex(e.pageUrl)+":"+t;e_.dispatch("hit.new",Object.assign({},r,{gallery_urls:r.urls,id:a,topUrl:e.pageUrl,title:i,description:o,mouseTrack:!0})),XO.getProxyHeaders(e.pageUrl).then(s=>{e_.dispatch("hit.update",{id:a,changes:s})})})},galleryHighlight:async e=>{hn.scripting.insertCSS({target:await jc(),css:t_(e)})},galleryUnhighlight:async e=>{hn.scripting.removeCSS({target:await jc(),css:t_(e)})}});hn.tabs.onUpdated.addListener(async(e,t,r)=>{let i=await $t.prefs;t.status==="complete"&&i.medialinkAutoDetect&&Lc(e)})});var i_={};Z(i_,{updateHits:()=>Gc});function eP(e){let t=Math.floor(e/3600),r=Math.floor(e%3600/60),i=e%60;return t>0?t+":"+("00"+r).substr(-2)+":"+("00"+i).substr(-2):r+":"+("00"+i).substr(-2)}function tP(e){return e.length?e.length>1024*1024?K._("MB",[Math.round(e.length*10/(1024*1024))/10]):e.length>1024?K._("KB",[Math.round(e.length*10/1024)/10]):K._("Bytes",[e.length]):null}function rP(e){if(e.description)return e.description;let t=[];if(e.descrPrefix&&t.push(e.descrPrefix),e.size&&t.push(e.size),e.duration&&t.push(eP(e.duration)),e.quality){let i=K._("quality_"+e.quality);i==""&&(i=e.quality.toUpperCase()),t.push(i)}if(e.bitrate){let i=e.bitrate,n="bps";e.bitrate>1e7?(n="Mbps",i=Math.round(e.bitrate/1e6)):e.bitrate>1e6?(n="Mbps",i=Math.round(e.bitrate/1e5)/10):e.bitrate>1e4?(n="Kbps",i=Math.round(e.bitrate/1e3)):e.bitrate>1e3&&(n="Kbps",i=Math.round(e.bitrate/100)/10),t.push(i+n)}let r=tP(e);return r&&t.push(r),e.mediaDomain&&t.push(K._("from_domain",[e.mediaDomain])),e.type=="audio"&&t.push(K._("audio_only")),e.extension&&(e.originalExt&&e.originalExt!=e.extension&&t.push(e.originalExt.toUpperCase()+">"+e.extension.toUpperCase()),t.push(e.extension.toUpperCase())),t.join(" - ")}async function Gc(e){let t=await K.prefs,r=[],i=di.describeAll();e:for(let o of e){o[0].group||console.warn("Trying to construct a menu item, but hit is missing group",o[0]),r.push({id:"group-"+o[0].group,title:o[0].title,enabled:!1});for(let a of o){let s=(await di.availableActions(a.id))[0];if(r.push({id:a.id,title:rP(a),icons:{18:"content/"+i[s].icon18}}),r.length>=ZO)break e}}if(r.length==0&&r.push({id:"vdh-no-media",title:K._("no_media_current_tab"),enabled:!1}),r.push({id:"separator",type:"separator"}),r.push({id:"vdh-smartnaming",title:K._("smartnaming_rule")}),r.push({id:"separator2",type:"separator"}),r.push({id:"vdh-settings",title:K._("settings"),icons:{64:"content/images/icon-settings-64.png"}}),r.push({id:"vdh-about",title:K._("about"),icons:{64:"content/images/icon-about-64.png"}}),QO.buildOptions.browser=="firefox"&&r.push({id:"vdh-sites",title:K._("supported_sites"),icons:{64:"content/images/icon-sites-list-64.png"}}),r.push({id:"vdh-convert",title:K._("convert_local_files"),icons:{64:"content/images/icon-action-convert-b-64.png"}}),r.push({id:"vdh-merge",title:K._("merge_local_files"),icons:{64:"content/images/icon-merger-64.png"}}),r.push({id:"vdh-analyze",title:K._("analyze_page"),icons:{64:"content/images/icon-photo-64.png"}}),!t.contextMenuEnabled&&(!K.isBrowser("firefox")||!t.toolsMenuEnabled)){La.length&&(Ua.removeAll(),La=[]);return}if($O(r,La))return;La=r;function n(o){return new Promise((a,s)=>{Ua.create(o,()=>{a()})})}iP(async()=>{let o=await K.prefs;return Ua.removeAll().then(()=>{let a=[];return o.contextMenuEnabled&&a.push(n({id:"vdh-main",title:K._("title"),contexts:["all"]}).then(()=>Promise.all(r.map(s=>{let u=Object.assign({parentId:"vdh-main"},s);return Wa.menus||(delete u.icons,(u.contexts||[]).indexOf("selection")<0&&(u.contexts=(u.contexts||[]).concat(["all"]))),n(u)})))),K.isBrowser("firefox")&&o.toolsMenuEnabled&&a.push(n({id:"vdh-main-tools",title:K._("title"),contexts:["tools_menu"]}).then(()=>Promise.all(r.map(s=>n(Object.assign({parentId:"vdh-main-tools"},s,{id:s.id+"-tools"})))))),Promise.all(a)})})}var $O,QO,K,Wa,di,Xc,KO,zO,JO,YO,ZO,Ua,La,iP,n_=I(()=>{"use strict";$O=HA(),QO=Jt(),K=z(),Wa=K.browser,di=(Gi(),P(Xi)),Xc=(Ne(),P(Ie)),KO=(_e(),P(Ae)),zO=(Wc(),P(Uc)),JO=($r(),P(Gr)),YO=(Ft(),P(Bt)),ZO=12,Ua=Wa.menus||Wa.contextMenus;La=[],iP=KO.Concurrent();K.unsafe_prefs.on("contextMenuEnabled",async()=>Gc(await Xc.getSerializedHits()));K.unsafe_prefs.on("toolsMenuEnabled",async()=>Gc(await Xc.getSerializedHits()));Ua.onClicked.addListener(function(e,t){switch(e.menuItemId){case"vdh-settings":case"vdh-settings-tools":K.ui.open("settings",{type:"tab",url:"content/settings.html"});break;case"vdh-about":case"vdh-about-tools":K.ui.open("about",{type:"panel",url:"content/about.html"});break;case"vdh-sites":case"vdh-sites-tools":YO.gotoOrOpenTab("https://www.downloadhelper.net/sites");break;case"vdh-convert":case"vdh-convert-tools":di.convertLocal();break;case"vdh-merge":di.mergeLocal();break;case"vdh-analyze":case"vdh-analyze-tools":zO.analyzePage();break;case"vdh-smartnaming":case"vdh-smartnaming-tools":JO.defineInPage();break;default:{let r=/^(.*)\-tools$/.exec(e.menuItemId),i=r&&r[1]||e.menuItemId;di.execute_default(i)}}});Wa.commands.onCommand.addListener(async function(e){if(e=="default-action"){let t=(await Xc.getSerializedHits())[0]?.[0];t&&di.execute_default(t.id)}})});var c_={};Z(c_,{checkHitBlacklisted:()=>sP,set:()=>l_});async function $c(){try{await o_.storage.local.set({blacklist:await vn})}catch{console.error("Cannot write blacklist storage")}}function yn(e){let t=[],r=/^https?:\/\/([^\/:]+)/.exec(e);if(r)if(nP.test(r[1]))t.push(r[1]);else{let i=r[1].split(".");for(;i.length>1&&(i[0]!="co"||i.length>2);)t.push(i.join(".")),i.shift()}return t}function u_(e){let t=[];e.url&&(t=t.concat(yn(e.url))),e.audioUrl&&(t=t.concat(yn(e.audioUrl))),e.videoUrl&&(t=t.concat(yn(e.videoUrl))),e.topUrl&&(t=t.concat(yn(e.topUrl))),e.pageUrl&&(t=t.concat(yn(e.pageUrl)));let r={};return t.forEach(function(i){r[i]=1}),r}function oP(e){let t=Object.keys(e);return t.sort(function(r,i){let n=r.split(".").reverse(),o=i.split(".").reverse();for(;;){if(n.length&&!o.length)return-1;if(!n.length&&o.length)return 1;if(!n.length&&!o.length)return 0;let a=n.shift(),s=o.shift();if(a!=s)return a<s?-1:1}}),t}function aP(e){let t=u_(e);return oP(t)}function sP(e){if(!Xa.unsafe_prefs.blacklistEnabled)return!1;let t=u_(e);for(let r in t)if(s_[r])return!0;return!1}async function uP(e){let t=await vn;e.forEach(r=>{t[r]=!0}),await $c(),a_.dispatch("blacklist-changed")}async function lP(e){let t=await vn;e.forEach(r=>{delete t[r]}),await $c()}async function l_(e){vn=Promise.resolve(e||{}),await $c()}var Xa,o_,a_,nP,s_,vn,p_=I(()=>{"use strict";Xa=z(),o_=Xa.browser,a_=(Ne(),P(Ie)),nP=new RegExp("^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"),vn=(async()=>{try{let t=(await o_.storage.local.get({blacklist:{}})).blacklist;return s_=t,t}catch{console.error("Cannot read blacklist storage");return}})();Xa.rpc.listen({domainsFromHitId:e=>{let t=a_.getHit(e);return t&&aP(t)||[]},addToBlacklist:uP,removeFromBlacklist:lP,setBlacklist:async e=>{await l_(e)},getBlacklist:async()=>{let e=await vn;return Object.keys(e).filter(t=>!!e[t])},editBlacklist:()=>{Xa.ui.open("blacklist-edit",{type:"tab",url:"content/blacklist-edit.html"})}})});var zc={};Z(zc,{outputConfigForHit:()=>pP,set:()=>f_});async function f_(e){Kc=Promise.resolve(e),await d_.storage.local.set({convrules:e})}async function pP(e){let t=await Kc,r=(e.url||e.videoUrl||e.audioUrl)&&e.topUrl;if(!r)return null;let i=new URL(r).hostname,n=[],o=i.split(".");for(let u=0;u<o.length-1;u++)n.push(o.slice(u).join("."));let a=null;return t.every(u=>{let l=!0;return u.extension&&e.extension!==u.extension&&(l=!1),l&&u.domain&&(l=!n.every(p=>p!==u.domain)),l&&(a=u),!l})||!a.convert?null:(await cP.getOutputConfigs())[a.format]||null}var Qc,d_,cP,Kc,Jc=I(()=>{"use strict";Qc=z(),d_=Qc.browser,cP=(Qi(),P($i)),Kc=d_.storage.local.get({convrules:[]}).then(e=>e.convrules);Qc.rpc.listen({editConversionRules:()=>{Qc.ui.open("convrules-edit",{type:"tab",url:"content/convrules-edit.html"})},getConversionRules:()=>Kc,setConversionRules:e=>f_(e)})});var Ie={};Z(Ie,{closePopup:()=>b_,dispatch:()=>OP,getHit:()=>h_,getHits:()=>tp,getLogs:()=>xP,getMainData:()=>v_,getSerializedHits:()=>rp});function tp(){return ve.getState().hits}function h_(e){return tp().flat.get(e)}function xP(){return ve.getState().logs}async function y_(){let{flat:e}=tp(),t=(await st.prefs).mediaweightMinSize,r=await xr.storage.local.get({blacklist:{}}),i=Object.keys(r.blacklist).map(n=>n.split(".").reverse());return fd(e,i,t)}async function rp(){let e=yd(await Mn(kr,{})),t=await y_(),r=md(t,e);for(let i of r)for(let n of i)n.actions=await m_.availableActions(n.id);return r}async function ip(){let e=0,t=0,r=0,i=0,n=await y_();for(let p of n.values())switch(p.status){case"running":i++;break;case"active":e++,t++;break;case"inactive":t++;break;case"pinned":r++;break}let o=await st.prefs,a=!1;(t==0||o.iconActivation=="currenttab"&&e==0)&&(a=!0),xr.action.setIcon({path:{32:"/content/images/icon-32"+(a?"-off":"")+".png",40:"/content/images/icon-40"+(a?"-off":"")+".png",48:"/content/images/icon-48"+(a?"-off":"")+".png",128:"/content/images/icon-128"+(a?"-off":"")+".png"}});let s="",u="#000";switch(o.iconBadge){case"tasks":u="#00f",s=i||"";break;case"activetab":u="#080",s=e||"";break;case"anytab":u="#b59e32",s=t||"";break;case"pinned":u="#000",s=r||"";break;case"mixed":r>0?(u="#000",s=r):i>0?(u="#00f",s=i):e>0?(u="#080",s=e):t>0&&(u="#b59e32",s=t)}let l=ve.getState().logs.filter(p=>p.type==="error");l.length>0&&(s=l.length,u="#f44"),xr.action.setBadgeText({text:""+s}),xr.action.setBadgeBackgroundColor({color:u})}function OP(e,t){ve.dispatch({type:e,payload:t})}async function v_(){return{hits:await rp(),actions:m_.describeAll(),logs:ve.getState().logs,progress:ve.getState().progress}}async function b_(){return bn.call("main","close")}async function PP(){let e=["blacklist","license",kr,"convrules","outputConfigs","smartname"],t=await st.prefs;return xr.storage.local.get(e).then(r=>{let i=Object.assign({blacklist:{},license:null,conversionRules:[],outputConfigs:{}},r,{"weh-prefs":t.getAll()}),n=JSON.stringify(i,null,4),o;if(st.isBrowser("firefox")){let a=new Blob([n],{type:"text/json;charset=utf-8"});o=URL.createObjectURL(a)}else o="data:,"+n;xr.downloads.download({url:o,filename:"vdh-settings.json",saveAs:!0,conflictAction:"uniquify"})})}async function MP(e){return e.convrules&&await wP.set(e.convrules),e.outputConfigs&&yP.setOutputConfigs(e.outputConfigs),e.license&&vP.setLicense(e.license),e.blacklist&&await AP.set(e.blacklist),kr in e&&await Rn(kr,e[kr]),e.smartname&&await _P.set(e.smartname),e["weh-prefs"]||{}}function RP(){xr.runtime.reload()}var dP,fP,mP,gP,ep,st,bn,Zc,m_,hP,yP,vP,bP,AP,_P,wP,g_,xr,ve,EP,TP,SP,Yc,Ne=I(()=>{"use strict";Dn();gd();vd();Dn();({createStore:dP,combineReducers:fP,applyMiddleware:mP}=ef()),{createLogger:gP}=rf(),ep=uf(),st=z(),bn=Mt(),Zc=(Yi(),P(Ji)),m_=(Gi(),P(Xi)),hP=(Xn(),P(Wn)),yP=(Qi(),P($i)),vP=(Yr(),P(Jr)),bP=(n_(),P(i_)),AP=(p_(),P(c_)),_P=($r(),P(Gr)),wP=(Jc(),P(zc));Ft();g_=[];st.prefs.then(e=>{e.backgroundReduxLogger&&g_.push(gP({collapsed:(t,r,i)=>!0}))});xr=st.browser,ve=dP(fP({hits:Zc.reducer,progress:Zc.progressReducer,logs:hP.reducer}),mP(...g_));EP=ep(ve.getState,"hits"),TP=ep(ve.getState,"progress"),SP=ep(ve.getState,"logs");Yc=null;ve.subscribe(EP(async()=>{if(Yc)return;let e=(await st.prefs).hitUpdateFloodProtect;Yc=setTimeout(async()=>{Yc=null;let t=await rp();try{st.openedContents().indexOf("main")>=0&&bn.call("main","hits",t),bP.updateHits(t),ip()}catch(r){console.error(r)}},e)}));ve.subscribe(TP(()=>{try{bn.call("main","progress",ve.getState().progress)}catch{}}));ve.subscribe(SP(()=>{try{bn.call("main","logs",ve.getState().logs)}catch{}try{ip()}catch(e){console.error(e)}}));bn.listen({getHit:e=>h_(e),getMainData:v_,hitPageData:e=>{Zc.updateOriginal(e.id,e.data)},closePopup:b_,closePanel:e=>st.ui.close(e)});ip();st.rpc.listen({exportSettings:PP,importSettings:MP,reloadAddon:RP})});var Bt={};Z(Bt,{current:()=>qP,gotoOrOpenTab:()=>HP,setTransientTab:()=>A_,update:()=>mi});function qP(){return{url:np,urls:$a}}function kP(){Ga=null,CP().then(e=>{e&&(np=e.url,Pt.tabs.query({}).then(t=>{$a={};for(let r in t)$a[t[r].url]=1;IP.dispatch("hits.urlUpdated",{url:np,urls:$a})}))})}function mi(){Ga&&clearTimeout(Ga),Ga=setTimeout(kP,50)}function A_(e,t){Qt=e,fi=t}function BP(e){Qt===e&&fi&&Pt.tabs.update(fi,{active:!0}),Qt=null,fi=null,mi()}function FP({tabId:e,_windowId:t}){e!==Qt&&(Qt=null,fi=null),mi()}function VP(e){Qt==="<next-tab>"&&(Qt=e.id)}function HP(e){return Qt=null,fi=null,NP.gotoOrOpenTab(e,A_)}var DP,Pt,IP,NP,Ga,CP,np,$a,Qt,fi,Ft=I(()=>{"use strict";DP=z(),Pt=DP.browser,IP=(Ne(),P(Ie)),NP=(_e(),P(Ae)),Ga=null,CP=async()=>{try{let e=await Pt.windows.getLastFocused({populate:!0});if(e.focused){let t=e.tabs.filter(r=>r.active);return t.length?t[0]:null}else return null}catch{return null}},np="about:blank",$a={};Qt=null,fi=null;Pt.windows.onFocusChanged.addListener(mi);Pt.windows.onRemoved.addListener(mi);Pt.tabs.onActivated.addListener(FP);Pt.tabs.onRemoved.addListener(BP);Pt.tabs.onUpdated.addListener(mi);Pt.tabs.onCreated.addListener(VP)});var gr={};Z(gr,{call:()=>x_,check:()=>sp,downloads:()=>YP,gotoInstall:()=>ap,isAtLeastVersion:()=>JP,isDegradedVersion:()=>zP,isProbablyAvailable:()=>KP,listen:()=>$P,request:()=>ZP,requestBinary:()=>eM});function ap(){WP(async()=>{let e=await Qa.prefs,t=`https://www.downloadhelper.net/install-coapp-v2?channel=${GP}`;return e.forcedCoappVersion&&(t+="&version="+e.forcedCoappVersion),UP.gotoOrOpenTab(t)})}function x_(...e){return Qe.call(...e)}function $P(...e){return Qe.listen(...e)}function QP(){return new Promise((e,t)=>{let r=!1;Qe.callCatchAppNotFound(i=>{gi=!1,r=!0,e({status:!1,error:i.message})},"info").then(i=>{gi=!0,op=i.version,w_=i.target?.node==10,e({status:!0,info:i})}).catch(i=>{gi=!1,r||e({status:!1,error:i.message})})})}function sp(){return XP(()=>QP())}function KP(){return gi}function zP(){return!!w_}function JP(e){if(op)return LP(op,e)>=0;throw new Error("Coapp no available")}function ZP(e,t){return new Promise((r,i)=>{let n=[];function o(a){if(n.push(a.data),!a.more)return r(n.join(""));Qe.call("requestExtra",a.id).then(s=>{o(s)}).catch(i)}Qe.call("request",e,t).then(a=>(gi=!0,a)).then(o).catch(i)})}function eM(e,t){return new Promise((r,i)=>{let n=0,o=[];function a(s){if(s.data&&s.data.data&&(n+=s.data.data.length,o.push(new Uint8Array(s.data.data))),!s.more){let u=new Uint8Array(n),l=0;return o.forEach(p=>{u.set(p,l),l+=p.length}),r(u)}Qe.call("requestExtra",s.id).then(u=>{setTimeout(()=>{a(u)})}).catch(i)}Qe.call("requestBinary",e,t).then(s=>(gi=!0,s)).then(a).catch(i)})}var Qa,__,jP,LP,Qe,UP,WP,XP,GP,An,gi,op,w_,YP,hr=I(()=>{"use strict";Qa=z(),__=(_e(),P(Ae)),jP=(Vp(),P(Fp)),{compareSemVer:LP}=(Kp(),P(Qp)),Qe=Jp()("net.downloadhelper.coapp"),UP=(Ft(),P(Bt)),WP=__.Concurrent(),XP=__.Concurrent(),{channel:GP}=Jt(),An=null;Qe.onAppNotFound.addListener(()=>{ap()});Qe.onCallCount.addListener(async(e,t)=>{let r=await Qa.prefs;An&&(clearTimeout(An),An=null),e===0&&t===0&&r.coappIdleExit&&(An=setTimeout(()=>{An=null,Qe.close()},r.coappIdleExit))});YP=new jP.Downloads(Qe);Qa.prefs.then(e=>{e.checkCoappOnStartup&&sp()});Qa.rpc.listen({coappProxy:x_,checkCoApp:sp,installCoApp:ap})});pp();var tM=(async()=>{let e=z(),t=e.browser,r=Jt();r.prod||console.info("=========== VDH started",new Date().toLocaleTimeString(),"=========="),Dp(),hr(),Yr(),Hc(),Wc(),Jc();let i=(Ft(),P(Bt));return e.rpc.listen({openSettings:()=>{e.ui.open("settings",{type:"tab",url:"content/settings.html"}),e.ui.close("main")},openTranslation:()=>{e.ui.open("translation",{type:"tab",url:"content/translation.html"}),e.ui.close("main")},openSites:()=>i.gotoOrOpenTab("https://www.downloadhelper.net/sites"),openForum:()=>i.gotoOrOpenTab("https://github.com/aclap-dev/video-downloadhelper/discussions"),openHomepage:()=>i.gotoOrOpenTab("https://www.downloadhelper.net/"),openTranslationForum:()=>i.gotoOrOpenTab("https://github.com/aclap-dev/video-downloadhelper/discussions/categories/language-translation"),openWeh:()=>i.gotoOrOpenTab("https://github.com/mi-g/weh"),openAbout:()=>{e.ui.open("about",{type:"panel",url:"content/about.html"}),e.ui.close("main")},openCoapp:()=>{e.ui.open("coappShell",{type:"tab",url:"content/coapp-shell.html"}),e.ui.close("main")},goto:n=>i.gotoOrOpenTab(n),getBuild:()=>r,updateLastFocusedWindowHeight:(n,o)=>{t.windows.getLastFocused().then(a=>{if(a){n=Math.floor(n),o=Math.floor(o);let s=Math.floor(a.height)-o;t.windows.update(a.id,{height:n+s})}})},editMediaUserPrefs:()=>{e.ui.open("media-user-prefs-edit",{type:"tab",url:"content/media-user-prefs-edit.html"})}}),n=>{let o=t.runtime.getManifest(),a=r.channel,s=r.buildOptions.target,u=o.version.split(".").slice(0,2).join(".");if(n.reason=="install")i.gotoOrOpenTab(`https://www.downloadhelper.net/welcome/${s}/${a}/`);else if(n.reason=="update"){let l=n.previousVersion.split(".").slice(0,2).join(".");u!=l&&i.gotoOrOpenTab(`https://www.downloadhelper.net/changelog/${s}/${a}/`)}}})();(chrome||browser).runtime.onInstalled.addListener(async t=>{(await tM)(t)});})();
/*! Bundled license information:

semver-parser/index.js:
  (*!
   * SemVer Parser
   *
   * @license MIT
   * @copyright asamuzaK (Kazz)
   * @see {@link https://github.com/asamuzaK/semverParser/blob/master/LICENSE}
   * @see {@link https://semver.org/ Semantic Versioning 2.0.0}
   *)

m3u8-parser/dist/m3u8-parser.es.js:
  (*! @name m3u8-parser @version 7.1.0 @license Apache-2.0 *)
*/
